{"remainingRequest":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\babel-loader\\lib\\index.js!E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\vue-loader-v16\\dist\\index.js??ref--1-1!E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\src\\components\\labelTool.vue?vue&type=script&lang=js","dependencies":[{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\src\\components\\labelTool.vue","mtime":1658224126664},{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\babel.config.js","mtime":1654570980000},{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\@vue\\cli-plugin-babel\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\@vue\\cli-service\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\node_modules\\vue-loader-v16\\dist\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuaW5jbHVkZXMuanMiOwpleHBvcnQgZGVmYXVsdCB7CiAgZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIHNjcm9sbFdpZHRoOiAwLAogICAgICBzd2l0Y2hGbGFnOiAzLAogICAgICBtb2RlOiAnZWRpdCcsCiAgICAgIHRvb2xCYXI6IHRydWUsCiAgICAgIGxhYmVsT3B0aW9uOiB7CiAgICAgICAgdW5kbzogZmFsc2UsCiAgICAgICAgY2xlYXI6IGZhbHNlLAogICAgICAgIGFsZ29yaXRobTogdHJ1ZSwKICAgICAgICBjb21tZW50czogdHJ1ZSwKICAgICAgICB2YWxpZE1hcms6IHRydWUsCiAgICAgICAgZmxhZ01hcms6IGZhbHNlCiAgICAgIH0sCiAgICAgIHRNb2RlOiAnJywKICAgICAgbm9kZURhdGE6IFtdLAogICAgICByZWxhdGlvbkRhdGE6IFtdLAogICAgICBzdGF0dXM6IHsKICAgICAgICBjaGVja2luZzogdHJ1ZSwKICAgICAgICBpc192YWxpZDogZmFsc2UsCiAgICAgICAgY2FsY2luZzogMAogICAgICB9LAogICAgICBlbnRpdHlMYWJlbFRyZWU6IHsKICAgICAgICBub2RlS2V5OiAnaWQnLAogICAgICAgIHNlbGVjdDogW10sCiAgICAgICAgZGVmYXVsdEVudGl0eTogW10sCiAgICAgICAgZGVmYXVsdFBhcmFtOiBbXSwKICAgICAgICBkYXRhOiBbewogICAgICAgICAgaWQ6ICcxJywKICAgICAgICAgIGxhYmVsOiAn5Lq654mpJywKICAgICAgICAgIHBhcmFtczogW3sKICAgICAgICAgICAgaWQ6ICcxLTEnLAogICAgICAgICAgICBsYWJlbDogJ+Wnk+WQjScKICAgICAgICAgIH1dCiAgICAgICAgfSwgewogICAgICAgICAgaWQ6ICcyJywKICAgICAgICAgIGxhYmVsOiAn5Zyw54K5JywKICAgICAgICAgIHBhcmFtczogW3sKICAgICAgICAgICAgaWQ6ICcyLTEnLAogICAgICAgICAgICBsYWJlbDogJ+S9jee9ricKICAgICAgICAgIH1dCiAgICAgICAgfSwgewogICAgICAgICAgaWQ6ICczJywKICAgICAgICAgIGxhYmVsOiAn5py65p6EJywKICAgICAgICAgIHBhcmFtczogW3sKICAgICAgICAgICAgaWQ6ICczLTEnLAogICAgICAgICAgICBsYWJlbDogJ+WQjeensCcKICAgICAgICAgIH1dCiAgICAgICAgfSwgewogICAgICAgICAgaWQ6ICc0JywKICAgICAgICAgIGxhYmVsOiAn5pe26Ze0JwogICAgICAgIH0sIHsKICAgICAgICAgIGlkOiA1LAogICAgICAgICAgbGFiZWw6ICflm73lrrYnLAogICAgICAgICAgcGFyYW1zOiBbewogICAgICAgICAgICBpZDogJzEtMScsCiAgICAgICAgICAgIGxhYmVsOiAn5ZCN56ewJwogICAgICAgICAgfV0KICAgICAgICB9XQogICAgICB9LAogICAgICByZWxhdGlvbkxhYmVsVHJlZTogewogICAgICAgIGRlZmF1bHRSZWxhdGlvbjogW10sCiAgICAgICAgY3VycmVudDogbnVsbCwKICAgICAgICBkYXRhOiBbewogICAgICAgICAgaWQ6ICczLTEnLAogICAgICAgICAgbGFiZWw6ICflkI3np7AnCiAgICAgICAgfV0sCiAgICAgICAgbGFiZWxzOiBbXQogICAgICB9LAogICAgICBsYWJlbERpYWxvZzogewogICAgICAgIHN0YXRlOiAwLAogICAgICAgIGRpYWxvZ09iajogewogICAgICAgICAgdGl0bGU6ICfpgInmi6nmoIfnrb4o5a6e5L2TL+WxnuaApyknLAogICAgICAgICAgd2lkdGg6ICc1NjBweCcKICAgICAgICB9LAogICAgICAgIHR5cGU6ICdhZGQnLAogICAgICAgIHZpc2libGU6IGZhbHNlLAogICAgICAgIGRhdGE6IHt9LAogICAgICAgIGN1cnJlbnRUYWJsZTogewogICAgICAgICAgaGVhZGVyczogW3sKICAgICAgICAgICAgbGFiZWw6ICflrp7kvZPlkI3np7AnLAogICAgICAgICAgICBwcm9wZXJ0eTogJ25hbWUnLAogICAgICAgICAgICB3aWR0aDogMTAwCiAgICAgICAgICB9LCB7CiAgICAgICAgICAgIGxhYmVsOiAn5qCH562+57G75Z6LJywKICAgICAgICAgICAgcHJvcGVydHk6ICd0eXBlJywKICAgICAgICAgICAgd2lkdGg6IDEwMAogICAgICAgICAgfSwgewogICAgICAgICAgICBsYWJlbDogJ+aJgOWxnuWPpeWtkCcsCiAgICAgICAgICAgIHByb3BlcnR5OiAnc2VudGVuY2UnCiAgICAgICAgICB9XSwKICAgICAgICAgIGRhdGE6IFtdCiAgICAgICAgfSwKICAgICAgICBleHRyYURhdGE6IHsKICAgICAgICAgIHBhcmFtRGF0YTogW3t9XSwKICAgICAgICAgIGVudGl0eURhdGE6IFt7fV0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHJlbGF0aW9uRGlhbG9nOiB7CiAgICAgICAgc3RhdGU6IDAsCiAgICAgICAgZGlhbG9nT2JqOiB7CiAgICAgICAgICB0aXRsZTogJ+iuvue9ruagh+etvui/nue6vycsCiAgICAgICAgICB3aWR0aDogJzU2MHB4JwogICAgICAgIH0sCiAgICAgICAgdHlwZTogJ2FkZCcsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgICAgZGF0YToge30sCiAgICAgICAgY3VycmVudFRhYmxlOiB7CiAgICAgICAgICBoZWFkZXJzOiBbXSwKICAgICAgICAgIGRhdGE6IFtdCiAgICAgICAgfQogICAgICB9LAogICAgICBzZW50ZW5jZTogMCwKICAgICAgY29tbWVudHNPcHRpb246IHsKICAgICAgICBjdXJyZW50OiAwLAogICAgICAgIC8vIGZsYWc6IDEsCiAgICAgICAgZmxhZzogMCwKICAgICAgICBkYXRhOiBbewogICAgICAgICAgaWQ6ICcwMjEyMTQyJywKICAgICAgICAgIHR5cGU6ICdub2RlJywKICAgICAgICAgIGNvbnRlbnQ6ICfmtYvor5Xmibnms6gxJywKICAgICAgICAgIGF1dGhvcjogJ+W8oOS4iScKICAgICAgICB9LCB7CiAgICAgICAgICBpZDogJzAyMTIxNDEnLAogICAgICAgICAgdHlwZTogJ25vZGUnLAogICAgICAgICAgY29udGVudDogJ+a1i+ivleaJueazqDInLAogICAgICAgICAgYXV0aG9yOiAn5byg5LiJJwogICAgICAgIH1dCiAgICAgIH0sCiAgICAgIGxpbmVMYWJlbHM6IFtdLAogICAgICBncm91cDogW10sCiAgICAgIGJhY2t1cDogewogICAgICAgIHJlbGF0aW9uOiBbXSwKICAgICAgICBsYWJlbHM6IFtdLAogICAgICAgIHJlbWFya3M6IFtdCiAgICAgIH0sCiAgICAgIGNsYWNSZXN1bHQ6IHsKICAgICAgICByZWxhdGlvbjogW10sCiAgICAgICAgbGFiZWxzOiBbXSwKICAgICAgICByZW1hcmtzOiBbXQogICAgICB9LAogICAgICBkYXRhSW5mbzogewogICAgICAgIGZsYWc6IDAsCiAgICAgICAgYWN0aXZlTmFtZTogJ2VudGl0eScsCiAgICAgICAgY29udGVudDogW10sCiAgICAgICAgcmVsYXRpb246IFtdLAogICAgICAgIHJlbWFya3M6IFtdLAogICAgICAgIGxhYmVsczogW10KICAgICAgfQogICAgfTsKICB9LAoKICBjb21wdXRlZDogewogICAgcGFkZGluZ0xlZnQoKSB7CiAgICAgIHZhciBsZW4gPSBTdHJpbmcodGhpcy5zZW50ZW5jZSkubGVuZ3RoOwogICAgICByZXR1cm4gewogICAgICAgIHBhZGRpbmdMZWZ0OiBsZW4gKiA4ICsgJ3B4JwogICAgICB9OwogICAgfQoKICB9LAoKICBtb3VudGVkKCkgewogICAgdmFyIGggPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLmNvbnRlbnRBcmVhJykuaGVpZ2h0KCk7CiAgICB0aGlzLnNjcm9sbFdpZHRoID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoIi5jb250ZW50QXJlYSIpLndpZHRoKCkgLSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgiLm1haW5Db250ZW50QXJlYSIpLndpZHRoKCk7CiAgICB0aGlzLiRuZXh0VGljayhmdW5jdGlvbiAoKSB7CiAgICAgIGlmICh0aGlzLm1hcmtEYXRhKSB7CiAgICAgICAgdGhpcy51cGRhdGVEYXRhKHRoaXMubWFya0RhdGEpOwogICAgICAgIHRoaXMub3BCYWNrdXBEYXRhKCk7CiAgICAgIH0KICAgIH0pOwogIH0sCgogIG1ldGhvZHM6IHsKICAgIGluaXRDb25maWcoKSB7CiAgICAgIGlmICh0aGlzLmNvbmZpZykgewogICAgICAgIHRoaXMubm9kZURhdGEgPSB0aGlzLmNvbmZpZy5ub2RlRGF0YSB8fCB0aGlzLm5vZGVEYXRhIHx8IFtdOwogICAgICAgIHRoaXMucmVsYXRpb25EYXRhID0gdGhpcy5jb25maWcucmVsYXRpb25EYXRhIHx8IHRoaXMubm9kZURhdGEgfHwgW107CiAgICAgICAgdGhpcy5tb2RlID0gdGhpcy5jb25maWcubW9kZSB8fCB0aGlzLm1vZGUgfHwgJ2VkaXQnOwogICAgICAgIHRoaXMudE1vZGUgPSB0aGlzLmNvbmZpZy50TW9kZSB8fCB0aGlzLnRNb2RlOwoKICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMuc3RhdHVzKSB7CiAgICAgICAgICB0aGlzLnN0YXR1c1trXSA9IHRoaXMuY29uZmlnW2tdIHx8IHRoaXMuc3RhdHVzW2tdIHx8IGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgaWYgKHRoaXMuY29uZmlnLmxhYmVsT3B0aW9uKSB7CiAgICAgICAgICBmb3IgKHZhciBrIGluIHRoaXMubGFiZWxPcHRpb24pIHsKICAgICAgICAgICAgdGhpcy5sYWJlbE9wdGlvbltrXSA9IHRoaXMuY29uZmlnLmxhYmVsT3B0aW9uW2tdIHx8IHRoaXMubGFiZWxPcHRpb25ba107CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIC8v5q+P5qyh5pON5L2c57uT5p2f5ZCO6K+35rGC5ZCO5Y+w5pyA5paw5qCH5rOo5pWw5o2u5pu05paw6aG16Z2i5Lit55qE5qCH5rOo5L+h5oGvCiAgICBmcmVzaERhdGEoKSB7fSwKCiAgICAvL+S/ruaUueaWh+aho+agh+iusOaXtuinpuWPkQogICAgaGFuZGxlRmxhZ0NoYW5nZSgpIHt9LAoKICAgIC8v5om55rOo5Y+R55Sf5Y+Y5YyW5pe26Kem5Y+RCiAgICBoYW5kbGVDb21tZW50Q2hhbmdlKGl0ZW0pIHt9LAoKICAgIGhhbmRsZUVudGVyVXAoZSkge30sCgogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlKHZhbCkgewogICAgICB0aGlzLmxhYmVsRGlhbG9nLmJhdFNlbGVjdCA9IHZhbDsKICAgIH0sCgogICAgaGFuZGxlU2VsZWN0aW9uQ2hhbmdlMSh2YWwpIHsKICAgICAgdGhpcy5yZWxhdGlvbkRpYWxvZy5iYXRTZWxlY3QgPSB2YWw7CiAgICB9LAoKICAgIC8v57yW6L6R5a6e5L2T5oiW5bGe5oCn5a+56K+d5qGG5ZKM57yW6L6R5YWz57O75a+56K+d5qGG5pe277yM5YiH5o2i5om56YeP5L+u5pS56KGo5qC85pi+56S65oiW6ZqQ6JePCiAgICBzd2l0Y2hEaWFsb2dUYWJsZShkaWFsb2dEYXRhKSB7CiAgICAgIGlmIChkaWFsb2dEYXRhLnN0YXRlID09PSAwKSB7CiAgICAgICAgZGlhbG9nRGF0YS5zdGF0ZSA9IDE7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZGlhbG9nRGF0YS5zdGF0ZSA9IDA7CiAgICAgIH0KICAgIH0sCgogICAgLy/moLzlvI/ljJbovazlhaXnmoTmoIfms6jku7vliqHlj4LmlbAo6aG555uu5qCH562+5pWw5o2u5ZKM5Lia5Yqh5pWw5o2uKQogICAgc3dpdGNoTWFya0RhdGEodERhdGEpIHsKICAgICAgaWYgKCF0RGF0YSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIGxhYmVscyA9IHREYXRhLmRvY05vZGVzIHx8IFtdOwogICAgICB2YXIgcGFyYWdyYXBocyA9IHREYXRhLnR4dFBhcmFncmFwaHMgfHwgW107CiAgICAgIHRoaXMuc2VudGVuY2UgPSBwYXJhZ3JhcGhzLmxlbmd0aDsKICAgICAgdGhpcy5jb21tZW50c09wdGlvbi5kYXRhID0gW107CiAgICAgIHZhciByZWxhdGlvbnMgPSB0RGF0YS5kb2NSZWxhdGlvbnMgfHwgW107CiAgICAgIHRoaXMuZGF0YUluZm8uY29udGVudCA9IHBhcmFncmFwaHMubWFwKGl0ZW0gPT4gewogICAgICAgIHJldHVybiBpdGVtLmNvbnRlbnQgfHwgaXRlbTsKICAgICAgfSk7CgogICAgICB2YXIgX3NlbGYgPSB0aGlzOwoKICAgICAgdGhpcy5kYXRhSW5mby5sYWJlbHMgPSBsYWJlbHMubWFwKGl0ZW0gPT4gewogICAgICAgIC8v5b6F5L+u5pS5CiAgICAgICAgaXRlbS5pZCA9IGl0ZW0uX2lkIHx8IGl0ZW0uaWQ7CiAgICAgICAgaXRlbS50ZXh0ID0gaXRlbS5ub2RlX25hbWUgfHwgaXRlbS50ZXh0IHx8ICctJzsKICAgICAgICBpdGVtLmxhYmVsID0gaXRlbS5lbnRpdHlfbmFtZSB8fCBpdGVtLmVudGl0eU5hbWUgfHwgaXRlbS5sYWJlbDsKICAgICAgICB2YXIgdHlwZSA9IGl0ZW0ubm9kZV90eXBlIHx8IGl0ZW0udHlwZTsKICAgICAgICB2YXIgdHlwZU5hbWUgPSBpdGVtLnR5cGVfbmFtZSB8fCBpdGVtLnR5cGVOYW1lIHx8IGl0ZW0ua2V5TmFtZSB8fCBpdGVtLnBhcmFtTmFtZTsKCiAgICAgICAgaWYgKHR5cGUgPT09IDEgJiYgdHlwZU5hbWUgJiYgaXRlbS5sYWJlbCkgewogICAgICAgICAgLy/lrp7kvZPnmoTlsZ7mgKfmoIfnrb4KICAgICAgICAgIGl0ZW0ubGFiZWwgPSB0eXBlTmFtZSArICctJyArIGl0ZW0ubGFiZWw7CiAgICAgICAgICBpdGVtLnR5cGUgPSAncGFyYW0nOwogICAgICAgIH0KCiAgICAgICAgaXRlbS5ncm91cCA9IGl0ZW0uaW5kZXg7IC8v5om55rOo5L+h5oGvCgogICAgICAgIHZhciBjb21tZW50cyA9IGl0ZW0ucG9zdGlsIHx8IGl0ZW0uY29tbWVudHM7CgogICAgICAgIGlmIChjb21tZW50cykgewogICAgICAgICAgLy8gdmFyIHRpbWUgPSB0b29sLnRyYW5zZm9ybVBIUFRpbWUoaXRlbS5jb21tZW50X3RpbWUsIDEpOwogICAgICAgICAgdmFyIGNJdGVtID0gewogICAgICAgICAgICBpZDogaXRlbS5pZCwKICAgICAgICAgICAgY29udGVudDogY29tbWVudHMsCiAgICAgICAgICAgIGF1dGhvcjogaXRlbS5jb21tZW50X3VzZXIgfHwgJy0nLAogICAgICAgICAgICB0aW1lOiB0aW1lIHx8ICcnCiAgICAgICAgICB9OwoKICAgICAgICAgIF9zZWxmLmNvbW1lbnRzT3B0aW9uLmRhdGEucHVzaChjSXRlbSk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICAgIHRoaXMuZGF0YUluZm8ucmVsYXRpb24gPSByZWxhdGlvbnMubWFwKGl0ZW0gPT4gewogICAgICAgIC8v5b6F5L+u5pS5CiAgICAgICAgaXRlbS5zb3VyY2UgPSBpdGVtLnNvdXJjZV9pZCB8fCBpdGVtLnNvdXJjZTsKICAgICAgICBpdGVtLnRhcmdldCA9IGl0ZW0udGFyZ2V0X2lkIHx8IGl0ZW0udGFyZ2V0OwogICAgICAgIGl0ZW0ubGFiZWwgPSBpdGVtLnJlbGF0aW9uX25hbWUgfHwgaXRlbS5yZWxhdGlvbk5hbWUgfHwgaXRlbS5sYWJlbDsKICAgICAgICBpdGVtLmlkID0gaXRlbS5faWQgfHwgaXRlbS5pZCB8fCBpdGVtLnNvdXJjZSArICctJyArIGl0ZW0udGFyZ2V0ICsgJy0nICsgaXRlbS5sYWJlbDsKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8v5qC85byP5YyW5a6e5L2T44CB5bGe5oCn5ZKM5YWz57O75qCH562+5pWw5o2uCiAgICBzd2l0Y2hMYWJlbERhdGEobm9kZURhdGEsIHJlbGF0aW9uRGF0YSkgewogICAgICBub2RlRGF0YSA9IG5vZGVEYXRhIHx8IHRoaXMubm9kZURhdGEgfHwgW107CiAgICAgIHJlbGF0aW9uRGF0YSA9IHJlbGF0aW9uRGF0YSB8fCB0aGlzLnJlbGF0aW9uRGF0YSB8fCBbXTsKICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuZGF0YSA9IG5vZGVEYXRhLm1hcChpdGVtID0+IHsKICAgICAgICBpdGVtLmlkID0gaXRlbS50YWdfdHlwZV9pZCB8fCBpdGVtLmlkOwogICAgICAgIGl0ZW0ubGFiZWwgPSBpdGVtLnRhZ190eXBlX25hbWUgfHwgaXRlbS5sYWJlbCB8fCBpdGVtLm5hbWU7CiAgICAgICAgdmFyIHByb3BlcnRpZXMgPSBpdGVtLnByb3BlcnRpZXMgfHwgW107CiAgICAgICAgaXRlbS5wYXJhbXMgPSBwcm9wZXJ0aWVzLm1hcCh0SXRlbSA9PiB7CiAgICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpZDogdEl0ZW0udGFnX2lkIHx8IHRJdGVtLmlkLAogICAgICAgICAgICBsYWJlbDogdEl0ZW0ubmFtZSB8fCB0SXRlbS5sYWJlbAogICAgICAgICAgfTsKICAgICAgICB9KTsKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CgogICAgICBpZiAocmVsYXRpb25EYXRhICYmIHJlbGF0aW9uRGF0YS5sZW5ndGggIT09IDApIHsKICAgICAgICB0aGlzLnJlbGF0aW9uTGFiZWxUcmVlLmxhYmVscyA9IHJlbGF0aW9uRGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgICBpdGVtLmlkID0gaXRlbS50YWdfaWQgfHwgaXRlbS5pZDsKICAgICAgICAgIGl0ZW0ubGFiZWwgPSBpdGVtLnRhZ19uYW1lIHx8IGl0ZW0ubGFiZWw7CiAgICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICAvL+aTjeS9nOaVsOe7hOWFg+e0oO+8muaVsOe7hOWFg+e0oOS4reWMheWQq+aMh+WumuWxnuaAp+eahCjljLnphY3lsZ7mgKflkI3lkozlgLwp77yM5Lya6KKr5Yig6ZmkCiAgICByZW1vdmVJdGVtKGFyciwgcGFyYW0pIHsKICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWFyY2hBcnJheShhcnIsIHBhcmFtKTsKCiAgICAgIGlmIChpbmRleCAhPT0gLTEpIHsKICAgICAgICBhcnIuc3BsaWNlKGluZGV4LCAxKTsKICAgICAgfQogICAgfSwKCiAgICAvL+aTjeS9nOaMiemSrueCueWHu+S6i+S7tueahOe7n+S4gOWTjeW6lOWHveaVsO+8jOagueaNruaMiemSrueahOWHveaVsOWQjeWKqOaAgeWcsOWbnuiwgwogICAgaGFuZGxlT3BCdG5DbGljayhmdW5jTmFtZSkgewogICAgICBpZiAodHlwZW9mIHRoaXNbZnVuY05hbWVdID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdGhpc1tmdW5jTmFtZV0oKTsKICAgICAgfQogICAgfSwKCiAgICAvL+mAmui/h+WxnuaAp+afpeaJvuaVsOe7hOS4reeahOWFg+e0oOe0ouW8lQogICAgc2VhcmNoQXJyYXkoYXJyLCBwYXJhbSkgewogICAgICB2YXIgcmV0ID0gLTE7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBmbGFnID0gdHJ1ZTsKCiAgICAgICAgZm9yIChsZXQgayBpbiBwYXJhbSkgewogICAgICAgICAgZmxhZyA9IGZsYWcgJiYgcGFyYW1ba10gPT09IGFycltpXVtrXTsKICAgICAgICB9CgogICAgICAgIGlmIChmbGFnKSB7CiAgICAgICAgICByZXQgPSBpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfSwKCiAgICAvL+abtOaWsOagh+etvue8lui+keeahOWvueivneahhuWGheWuuQogICAgdXBkYXRlTGFiZWxEaWFsb2coKSB7CiAgICAgIHZhciBkYXRhID0gdGhpcy5sYWJlbERpYWxvZy5kYXRhOwogICAgICB0aGlzLmxhYmVsRGlhbG9nLnN0YXRlID0gMDsKICAgICAgdmFyIHR5cGUgPSBkYXRhLnR5cGUgfHwgJ2VudGl0eSc7CiAgICAgIHRoaXMuZW50aXR5TGFiZWxUcmVlLmRlZmF1bHRFbnRpdHkgPSBbXTsKICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuc2VsZWN0ID0gW107CiAgICAgIHRoaXMuZW50aXR5TGFiZWxUcmVlLmRlZmF1bHRQYXJhbSA9IFtdOwoKICAgICAgaWYgKHR5cGUgPT09ICdlbnRpdHknICYmIHRoaXMubGFiZWxEaWFsb2cudHlwZSAhPT0gJ2FkZCcpIHsKICAgICAgICB0aGlzLmVudGl0eUxhYmVsVHJlZS5kZWZhdWx0RW50aXR5ID0gW2RhdGEuZW50aXR5X2lkXTsKICAgICAgICB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50ID0gewogICAgICAgICAgZW50aXR5OiB7CiAgICAgICAgICAgIGlkOiBkYXRhLmVudGl0eV9pZCwKICAgICAgICAgICAgbGFiZWw6IGRhdGEuZW50aXR5X25hbWUKICAgICAgICAgIH0KICAgICAgICB9OwogICAgICB9IGVsc2UgaWYgKGRhdGEgJiYgZGF0YS5lbnRpdHlfaWQpIHsKICAgICAgICB2YXIgdEFyciA9IHRoaXMuZW50aXR5TGFiZWxUcmVlLmRhdGE7CiAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudCA9IHsKICAgICAgICAgIF9lbnRpdHk6IHsKICAgICAgICAgICAgaWQ6IGRhdGEuZW50aXR5X2lkLAogICAgICAgICAgICBsYWJlbDogZGF0YS5lbnRpdHlfbmFtZQogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgdmFyIGluZGV4ID0gdGhpcy5zZWFyY2hBcnJheSh0QXJyLCB7CiAgICAgICAgICBpZDogZGF0YS5lbnRpdHlfaWQKICAgICAgICB9KTsKCiAgICAgICAgaWYgKGluZGV4ICE9PSAtMSAmJiB0QXJyW2luZGV4XSkgewogICAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuZGVmYXVsdEVudGl0eSA9IFtdOwogICAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuc2VsZWN0ID0gdEFycltpbmRleF0ucGFyYW1zOyAvLyB0aGlzLmVudGl0eUxhYmVsVHJlZS5kZWZhdWx0UGFyYW0gPSBbZGF0YS50eXBlX2lkXTsKICAgICAgICAgIC8vIOeUseS6juS7u+WKoeeuoeeQhi3moIfms6jpg6jliIbvvIzlj7PkvqfooajmoLznlKjnmoTmmK/nrpfms5XnmoTmnKzkvZPvvIzph4zovrnmsqHmnIl0eXBlX2lk77yM5omA5Lul5pqC5pe255SodHlwZV9uYW1l5Luj5pu/CgogICAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuZGVmYXVsdFBhcmFtID0gW2RhdGEudHlwZV9uYW1lXTsKICAgICAgICAgIHRoaXMuZW50aXR5TGFiZWxUcmVlLmN1cnJlbnQucGFyYW0gPSB7CiAgICAgICAgICAgIGlkOiBkYXRhLnR5cGVfaWQsCiAgICAgICAgICAgIGxhYmVsOiBkYXRhLnR5cGVfbmFtZQogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0gLy90b2RvOiDlj6/ku6Xmt7vliqDmmL7npLrnm7jlhbPmoIfnrb7liJfooajvvIzov5vooYzmibnph4/kv67mlLk7CgogICAgfSwKCiAgICAvL+iOt+WPluWunuS9k+agh+etvuWIl+ihqOS4reafkOS4quWunuS9k+agh+etvueahOWxnuaAp+agh+etvuWIl+ihqAogICAgZ2V0UGFyYW1MaXN0KGxhYmVsKSB7CiAgICAgIHZhciByZXQgPSBbXTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGhpcy5lbnRpdHlMYWJlbFRyZWUuZGF0YS5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLmVudGl0eUxhYmVsVHJlZS5kYXRhW2ldOwoKICAgICAgICBpZiAoZW50aXR5LmxhYmVsID09PSBsYWJlbCkgewogICAgICAgICAgcmV0ID0gZW50aXR5LnBhcmFtcyB8fCBbXTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJldDsKICAgIH0sCgogICAgLy/mm7TmlrDmoIfnrb7ov57nur/nvJbovpHnmoTlr7nor53moYblhoXlrrkKICAgIHVwZGF0ZVJlbGF0aW9uRGlhbG9nKCkgewogICAgICB0aGlzLnJlbGF0aW9uRGlhbG9nLnN0YXRlID0gMDsKICAgICAgdmFyIHJEYXRhID0gdGhpcy5yZWxhdGlvbkRpYWxvZy5kYXRhOyAvL+iuvue9rum7mOiupOmAieS4remhuQoKICAgICAgdGhpcy5yZWxhdGlvbkxhYmVsVHJlZS5kZWZhdWx0UmVsYXRpb24gPSBbckRhdGEucmVsYXRpb25faWRdOwogICAgICB2YXIgc2lkID0gckRhdGEuc291cmNlOwogICAgICB2YXIgdGlkID0gckRhdGEudGFyZ2V0OwogICAgICB2YXIgc0luZGV4ID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoYC5zcGFuSXRlbVtpZD0nJHtzaWR9J11gKS5hdHRyKCdfaW5kZXgnKTsKICAgICAgdmFyIHRJbmRleCA9ICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuc3Bhbkl0ZW1baWQ9JyR7dGlkfSddYCkuYXR0cignX2luZGV4Jyk7CiAgICAgIHZhciBzRGF0YSA9IHRoaXMuZGF0YUluZm8ubGFiZWxzW3NJbmRleF07CiAgICAgIHZhciB0RGF0YSA9IHRoaXMuZGF0YUluZm8ubGFiZWxzW3RJbmRleF07CiAgICAgIHZhciBzVHlwZSA9IHNEYXRhLnR5cGUgfHwgJ2VudGl0eSc7CiAgICAgIHZhciB0VHlwZSA9IHREYXRhLnR5cGUgfHwgJ2VudGl0eSc7CiAgICAgIHZhciB0eXBlID0gJ3BhcmFtJzsKICAgICAgdGhpcy5yZWxhdGlvbkRpYWxvZy5zb3VyY2UgPSBzRGF0YS50ZXh0OwogICAgICB0aGlzLnJlbGF0aW9uRGlhbG9nLnRhcmdldCA9IHREYXRhLnRleHQ7CgogICAgICBpZiAoc1R5cGUgIT09ICdlbnRpdHknKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSgn6LW35aeL5qCH562+6ZyA6KaB5Li65a6e5L2T44CCJyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICByRGF0YS50eXBlID0gMDsKCiAgICAgIGlmIChzVHlwZSA9PT0gJ2VudGl0eScgJiYgdFR5cGUgPT09ICdlbnRpdHknKSB7CiAgICAgICAgdHlwZSA9ICdyZWxhdGlvbic7CiAgICAgICAgckRhdGEudHlwZSA9IDE7CiAgICAgICAgdGhpcy5yZWxhdGlvbkxhYmVsVHJlZS5kYXRhID0gdGhpcy5yZWxhdGlvbkxhYmVsVHJlZS5sYWJlbHM7CgogICAgICAgIGlmICghdGhpcy5yZWxhdGlvbkxhYmVsVHJlZS5kYXRhIHx8IHRoaXMucmVsYXRpb25MYWJlbFRyZWUuZGF0YS5sZW5ndGggPT09IDApIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoJ+e8uuWwkeWFs+ezu+agh+etvuaVsOaNricpOwogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfSBlbHNlIGlmIChzVHlwZSA9PT0gJ2VudGl0eScgJiYgdFR5cGUgIT09ICdlbnRpdHknKSB7CiAgICAgICAgdGhpcy5yZWxhdGlvbkxhYmVsVHJlZS5kYXRhID0gdGhpcy5nZXRQYXJhbUxpc3Qoc0RhdGEubGFiZWwpOwoKICAgICAgICBpZiAoIXRoaXMucmVsYXRpb25MYWJlbFRyZWUuZGF0YSB8fCB0aGlzLnJlbGF0aW9uTGFiZWxUcmVlLmRhdGEubGVuZ3RoID09PSAwKSB7CiAgICAgICAgICB0aGlzLiRtZXNzYWdlKGBbJHtzRGF0YS5sYWJlbH1d5a6e5L2T5rKh5pyJ6YWN572u5bGe5oCn5qCH562+5pWw5o2u44CCYCk7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICB9IGVsc2Ugey8vIHRoaXMucmVsYXRpb25MYWJlbFRyZWUuZGF0YSA9IHRoaXMuZ2V0UGFyYW1MaXN0KHREYXRhLmxhYmVsKTsKICAgICAgfQoKICAgICAgdGhpcy5yZWxhdGlvbkRpYWxvZy5saW5lVHlwZSA9IHR5cGU7CiAgICAgIHRoaXMucmVsYXRpb25EaWFsb2cuY3VycmVudExhYmVsID0gckRhdGEubGFiZWwgfHwgJyc7IC8vVG9kbzog5Y+v5Lul5pi+56S655u45YWz5pWw5o2u5YiX6KGo77yM6L+b6KGM5om56YeP5L+u5pS5CgogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0sCgogICAgLy/liIfmjaLnrpfms5XmoIfms6jnu5PmnpwKICAgIHN3aXRjaENsYWNMYWJlbE1vZGUoKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruWunuWIh+aNouaYvuekuueul+azleagh+azqOe7k+aenOWQl++8nycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICB0aGlzLiRlbWl0KCJjb25maXJtQWxnb3JpdGhtUmVzdWx0Iik7CiAgICAgIH0pOwogICAgfSwKCiAgICAvL+WIh+aNouaYvuekuuaJueazqOWIl+ihqAogICAgc3dpdGNoQ29tbWVudE1vZGUoKSB7CiAgICAgIGlmICh0aGlzLmNvbW1lbnRzT3B0aW9uLmZsYWcgPT09IDApIHsKICAgICAgICB0aGlzLmNvbW1lbnRzT3B0aW9uLmZsYWcgPSAxOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZmxhZyA9IDA7CiAgICAgIH0KCiAgICAgIHRoaXMudXBkYXRlQ29tbWVudExpc3QoKTsKICAgICAgdGhpcy5zY3JvbGxXaWR0aCA9ICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCIuY29udGVudEFyZWEiKS53aWR0aCgpIC0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoIi5tYWluQ29udGVudEFyZWEiKS53aWR0aCgpOwogICAgfSwKCiAgICAvL+agh+azqOihjOS4uuS6p+eUn+eahOaVsOaNruS8muWunuaXtuS/neWtmO+8jOS/neWtmOaMiemSruWPquS9nOaPkOekuueUqAogICAgc2F2ZUxhYmVsRGF0YSgpIHsKICAgICAgdGhpcy4kbWVzc2FnZSgn5bey5L+d5a2Y44CCJyk7CiAgICB9LAoKICAgIC8v5pKk6ZSA5b2T5YmN5pON5L2cCiAgICByZWRvTGFiZWxPcCgpIHsKICAgICAgLy/lj5HpgIHmkqTplIDkuIrmrKHmk43kvZzor7fmsYIKICAgICAgdmFyIF9zZWxmID0gdGhpczsKCiAgICAgIGlmICh0aGlzLmJhY2t1cE9wICYmIHRoaXMuYmFja3VwT3AudHlwZSkgewogICAgICAgIHRoaXMuJGVtaXQoInVuZG8iLCB0aGlzLmJhY2t1cE9wKTsKICAgICAgfQogICAgfSwKCiAgICAvL+agh+azqOaTjeS9nOS/oeaBr+eahOWkh+S7vQogICAgb3BCYWNrdXAodHlwZSwgcGFyYW0pIHsKICAgICAgdGhpcy5iYWNrdXBPcCA9IHsKICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgIGRhdGE6IHBhcmFtLAogICAgICAgIHRhc2tfaWQ6IHRoaXMuY3VycmVudEluZm8udGFza19pZCwKICAgICAgICBkb2NfaWQ6IHRoaXMuY3VycmVudEluZm8uZG9jX2lkLAogICAgICAgIHVzZXJfaWQ6IHRoaXMuY3VycmVudEluZm8udXNlcl9pZCB8fCAnLScsCiAgICAgICAgZ3JvdXBfbnVtOiB0aGlzLmN1cnJlbnRJbmZvLmdyb3VwTnVtCiAgICAgIH07CiAgICB9LAoKICAgIC8v5aSH5Lu95pON5L2c5YmN55qE5qCH562+5pWw5o2uCiAgICBvcEJhY2t1cERhdGEoZmxhZykgewogICAgICBpZiAoZmxhZykgewogICAgICAgIHRoaXMuZGF0YUluZm8uZmxhZyA9IDA7CiAgICAgICAgdGhpcy5jb21tZW50c09wdGlvbi5kYXRhID0gW107CgogICAgICAgIGZvciAobGV0IGsgaW4gdGhpcy5iYWNrdXApIHsKICAgICAgICAgIHRoaXMuZGF0YUluZm9ba10gPSBbXTsKCiAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuYmFja3VwW2tdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIGlmIChrID09PSAncmVtYXJrcycpIHsKICAgICAgICAgICAgICB0aGlzLmNvbW1lbnRzT3B0aW9uLmRhdGEucHVzaCh7IC4uLnRoaXMuYmFja3VwW2tdW2ldCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5kYXRhSW5mb1trXS5wdXNoKHsgLi4udGhpcy5iYWNrdXBba11baV0KICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLmRhdGFJbmZvLnJlbWFya3MgPSB0aGlzLmNvbW1lbnRzT3B0aW9uLmRhdGE7CgogICAgICAgIGZvciAobGV0IGsgaW4gdGhpcy5iYWNrdXApIHsKICAgICAgICAgIHRoaXMuYmFja3VwW2tdID0gW107CgogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLmRhdGFJbmZvW2tdLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgICAgIHRoaXMuYmFja3VwW2tdLnB1c2goeyAuLi50aGlzLmRhdGFJbmZvW2tdW2ldCiAgICAgICAgICAgIH0pOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvL+a4heepuuagh+etvuaVsOaNrgogICAgcmVtb3ZlTGFiZWxJbmZvKCkgewogICAgICB0aGlzLiRjb25maXJtKCfnoa7lrp7opoHmuIXnqbrmiYDmnInmoIfnrb7lkJfvvJ8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu5a6aJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgdGhpcy4kZW1pdCgiY29uZmlybUNsZWFyRGF0YSIpOwogICAgICB9KTsKICAgIH0sCgogICAgLy/lrp7kvZPmoIfnrb7moJHpgInkuK3lj5jljJbnmoTlk43lupTlh73mlbAKICAgIGVudGl0eUxhYmVsQ2hhbmdlKGRhdGEsIGNoZWNrZWQpIHsKICAgICAgLy8gY29uc29sZS5sb2coZGF0YSwgY2hlY2tlZCwgbm9kZSwgJzA4Jyk7CiAgICAgIHZhciBub2RlRGF0YSA9IHRoaXMubGFiZWxEaWFsb2cuZGF0YTsKICAgICAgdmFyIHJJbmRleCA9IHRoaXMuZmluZFJlbGF0aW9uKG5vZGVEYXRhLmlkKTsKCiAgICAgIGlmIChjaGVja2VkICYmIHRoaXMuJHJlZnMuZW50aXR5TGFiZWxUcmVlKSB7CiAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudCA9IHRoaXMuZW50aXR5TGFiZWxUcmVlLmN1cnJlbnQgfHwge307CgogICAgICAgIGlmIChkYXRhLnBhcmFtcykgewogICAgICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuc2VsZWN0ID0gW107CgogICAgICAgICAgaWYgKHRoaXMubGFiZWxEaWFsb2cuZGF0YS50eXBlID09PSAncGFyYW0nICYmIHJJbmRleCAhPT0gLTEpIHsKICAgICAgICAgICAgdGhpcy4kbWVzc2FnZSgn6ZyA6KaB5YWI5Yig6Zmk5qCH562+5LiK55qE6L+e57q/77yM5omN6IO95pS55Li65a6e5L2T5qCH562+Jyk7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KCiAgICAgICAgICB0aGlzLiRyZWZzLmVudGl0eUxhYmVsVHJlZS5zZXRDaGVja2VkTm9kZXMoW2RhdGFdKTsKICAgICAgICAgIHRoaXMuZW50aXR5TGFiZWxUcmVlLmN1cnJlbnQuZW50aXR5ID0gZGF0YTsKICAgICAgICAgIHRoaXMuZW50aXR5TGFiZWxUcmVlLmN1cnJlbnQucGFyYW0gPSBudWxsOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAodGhpcy5sYWJlbERpYWxvZy5kYXRhLnR5cGUgIT09ICdwYXJhbScgJiYgckluZGV4ICE9PSAtMSkgewogICAgICAgICAgICB0aGlzLiRyZWZzLmVudGl0eVBhcmFtTGlzdC5zZXRDaGVja2VkTm9kZXMoW10pOwogICAgICAgICAgICB0aGlzLiRtZXNzYWdlKCfpnIDopoHlhYjliKDpmaTmoIfnrb7kuIrnmoTov57nur/vvIzmiY3og73mlLnkuLrlsZ7mgKfmoIfnrb4nKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQoKICAgICAgICAgIHRoaXMuJHJlZnMuZW50aXR5TGFiZWxUcmVlLnNldENoZWNrZWROb2RlcyhbXSk7CiAgICAgICAgICB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50LmVudGl0eSA9IG51bGw7CiAgICAgICAgICB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50LnBhcmFtID0gZGF0YTsKICAgICAgICAgIHRoaXMuJHJlZnMuZW50aXR5UGFyYW1MaXN0LnNldENoZWNrZWROb2RlcyhbZGF0YV0pOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsvLyB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50LmVudGl0eSA9IG51bGw7CiAgICAgICAgLy8gdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5wYXJhbSA9IG51bGw7CiAgICAgIH0KICAgIH0sCgogICAgLy/lhbPns7vmoIfnrb7moJHpgInkuK3lj5jljJbnmoTlk43lupTlh73mlbAo5Y+q5o6n5Yi25aSa6YCJ5Li65Y2V6YCJKQogICAgcmVsYXRpb25MYWJlbENoYW5nZShkYXRhLCBjaGVja2VkKSB7CiAgICAgIGlmIChjaGVja2VkICYmIHRoaXMuJHJlZnMucmVsYXRpb25MYWJlbFRyZWUpIHsKICAgICAgICB0aGlzLiRyZWZzLnJlbGF0aW9uTGFiZWxUcmVlLnNldENoZWNrZWROb2RlcyhbZGF0YV0pOwogICAgICB9CiAgICB9LAoKICAgIC8v5YWz57O75qCH562+5qCR77yM6YCJ5Lit5a+56LGh5Y+R55Sf5Y+Y5YyW5pe25pu05paw5YWz57O75qCH562+5ZCN56ewCiAgICByZWxhdGlvbkN1cnJlbnRDaGFuZ2UoYSwgYikgewogICAgICBpZiAoYi5jaGVja2VkTm9kZXMubGVuZ3RoICE9PSAwKSB7CiAgICAgICAgdGhpcy5yZWxhdGlvbkRpYWxvZy5zZWxlY3RMYWJlbCA9IGEubGFiZWw7CiAgICAgICAgdGhpcy5yZWxhdGlvbkRpYWxvZy5jdXJyZW50ID0gYTsKICAgICAgfSBlbHNlIHsKICAgICAgICB0aGlzLnJlbGF0aW9uRGlhbG9nLnNlbGVjdExhYmVsID0gJyc7CiAgICAgIH0KICAgIH0sCgogICAgLy/lrp7kvZPmiJblsZ7mgKfmoIfnrb7moJHpgInkuK3lj5HnlJ/lj5jljJbml7bop6blj5Hor6Xlk43lupTlh73mlbAKICAgIGhhbmRsZUxhYmVsQ2xpY2soZGF0YSkgewogICAgICB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50ID0gdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudCB8fCB7fTsKICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5fZW50aXR5ID0gZGF0YTsKICAgICAgdGhpcy5lbnRpdHlMYWJlbFRyZWUuc2VsZWN0ID0gZGF0YS5wYXJhbXM7CiAgICB9LAoKICAgIC8v5Yig6Zmk5qCH5rOoCiAgICBkZWFsQ2xpY2tSZW1vdmVDb21tZW50cyhpdGVtKSB7CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruWunuimgeWIoOmZpOaJueazqOWQl++8nycsICfmj5DnpLonLCB7CiAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgIGNhbmNlbEJ1dHRvblRleHQ6ICflj5bmtognLAogICAgICAgIHR5cGU6ICd3YXJuaW5nJwogICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAvL+aTjeS9nOWJjeWkh+S7vQogICAgICAgIHRoaXMub3BCYWNrdXBEYXRhKCk7CgogICAgICAgIHZhciBfaW5kZXggPSAkKCcjJyArIGl0ZW0uaWQpLmF0dHIoJ19pbmRleCcpOwoKICAgICAgICB2YXIgbm9kZURhdGEgPSB0aGlzLmRhdGFJbmZvLmxhYmVsc1tfaW5kZXhdOwogICAgICAgIHRoaXMub3BCYWNrdXAoJ3VwZGF0ZV9ub2RlJywgW3sgLi4ubm9kZURhdGEKICAgICAgICB9XSk7IC8vIHZhciBub2RlRGF0YSA9IHRoaXMuZ3JvdXBbbm9kZURhdGEuZ3JvdXBdLmxhYmVsc1tub2RlRGF0YS5pbmRleF07CgogICAgICAgIG5vZGVEYXRhLnBvc3RpbCA9ICcnOwogICAgICAgIHRoaXMuJGVtaXQoImNvbmZpcm1EZWxldGVDb21tZW50cyIsIG5vZGVEYXRhKTsKICAgICAgfSk7CiAgICB9LAoKICAgIC8v5YiH5o2i5bel5YW355qE5Yqf6IO95qih5byP77ya5qCH5rOo5qih5byP5oiW6aKE6KeI5qih5byPCiAgICBzd2l0Y2hUb29sTW9kZSgpIHsKICAgICAgaWYgKHRoaXMubW9kZSA9PT0gJ3ZpZXcnKSB7CiAgICAgICAgdGhpcy5tb2RlID0gJ2VkaXQnOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMubW9kZSA9ICd2aWV3JzsKICAgICAgfQoKICAgICAgdGhpcy51cGRhdGVDb250ZW50QXJlYSgpOwogICAgfSwKCiAgICAvL+abv+aNouW9k+WJjeeahOagh+azqOaVsOaNrgogICAgdXBkYXRlRGF0YShtYXJrRGF0YSkgewogICAgICB0aGlzLmluaXRDb25maWcoKTsKICAgICAgdGhpcy5jdXJyZW50SW5mbyA9IG1hcmtEYXRhOwogICAgICB0aGlzLmRhdGFJbmZvLnJlbGF0aW9uID0gW107CiAgICAgIHRoaXMuZGF0YUluZm8ubGFiZWxzID0gW107CiAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YSA9IFtdOwogICAgICB0aGlzLmRhdGFJbmZvLnJlbWFya3MgPSBbXTsKICAgICAgdGhpcy5zd2l0Y2hNYXJrRGF0YShtYXJrRGF0YSk7CiAgICAgIHRoaXMuc3dpdGNoTGFiZWxEYXRhKCk7CiAgICAgIHRoaXMudXBkYXRlQ29udGVudEFyZWEoKTsKICAgIH0sCgogICAgLy/pgJrov4dpZOWIoOmZpOagh+etvui/nue6v+eahOaVsOe7hOWFg+e0oAogICAgcmVtb3ZlUmVsYXRpb25CeUlkKGlkLCBmbGFnKSB7CiAgICAgIGlmICghZmxhZykgewogICAgICAgIHRoaXMucmVtb3ZlSXRlbSh0aGlzLmRhdGFJbmZvLnJlbGF0aW9uLCB7CiAgICAgICAgICBzb3VyY2U6IGlkCiAgICAgICAgfSk7CiAgICAgICAgdGhpcy5yZW1vdmVJdGVtKHRoaXMuZGF0YUluZm8ucmVsYXRpb24sIHsKICAgICAgICAgIHRhcmdldDogaWQKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgcGFyYW0gPSB7fTsKICAgICAgICBwYXJhbVtmbGFnXSA9IGlkOwogICAgICAgIHRoaXMucmVtb3ZlSXRlbSh0aGlzLmRhdGFJbmZvLnJlbGF0aW9uLCBwYXJhbSk7CiAgICAgIH0KICAgIH0sCgogICAgLy/pgJrov4fmupDmoIfnrb5JROaIluebruagh+agh+etvklE5p+l5om+5YWz57O76L+e57q/77yM6L+U5Zue57uT5p6c55qE57Si5byVCiAgICBmaW5kUmVsYXRpb24oc291cmNlLCB0YXJnZXQpIHsKICAgICAgdmFyIHJldCA9IC0xOwogICAgICB2YXIgYXJyID0gdGhpcy5kYXRhSW5mby5yZWxhdGlvbjsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGFycltpXS5zb3VyY2UgPT09IHNvdXJjZSAmJiBhcnJbaV0udGFyZ2V0ID09PSB0YXJnZXQpIHsKICAgICAgICAgIHJldCA9IGk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CgogICAgICAgIGlmICghdGFyZ2V0ICYmIChhcnJbaV0uc291cmNlID09PSBzb3VyY2UgfHwgYXJyW2ldLnRhcmdldCA9PT0gc291cmNlKSkgewogICAgICAgICAgcmV0ID0gaTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJldDsKICAgIH0sCgogICAgLy/pgJrov4fmrrXokL3nvJblj7flkozmoIfnrb7ntKLlvJXmn6Xmib7mibnms6jlr7nosaEKICAgIGZpbmRDb21tZW50SXRlbShncm91cCwgaW5kZXgpIHsKICAgICAgdmFyIHJldCA9IC0xOwogICAgICB2YXIgYXJyID0gdGhpcy5jb21tZW50c09wdGlvbi5kYXRhOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBpZiAoYXJyW2ldLmdyb3VwID09PSBncm91cCAmJiBhcnJbaV0uaW5kZXggPT09IGluZGV4KSB7CiAgICAgICAgICByZXQgPSBpOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfSwKCiAgICAvL+WTjeW6lOaWh+acrOmAieaLqeS6i+S7tgogICAgaGFuZGxlU2VsZWN0VGV4dChlKSB7CiAgICAgIGlmICh0aGlzLm1vZGUgPT09ICd2aWV3JykgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIGVsZW0gPSB0aGlzLiRyZWZzLmVudGl0eUNvbnRlbnRBcmVhOwogICAgICBsZXQgdHh0ID0gd2luZG93LmdldFNlbGVjdGlvbiA/IHdpbmRvdy5nZXRTZWxlY3Rpb24oKSA6IGVsZW0uc2VsZWN0aW9uLmNyZWF0ZVJhbmdlKCkudGV4dDsKICAgICAgdmFyIHNUZXh0ID0gdHh0LnRvU3RyaW5nKCk7CgogICAgICBpZiAodHh0LnR5cGUgIT09ICdSYW5nZScpIHsKICAgICAgICAvLyB0aGlzLiRtZXNzYWdlKCfor7fmgqjku47lt6bliLDlj7PliJLpgInmloflrZfov5vooYzmoIfms6jjgIInKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmIChzVGV4dCAhPT0gJycpIHsKICAgICAgICB2YXIgcmV0ID0gdGhpcy5nZXRTZWxlY3RUZXh0T2Zmc2V0KHR4dCk7IC8v6YCJ5Lit5paH5pys5pWw5o2uCgogICAgICAgIHJldC5ncm91cCA9IGUuc3JjRWxlbWVudC5nZXRBdHRyaWJ1dGUoJ2luZGV4JykgLSAxOwoKICAgICAgICBpZiAocmV0LnRleHQgPT09ICcnIHx8IGUuc3JjRWxlbWVudC5jbGFzc05hbWUgIT09ICdjb250ZW50SXRlbScpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoJ+m8oOagh+WIkumAieWGheWuueaXoOaViOOAgicpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aGlzLmxhYmVsRGlhbG9nLmRpYWxvZ09iai50aXRsZSA9ICfpgInmi6nmoIfnrb4o5a6e5L2TL+WxnuaApyknOwogICAgICAgICAgdGhpcy5sYWJlbERpYWxvZy50eXBlID0gJ2FkZCc7CiAgICAgICAgICB0aGlzLmxhYmVsRGlhbG9nLmRhdGEgPSByZXQ7CiAgICAgICAgICB0aGlzLnVwZGF0ZUxhYmVsRGlhbG9nKCk7CiAgICAgICAgICB0aGlzLmxhYmVsRGlhbG9nLnZpc2libGUgPSB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKCiAgICAvL+ehruiupOWunuS9k+WxnuaAp+agh+etvuaTjeS9nOWvueivneahhuWvueagh+etvueahOaTjeS9nAogICAgZGVhbENvbmZpcm1MYWJlbCh2YWwpIHsKICAgICAgaWYgKCF2YWwpIHsKICAgICAgICB0aGlzLmxhYmVsRGlhbG9nLnZpc2libGUgPSBmYWxzZTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudCB8fCAhdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5wYXJhbSAmJiAhdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5lbnRpdHkpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKCfpnIDopoHpgInmi6nkuIDkuKrmoIfnrb7jgIInKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy/lsIbmoIfnrb7mlbDmja7lpIfku70KCgogICAgICB0aGlzLm9wQmFja3VwRGF0YSgpOwogICAgICB2YXIgbGFiZWwgPSAnJzsKICAgICAgdmFyIHBhcmFtID0gdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5wYXJhbTsKICAgICAgdmFyIGRhdGEgPSB0aGlzLmxhYmVsRGlhbG9nLmRhdGE7CiAgICAgIHZhciBvbGRlckRhdGEgPSB7IC4uLmRhdGEKICAgICAgfTsKCiAgICAgIGlmIChwYXJhbSkgewogICAgICAgIHZhciBfZW50aXR5ID0gdGhpcy5lbnRpdHlMYWJlbFRyZWUuY3VycmVudC5fZW50aXR5OwogICAgICAgIGxhYmVsID0gcGFyYW0ubGFiZWwgKyAnLScgKyBfZW50aXR5LmxhYmVsOwogICAgICAgIGRhdGEudHlwZSA9ICdwYXJhbSc7CiAgICAgICAgZGF0YS5ub2RlX3R5cGUgPSAxOwogICAgICAgIGRhdGEudHlwZV9pZCA9IHBhcmFtLmlkOwogICAgICAgIGRhdGEudHlwZV9uYW1lID0gcGFyYW0ubGFiZWw7CiAgICAgICAgZGF0YS5lbnRpdHlfaWQgPSBfZW50aXR5LmlkOwogICAgICAgIGRhdGEuZW50aXR5X25hbWUgPSBfZW50aXR5LmxhYmVsOwogICAgICB9IGVsc2UgewogICAgICAgIHZhciBlbnRpdHkgPSB0aGlzLmVudGl0eUxhYmVsVHJlZS5jdXJyZW50LmVudGl0eTsKICAgICAgICBsYWJlbCA9IGVudGl0eS5sYWJlbDsKICAgICAgICBkYXRhLnR5cGUgPSAnZW50aXR5JzsKICAgICAgICBkYXRhLm5vZGVfdHlwZSA9IDA7CiAgICAgICAgZGF0YS5lbnRpdHlfaWQgPSBlbnRpdHkuaWQ7CiAgICAgICAgZGF0YS5lbnRpdHlfbmFtZSA9IGVudGl0eS5sYWJlbDsKICAgICAgfQoKICAgICAgdmFyIF9zZWxmID0gdGhpczsKCiAgICAgIGRhdGEuaW5kZXggPSBkYXRhLmdyb3VwOwogICAgICBkYXRhLnRhc2tfaWQgPSB0aGlzLmN1cnJlbnRJbmZvLnRhc2tfaWQgfHwgdGhpcy5jdXJyZW50SW5mby50YXNrSWQ7CiAgICAgIGRhdGEubm9kZV9uYW1lID0gZGF0YS50ZXh0OwogICAgICBkYXRhLmRvY19pZCA9IHRoaXMuY3VycmVudEluZm8uZG9jX2lkOwoKICAgICAgaWYgKHRoaXMudG9vbEJhcikgewogICAgICAgIGRhdGEuaW5kZXggPSBkYXRhLmluZGV4ICsgMTsKICAgICAgfQoKICAgICAgdGhpcy4kZW1pdCgnY29uZmlybUNoYW5nZUxhYmVsJywgdGhpcy5kYXRhSW5mby5sYWJlbHMsIGRhdGEsIHRoaXMubGFiZWxEaWFsb2cuYmF0U2VsZWN0KTsKICAgICAgdGhpcy5sYWJlbERpYWxvZy52aXNpYmxlID0gZmFsc2U7CiAgICB9LAoKICAgIC8v56Gu6K6k5YWz57O75bGe5oCn6L+e57q/5qCH562+5pON5L2c5a+56K+d5qGG5a+55qCH562+55qE5pON5L2cCiAgICBkZWFsQ29uZmlybVJlbGF0aW9uKHZhbCkgewogICAgICBpZiAoIXZhbCkgewogICAgICAgIHRoaXMucmVsYXRpb25EaWFsb2cudmlzaWJsZSA9IGZhbHNlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgdmFyIG5vZGVEYXRhID0gdGhpcy4kcmVmcy5yZWxhdGlvbkxhYmVsVHJlZS5nZXRDaGVja2VkTm9kZXMoKVswXTsKCiAgICAgIGlmICghbm9kZURhdGEpIHsKICAgICAgICB0aGlzLiRtZXNzYWdlKCfpnIDopoHpgInmi6nkuIDkuKrmoIfnrb7jgIInKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gLy/lsIbmoIfnrb7mlbDmja7lpIfku70KCgogICAgICB0aGlzLm9wQmFja3VwRGF0YSgpOwogICAgICB2YXIgckRhdGEgPSB0aGlzLnJlbGF0aW9uRGlhbG9nLmRhdGE7CiAgICAgIHZhciBsVHlwZSA9IHRoaXMucmVsYXRpb25EaWFsb2cubGluZVR5cGU7CiAgICAgIHZhciBvbGRlckRhdGEgPSB7IC4uLnJEYXRhCiAgICAgIH07CgogICAgICBpZiAobFR5cGUgPT09ICdyZWxhdGlvbicpIHsKICAgICAgICByRGF0YS50eXBlID0gMTsKICAgICAgfSBlbHNlIHsKICAgICAgICByRGF0YS50eXBlID0gMDsKICAgICAgfQoKICAgICAgckRhdGEucmVsYXRpb25faWQgPSBub2RlRGF0YS5pZDsKICAgICAgckRhdGEubGFiZWwgPSBub2RlRGF0YS5sYWJlbDsKICAgICAgckRhdGEudGFza19pZCA9IHRoaXMuY3VycmVudEluZm8udGFza19pZCB8fCB0aGlzLmN1cnJlbnRJbmZvLnRhc2tJZDsKICAgICAgckRhdGEucmVsYXRpb25fbmFtZSA9IG5vZGVEYXRhLmxhYmVsOwogICAgICByRGF0YS5kb2NfaWQgPSB0aGlzLmN1cnJlbnRJbmZvLmRvY19pZDsKICAgICAgckRhdGEuc291cmNlX2lkID0gckRhdGEuc291cmNlOwogICAgICByRGF0YS50YXJnZXRfaWQgPSByRGF0YS50YXJnZXQ7CiAgICAgIHRoaXMuJGVtaXQoJ2NvbmZpcm1DaGFuZ2VSZWxhdGlvbicsIHRoaXMuZGF0YUluZm8ucmVsYXRpb24sIHJEYXRhLCB0aGlzLnJlbGF0aW9uRGlhbG9nLmJhdFNlbGVjdCk7CiAgICAgIHRoaXMucmVsYXRpb25EaWFsb2cudmlzaWJsZSA9IGZhbHNlOwogICAgfSwKCiAgICAvL+abtOaWsOaVsOaNruagh+etvuaYvuekugogICAgdXBkYXRlQ29udGVudEFyZWEoKSB7CiAgICAgIC8v55Sf5oiQ5YaF5a655pWw57uECiAgICAgIHRoaXMuZ3JvdXAgPSBbXTsKCiAgICAgIGxldCBfc2VsZiA9IHRoaXM7IC8vIGNvbnNvbGUubG9nKHRoaXMuZGF0YUluZm8sICd0aGlzLmRhdGFJbmZvJyk7CgoKICAgICAgaWYgKHRoaXMuZGF0YUluZm8uY29udGVudCAmJiB0aGlzLmRhdGFJbmZvLmNvbnRlbnQubWFwKSB7CiAgICAgICAgX3NlbGYuZ3JvdXAgPSB0aGlzLmRhdGFJbmZvLmNvbnRlbnQubWFwKGl0ZW0gPT4gewogICAgICAgICAgaXRlbSA9IHsKICAgICAgICAgICAga2V5OiBNYXRoLnJhbmRvbSgpLAogICAgICAgICAgICBjb250ZW50OiBpdGVtLAogICAgICAgICAgICBsYWJlbHM6IFtdCiAgICAgICAgICB9OwogICAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgICAgfSk7CiAgICAgIH0gLy/lsIbmoIfnrb7mjIljb250ZW505pWw57uE6L+b6KGM5YiG57uECgoKICAgICAgbGV0IGFyciA9IHRoaXMuZGF0YUluZm8ubGFiZWxzOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHsKICAgICAgICBhcnJbaV0uaWQgPSBhcnJbaV0uaWQgfHwgaTsKICAgICAgICBhcnJbaV0ucEluZGV4ID0gaTsKICAgICAgICB2YXIgaW5kZXggPSBhcnJbaV0uZ3JvdXA7CgogICAgICAgIGlmICh0aGlzLmdyb3VwW2luZGV4XSAmJiB0aGlzLmdyb3VwW2luZGV4XS5sYWJlbHMpIHsKICAgICAgICAgIHRoaXMuZ3JvdXBbaW5kZXhdLmxhYmVscy5wdXNoKGFycltpXSk7CiAgICAgICAgfQogICAgICB9IC8v5re75YqgY29udGVudOWGheWuueagh+etvuS/oeaBrwoKCiAgICAgIHRoaXMuZ3JvdXAgPSB0aGlzLmdyb3VwLm1hcChpdGVtID0+IHsKICAgICAgICBpdGVtLmh0bWwgPSB0aGlzLmFkZFNwYW5CeURhdGEoaXRlbS5sYWJlbHMsIGl0ZW0uY29udGVudCk7CiAgICAgICAgcmV0dXJuIGl0ZW07CiAgICAgIH0pOyAvLyB0aGlzLiRmb3JjZVVwZGF0ZSgpOwogICAgICAvL+abtOaWsOWFs+ezu+iKgueCueWSjOi+ueaVsOaNrgoKICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgX3NlbGYudXBkYXRlU3ZnSXRlbSgpOwoKICAgICAgICBfc2VsZi5pbml0U3BhbkV2ZW50KCk7CiAgICAgIH0sIDE1MCk7CiAgICAgIHRoaXMuaGlnaGxpZ2h0U2VhcmNoTW9kZSA9IGZhbHNlOwogICAgfSwKCiAgICAvL+WIneWni+WMluagh+etvuS6i+S7tgogICAgaW5pdFNwYW5FdmVudCgpIHsKICAgICAgdGhpcy4kbmV4dFRpY2soZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBfc2VsZiA9IHRoaXM7IC8v5riF6Zmk5LqL5Lu257uR5a6aCgoKICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLm9wU3BhbkluZm9BcmVhIC5yZW1vdmVTcGFuQnRuJykub2ZmKCdjbGljaycpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcub3BTcGFuSW5mb0FyZWEgLmVkaXRTcGFuQnRuJykub2ZmKCdjbGljaycpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcub3BTcGFuSW5mb0FyZWEgLmFkZENvbW1lbnRzQnRuJykub2ZmKCdjbGljaycpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3Bhbkl0ZW0gLnNlbGVjdFRleHQnKS5vZmYoJ2RyYWdzdGFydCcpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3Bhbkl0ZW0gLnNlbGVjdFRleHQnKS5vZmYoJ2Ryb3AnKTsKICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLnNwYW5JdGVtIC5zZWxlY3RUZXh0Jykub2ZmKCdkcmFnb3ZlcicpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3BhbkluZm9BcmVhJykub2ZmKCdjbGljaycpOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3Bhbkl0ZW0nKS5vZmYoJ2NsaWNrJyk7CgogICAgICAgIGlmICh0aGlzLm1vZGUgPT09ICd2aWV3JykgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KCiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5vcFNwYW5JbmZvQXJlYSAucmVtb3ZlU3BhbkJ0bicpLm9uKCdjbGljaycsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBpbmRleCA9ICQodGhpcykuYXR0cignX2luZGV4Jyk7CiAgICAgICAgICB2YXIgZmxhZyA9ICQodGhpcy5wYXJlbnROb2RlLnBhcmVudE5vZGUucGFyZW50Tm9kZSkuaGFzQ2xhc3MoJ2xpbmVMYWJlbExpc3QnKTsKCiAgICAgICAgICBpZiAoIWZsYWcpIHsKICAgICAgICAgICAgdmFyIG5vZGVEYXRhID0gX3NlbGYuZGF0YUluZm8ubGFiZWxzW2luZGV4XTsKCiAgICAgICAgICAgIHZhciByZXQgPSBfc2VsZi5maW5kUmVsYXRpb24obm9kZURhdGEuaWQpOwoKICAgICAgICAgICAgaWYgKHJldCAhPT0gLTEpIHsKICAgICAgICAgICAgICBfc2VsZi4kbmV4dFRpY2soKCkgPT4gewogICAgICAgICAgICAgICAgX3NlbGYuJG1lc3NhZ2UoJ+mcgOimgeWFiOWIoOmZpOivpeagh+etvuS4iueahOi/nue6v+OAgicpOwogICAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gLy8gdmFyIGQgPSBfc2VsZi5kYXRhSW5mby5sYWJlbHNbaW5kZXhdOwoKCiAgICAgICAgICBfc2VsZi4kY29uZmlybSgn56Gu5a6a6KaB5Yig6Zmk5ZCX77yfJywgJ+aPkOekuicsIHsKICAgICAgICAgICAgY29uZmlybUJ1dHRvblRleHQ6ICfnoa7lrponLAogICAgICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgLy/lsIbmoIfnrb7mlbDmja7lpIfku70KICAgICAgICAgICAgbGV0IGQgPSBfc2VsZi5saW5lTGFiZWxzW2luZGV4XTsKCiAgICAgICAgICAgIF9zZWxmLm9wQmFja3VwRGF0YSgpOwoKICAgICAgICAgICAgX3NlbGYuJGVtaXQoImNvbmZpcm1EZWxldGVMaW5lIiwgZCk7CiAgICAgICAgICB9KTsKCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5vcFNwYW5JbmZvQXJlYSBpbnB1dCcpLm9mZignY2xpY2snKTsKICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLm9wU3BhbkluZm9BcmVhIGlucHV0Jykub24oJ2NsaWNrJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5vcFNwYW5JbmZvQXJlYSAuc2V0QmFzZU9wIGlucHV0Jykub2ZmKCdjaGFuZ2UnKTsKICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLm9wU3BhbkluZm9BcmVhIC5zZXRCYXNlT3AgaW5wdXQnKS5vbignY2hhbmdlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIHZhciBfaW5kZXggPSAkKHRoaXMpLmF0dHIoJ19pbmRleCcpOwoKICAgICAgICAgIHZhciBfdHlwZSA9ICQodGhpcykuYXR0cignX3R5cGUnKTsKCiAgICAgICAgICB2YXIgYmFzZSA9IHRoaXMuY2hlY2tlZCA/IDEgOiAwOwoKICAgICAgICAgIGlmIChfdHlwZSA9PT0gJ3JlbGF0aW9uJykgewogICAgICAgICAgICB2YXIgckl0ZW0gPSBfc2VsZi5kYXRhSW5mby5yZWxhdGlvbltfaW5kZXhdOwoKICAgICAgICAgICAgX3NlbGYuJGVtaXQoInNldFJlbGF0aW9uQmFzZSIsIHJJdGVtKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhciBsYWJlbEl0ZW0gPSBfc2VsZi5kYXRhSW5mby5sYWJlbHNbX2luZGV4XTsKCiAgICAgICAgICAgIF9zZWxmLiRlbWl0KCJzZXRMYWJlbEJhc2UiLCBsYWJlbEl0ZW0pOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcub3BTcGFuSW5mb0FyZWEgLmVkaXRTcGFuQnRuJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIHR5cGUgPSAkKHRoaXMpLnBhcmVudCgpLmF0dHIoJ3R5cGUnKTsKCiAgICAgICAgICBsZXQgX2luZGV4ID0gJCh0aGlzKS5hdHRyKCdfaW5kZXgnKTsKCiAgICAgICAgICBpZiAodHlwZSA9PT0gJ2xpbmUnKSB7CiAgICAgICAgICAgIF9zZWxmLnJlbGF0aW9uRGlhbG9nLnR5cGUgPSAnZWRpdCc7CiAgICAgICAgICAgIF9zZWxmLnJlbGF0aW9uRGlhbG9nLmRhdGEgPSBfc2VsZi5kYXRhSW5mby5yZWxhdGlvbltfaW5kZXhdOwoKICAgICAgICAgICAgX3NlbGYudXBkYXRlUmVsYXRpb25EaWFsb2coKTsKCiAgICAgICAgICAgIF9zZWxmLnJlbGF0aW9uRGlhbG9nLnR5cGUgPSAnZWRpdCc7CiAgICAgICAgICAgIF9zZWxmLnJlbGF0aW9uRGlhbG9nLnZpc2libGUgPSB0cnVlOwogICAgICAgICAgICBfc2VsZi5yZWxhdGlvbkRpYWxvZy5kaWFsb2dPYmoudGl0bGUgPSAn57yW6L6R5qCH562+6L+e57q/JzsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIF9zZWxmLmxhYmVsRGlhbG9nLnZpc2libGUgPSB0cnVlOwogICAgICAgICAgICBfc2VsZi5sYWJlbERpYWxvZy50eXBlID0gJ2VkaXQnOwogICAgICAgICAgICBfc2VsZi5sYWJlbERpYWxvZy5kYXRhID0gX3NlbGYuZGF0YUluZm8ubGFiZWxzW19pbmRleF07CiAgICAgICAgICAgIF9zZWxmLmxhYmVsRGlhbG9nLmRhdGEuX2luZGV4ID0gX2luZGV4OwogICAgICAgICAgICBfc2VsZi5sYWJlbERpYWxvZy5kaWFsb2dPYmoudGl0bGUgPSAn57yW6L6R5qCH562+KOWxnuaAp+OAgeWunuS9kyknOwoKICAgICAgICAgICAgX3NlbGYudXBkYXRlTGFiZWxEaWFsb2coKTsKICAgICAgICAgIH0KCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5vcFNwYW5JbmZvQXJlYSAuYWRkQ29tbWVudHNCdG4nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICB2YXIgaW5kZXggPSAkKHRoaXMpLmF0dHIoJ19pbmRleCcpOwogICAgICAgICAgdmFyIGxhYmVsID0gX3NlbGYuZGF0YUluZm8ubGFiZWxzW2luZGV4XTsKICAgICAgICAgIF9zZWxmLmNvbW1lbnRzT3B0aW9uLmZsYWcgPSAxOwoKICAgICAgICAgIF9zZWxmLmFkZENvbW1lbnRJdGVtKGxhYmVsLmlkLCAnJywgJ25vZGUnKTsKCiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5zcGFuSXRlbSAuc2VsZWN0VGV4dCcpLm9uKCdkcmFnc3RhcnQnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgX3NlbGYuY3VycmVudERyYWcgPSBlLmN1cnJlbnRUYXJnZXQ7CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5zcGFuSXRlbSAuc2VsZWN0VGV4dCcpLm9uKCdkcm9wJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgICAgICAgIHZhciBzb3VyY2UgPSBfc2VsZi5jdXJyZW50RHJhZy5wYXJlbnRFbGVtZW50LmlkOwogICAgICAgICAgdmFyIHNJbmRleCA9ICQoX3NlbGYuY3VycmVudERyYWcucGFyZW50RWxlbWVudCkuYXR0cignX2luZGV4Jyk7CiAgICAgICAgICB2YXIgdEluZGV4ID0gJChlLmN1cnJlbnRUYXJnZXQucGFyZW50RWxlbWVudCkuYXR0cignX2luZGV4Jyk7CiAgICAgICAgICB2YXIgc05vZGUgPSBfc2VsZi5kYXRhSW5mby5sYWJlbHNbc0luZGV4XTsKICAgICAgICAgIHZhciB0Tm9kZSA9IF9zZWxmLmRhdGFJbmZvLmxhYmVsc1t0SW5kZXhdOwogICAgICAgICAgdmFyIHRhcmdldCA9IGUuY3VycmVudFRhcmdldC5wYXJlbnRFbGVtZW50LmlkOwoKICAgICAgICAgIHZhciBySW5kZXggPSBfc2VsZi5maW5kUmVsYXRpb24oc291cmNlLCB0YXJnZXQpOwoKICAgICAgICAgIGlmIChySW5kZXggPT09IC0xICYmIHNOb2RlLmlkICE9PSB0Tm9kZS5pZCkgewogICAgICAgICAgICBfc2VsZi5yZWxhdGlvbkRpYWxvZy5kYXRhID0gewogICAgICAgICAgICAgIHNvdXJjZTogc05vZGUuaWQsCiAgICAgICAgICAgICAgdGFyZ2V0OiB0Tm9kZS5pZCwKICAgICAgICAgICAgICBzb3VyY2VfbmFtZTogc05vZGUudGV4dCwKICAgICAgICAgICAgICB0YXJnZXRfbmFtZTogdE5vZGUudGV4dCwKICAgICAgICAgICAgICAvLyDku7vliqHnrqHnkIbph4zovrnnmoTlj4LmlbAKICAgICAgICAgICAgICBzb3VyY2VfaW5kZXg6IE1hdGgubWF4KHNOb2RlLmluZGV4ICsgMSwgMCksCiAgICAgICAgICAgICAgdGFyZ2V0X2luZGV4OiBNYXRoLm1heCh0Tm9kZS5pbmRleCArIDEsIDApLAogICAgICAgICAgICAgIHNvdXJjZV9vZmZzZXQ6IHNOb2RlLm9mZnNldCwKICAgICAgICAgICAgICB0YXJnZXRfb2Zmc2V0OiB0Tm9kZS5vZmZzZXQsCiAgICAgICAgICAgICAgc291cmNlX3R5cGU6IHNOb2RlLmVudGl0eV9uYW1lLAogICAgICAgICAgICAgIHRhcmdldF90eXBlOiB0Tm9kZS50eXBlX25hbWUgPyB0Tm9kZS50eXBlX25hbWUgOiB0Tm9kZS5lbnRpdHlfbmFtZQogICAgICAgICAgICB9OwoKICAgICAgICAgICAgdmFyIHJldCA9IF9zZWxmLnVwZGF0ZVJlbGF0aW9uRGlhbG9nKCk7CgogICAgICAgICAgICBpZiAocmV0KSB7CiAgICAgICAgICAgICAgX3NlbGYucmVsYXRpb25EaWFsb2cudmlzaWJsZSA9IHRydWU7CiAgICAgICAgICAgICAgX3NlbGYucmVsYXRpb25EaWFsb2cudHlwZSA9ICdhZGQnOwogICAgICAgICAgICAgIF9zZWxmLnJlbGF0aW9uRGlhbG9nLmRpYWxvZ09iai50aXRsZSA9ICforr7nva7moIfnrb7ov57nur8nOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5zcGFuSXRlbSAuc2VsZWN0VGV4dCcpLm9uKCdkcmFnb3ZlciAnLCBmdW5jdGlvbiAoZSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0pOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3BhbkluZm9BcmVhJykub24oJ2NsaWNrJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgdmFyIGFjdGl2ZSA9ICQodGhpcykuYXR0cignYWN0aXZlJyk7CiAgICAgICAgICAkKF9zZWxmLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5zcGFuSW5mb0FyZWFbYWN0aXZlPXRydWVdJykuYXR0cignYWN0aXZlJywgZmFsc2UpOwoKICAgICAgICAgIGlmIChhY3RpdmUgPT09ICd0cnVlJyB8fCBhY3RpdmUgPT09IHRydWUpIHsKICAgICAgICAgICAgJCh0aGlzKS5hdHRyKCdhY3RpdmUnLCBmYWxzZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAkKHRoaXMpLmF0dHIoJ2FjdGl2ZScsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKCcuc3Bhbkl0ZW0nKS5vbignY2xpY2snLCBmdW5jdGlvbiAoKSB7fSk7CiAgICAgIH0pOwogICAgfSwKCiAgICAvL+a3u+WKoOagh+etvui/nue6vwogICAgYWRkUmVsYXRpb25EYXRhKHJEYXRhKSB7CiAgICAgIHJEYXRhID0geyAuLi5yRGF0YQogICAgICB9OwogICAgICByRGF0YS5pZCA9IHJEYXRhLl9pZDsKICAgICAgdGhpcy5yZW1vdmVJdGVtKHRoaXMuZGF0YUluZm8ucmVsYXRpb24sIHJEYXRhLmlkKTsKICAgICAgdGhpcy5kYXRhSW5mby5yZWxhdGlvbi5wdXNoKHJEYXRhKTsKICAgIH0sCgogICAgLy/osIPmoKHmoIfnrb7ov57nur/nmoTotbflp4vlnZDmoIcKICAgIGFkdXN0Tm9kZVBvc2l0aW9uKGVsZW0pIHsKICAgICAgdmFyIHBvcyA9IHsKICAgICAgICB4OiA1MCwKICAgICAgICB5OiA1MAogICAgICB9OwogICAgICB2YXIgdFJlY3QgPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgICB2YXIgcFJlY3QgPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLmNhbnZhc0l0ZW0nKVswXS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKICAgICAgcG9zLnggPSB0UmVjdC54IC0gcFJlY3QueDsKICAgICAgcG9zLnkgPSB0UmVjdC55IC0gcFJlY3QueTsKICAgICAgcmV0dXJuIHBvczsKICAgIH0sCgogICAgLy/nlJ/miJDov57nur/lj4LmlbAKICAgIHByb2R1Y2VMaW5lc1BhcmFtcygpIHsKICAgICAgdmFyIHJldCA9IFtdOwogICAgICB2YXIgYXJyID0gdGhpcy5kYXRhSW5mby5yZWxhdGlvbiB8fCBbXTsKICAgICAgdGhpcy5saW5lTGFiZWxzID0gW107CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBkID0gYXJyW2ldOwogICAgICAgIHZhciBpdGVtID0gewogICAgICAgICAgdHlwZTogJ2xpbmUnLAogICAgICAgICAgYXJyb3c6IHRydWUsCiAgICAgICAgICBkYXRhOiBkLAogICAgICAgICAgc2hhcGU6IFtdCiAgICAgICAgfTsgLy8g6L+e57q/5Zu+5b2i55qE5Y+C5pWwOwoKICAgICAgICB2YXIgc2hhcGUgPSBpdGVtLnNoYXBlOwogICAgICAgIHZhciBlbGVtID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoYC5zcGFuSXRlbVtpZD0nJHtkLnNvdXJjZX0nXWApWzBdOwoKICAgICAgICBpZiAoIWVsZW0pIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBvcyA9IHRoaXMuYWR1c3ROb2RlUG9zaXRpb24oZWxlbSk7CiAgICAgICAgc2hhcGUucHVzaChwb3MpOwogICAgICAgIGVsZW0gPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZChgLnNwYW5JdGVtW2lkPScke2QudGFyZ2V0fSddYClbMF07CgogICAgICAgIGlmICghZWxlbSkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICBwb3MgPSB0aGlzLmFkdXN0Tm9kZVBvc2l0aW9uKGVsZW0pOwogICAgICAgIHNoYXBlLnB1c2gocG9zKTsgLy/otJ3loZ7lsJTnur/nmoTmjqfliLbngrnlnZDmoIcKCiAgICAgICAgdmFyIGNQb3MgPSB7CiAgICAgICAgICB4OiAoc2hhcGVbMF0ueCArIHNoYXBlWzFdLngpIC8gMyArIDEwLAogICAgICAgICAgeTogc2hhcGVbMV0ueSArIDQwCiAgICAgICAgfTsKCiAgICAgICAgaWYgKE1hdGguYWJzKHNoYXBlWzFdLnggLSBzaGFwZVswXS54KSA8IE1hdGguYWJzKHNoYXBlWzFdLnkgLSBzaGFwZVswXS55KSkgewogICAgICAgICAgY1BvcyA9IHsKICAgICAgICAgICAgeDogc2hhcGVbMV0ueCArIDQwLAogICAgICAgICAgICB5OiAoc2hhcGVbMF0ueSArIHNoYXBlWzFdLnkpIC8gMyArIDEwCiAgICAgICAgICB9OwoKICAgICAgICAgIGlmIChzaGFwZVsxXS55ID4gc2hhcGVbMF0ueSkgewogICAgICAgICAgICBjUG9zLnggPSBzaGFwZVsxXS54IC0gNDA7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGlmIChzaGFwZVsxXS54ID4gc2hhcGVbMF0ueCkgewogICAgICAgICAgICBjUG9zLnkgPSBzaGFwZVsxXS55IC0gNDA7CiAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICBzaGFwZS5wdXNoKGNQb3MpOwogICAgICAgIHJldC5wdXNoKGl0ZW0pOwogICAgICB9CgogICAgICByZXR1cm4gcmV0OwogICAgfSwKCiAgICAvL+WIneWni+WMllNWR+WvueixoQogICAgaW5pdFN2Z0l0ZW0oKSB7CiAgICAgIHRoaXMuc3ZnSXRlbSA9IHRoaXMuJHJlZnMuY2FudmFzSXRlbTsKICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5wYXRoR3JvdXAnKS5pbm5lckhUTUwgPSAnJzsKICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy50ZXh0R3JvdXAnKS5pbm5lckhUTUwgPSAnJzsKICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5jb21tZW50c0dyb3VwJykuaW5uZXJIVE1MID0gJyc7CiAgICB9LAoKICAgIC8v5pu05paw5YWz57O757q/KHN2Z+WFg+e0oCkKICAgIHVwZGF0ZVN2Z0l0ZW0oKSB7CiAgICAgIHRoaXMuaW5pdFN2Z0l0ZW0oKTsgLy/mm7TmlrDmoIfnrb7ov57nur8KCiAgICAgIHRoaXMudXBkYXRlbGFiZWxMaW5lKCk7IC8v5pu05paw5om55rOo6L+e57q/CgogICAgICB0aGlzLnVwZGF0ZUNvbW1lbnRMaXN0KCk7CiAgICB9LAoKICAgIC8v6byg5qCH5oKs5rWu5Zyo6L+e57q/55qE5qCH562+5LiK5pe277yM6auY5Lqu5pi+56S66L+e57q/CiAgICBtb3VzZW92ZXJMaW5lSXRlbShlKSB7CiAgICAgIHZhciBpbmRleCA9ICQoZS5jdXJyZW50VGFyZ2V0KS5hdHRyKCdfaW5kZXgnKTsKICAgICAgdmFyIHJEYXRhID0gdGhpcy5saW5lTGFiZWxzW2luZGV4XTsKICAgICAgdmFyIHNlbGVjdG9yID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJyNwYXRoJyArIHJEYXRhLmlkKTsKICAgICAgc2VsZWN0b3IuY3NzKCdzdHJva2UnLCAnIzUyYzQxYScpOwogICAgICBzZWxlY3Rvci5hdHRyKCdtYXJrZXItZW5kJywgJ3VybCgjbWFya2VyQXJyb3cyKScpOwogICAgfSwKCiAgICAvL+m8oOagh+emu+W8gOi/nue6v+eahOagh+etvuS4iuaXtu+8jOmrmOS6ruaYvuekuui/nue6vwogICAgbW91c2VsZWF2ZUxpbmVJdGVtKGUpIHsKICAgICAgdmFyIGluZGV4ID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ19pbmRleCcpOwogICAgICB2YXIgckRhdGEgPSB0aGlzLmxpbmVMYWJlbHNbaW5kZXhdOwogICAgICB2YXIgc2VsZWN0b3IgPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnI3BhdGgnICsgckRhdGEuaWQpOwogICAgICBzZWxlY3Rvci5jc3MoJ3N0cm9rZScsICcjOTFENUZGJyk7CiAgICAgIHNlbGVjdG9yLmF0dHIoJ21hcmtlci1lbmQnLCAndXJsKCNtYXJrZXJBcnJvdyknKTsKICAgIH0sCgogICAgLy/mm7TmlrDmoIfnrb7ov57nur8KICAgIHVwZGF0ZWxhYmVsTGluZSgpIHsKICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5wYXRoR3JvdXAnKS5pbm5lckhUTUwgPSAnJzsKICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy50ZXh0R3JvdXAnKS5pbm5lckhUTUwgPSAnJzsKICAgICAgbGV0IGFyciA9IHRoaXMucHJvZHVjZUxpbmVzUGFyYW1zKCk7CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIGxldCBzaGFwZSA9IGFycltpXS5zaGFwZTsKICAgICAgICBsZXQgcGF0aERhdGEgPSBgTSR7c2hhcGVbMF0ueH0sJHtzaGFwZVswXS55fVEke3NoYXBlWzJdLnh9LCR7c2hhcGVbMl0ueX0sJHtzaGFwZVsxXS54fSwke3NoYXBlWzFdLnl9YDsKICAgICAgICBsZXQgcGF0aCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUygnaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnLCAncGF0aCcpOwogICAgICAgIGxldCBwSWQgPSBhcnJbaV0uZGF0YS5pZDsKICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnZCcsIHBhdGhEYXRhKTsKICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnc3Ryb2tlLXdpZHRoOjE7IHN0cm9rZTojOTFENUZGOyBmaWxsOiBub25lJyk7CiAgICAgICAgcGF0aC5zZXRBdHRyaWJ1dGUoJ21hcmtlci1lbmQnLCAndXJsKCNtYXJrZXJBcnJvdyknKTsgLy/lj5bmtojmoIfnrb7pq5jkuq7miJblhbPns7vpq5jkuq7mlYjmnpwKCiAgICAgICAgJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5zcGFuSXRlbSAuc2VsZWN0VGV4dCcpLmF0dHIoJ2hpZ2hsaWdodCcsIGZhbHNlKTsKICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLnNwYW5JdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodEl0ZW0nKTsKCiAgICAgICAgaWYgKHRoaXMuY3VycmVudExhYmVsTGluZSAmJiB0aGlzLmN1cnJlbnRMYWJlbExpbmUuc291cmNlID09PSBhcnJbaV0uZGF0YS5zb3VyY2UgJiYgdGhpcy5jdXJyZW50TGFiZWxMaW5lLnRhcmdldCA9PT0gYXJyW2ldLmRhdGEudGFyZ2V0KSB7CiAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnc3Ryb2tlLXdpZHRoOjI7IHN0cm9rZTojOTFENUZGOyBmaWxsOiBub25lJyk7CiAgICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnbWFya2VyLWVuZCcsICd1cmwoI21hcmtlckFycm93KScpOwogICAgICAgICAgbGV0IHNpZCA9IHRoaXMuY3VycmVudExhYmVsTGluZS5zb3VyY2U7CiAgICAgICAgICBsZXQgdGlkID0gdGhpcy5jdXJyZW50TGFiZWxMaW5lLnRhcmdldDsKICAgICAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuc3Bhbkl0ZW0jJHtzaWR9IC5zZWxlY3RUZXh0YCkuYXR0cignaGlnaGxpZ2h0JywgdHJ1ZSk7CiAgICAgICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZChgLnNwYW5JdGVtIyR7dGlkfSAuc2VsZWN0VGV4dGApLmF0dHIoJ2hpZ2hsaWdodCcsIHRydWUpOwogICAgICAgIH0KCiAgICAgICAgdGhpcy5zdmdJdGVtLnF1ZXJ5U2VsZWN0b3IoJy5wYXRoR3JvdXAnKS5hcHBlbmRDaGlsZChwYXRoKTsKICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnaWQnLCAncGF0aCcgKyBwSWQpOyAvL+WIm+W7unRleHTlr7nosaHvvIzkuI3lrp7pmYXmmL7npLrkv6Hmga/vvIzku4XlgZpodG1s6L+e57q/5qCH562+5a6a5L2NCgogICAgICAgIGxldCB0ZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd0ZXh0Jyk7CgogICAgICAgIGlmIChNYXRoLmFicyhzaGFwZVsxXS54IC0gc2hhcGVbMF0ueCkgPiBNYXRoLmFicyhzaGFwZVsxXS55IC0gc2hhcGVbMF0ueSkpIHsKICAgICAgICAgIHRleHQuc2V0QXR0cmlidXRlKCd4JywgTWF0aC5hYnMoKHNoYXBlWzFdLnggLSBzaGFwZVswXS54KSAvIDIpKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGV4dC5zZXRBdHRyaWJ1dGUoJ3gnLCBNYXRoLmFicygoc2hhcGVbMV0ueSAtIHNoYXBlWzBdLnkpIC8gMikpOwogICAgICAgIH0KCiAgICAgICAgdGV4dC5zZXRBdHRyaWJ1dGUoJ2luZGV4JywgaSk7CiAgICAgICAgbGV0IHRleHRQYXRoID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKCdodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZycsICd0ZXh0UGF0aCcpOwogICAgICAgIHRleHRQYXRoLnNldEF0dHJpYnV0ZSgnaHJlZicsICcjcGF0aCcgKyBwSWQpOwogICAgICAgIHRleHRQYXRoLmlubmVySFRNTCA9ICcuJzsKICAgICAgICB0ZXh0LmFwcGVuZENoaWxkKHRleHRQYXRoKTsKICAgICAgICB0aGlzLnN2Z0l0ZW0ucXVlcnlTZWxlY3RvcignLnRleHRHcm91cCcpLmFwcGVuZENoaWxkKHRleHQpOwogICAgICAgIGFycltpXS50ZXh0SXRlbSA9IHRleHQ7CiAgICAgIH0gLy/mm7TmlrDmoIfnrb7ov57nur/nmoTmlofmnKzlnZDmoIcKCgogICAgICB2YXIgX3NlbGYgPSB0aGlzOwoKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgX3NlbGYudXBkYXRlTGluZUxhYmVscyhhcnIpOwogICAgICB9LCA1MCk7CiAgICB9LAoKICAgIC8v5pu05paw5om55rOo57q/CiAgICB1cGRhdGVDb21tZW50TGluZSgpIHsKICAgICAgdmFyIHRSZWN0ID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoJy5jb250ZW50Q29udGFpbmVyJylbMF0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuY29udGVudEl0ZW0gLnNwYW5JdGVtPi5zZWxlY3RUZXh0YCkuYXR0cignY29tbWVudEhpZ2hsaWdodCcsIGZhbHNlKTsKCiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5jb21tZW50c09wdGlvbi5kYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGNJdGVtID0gdGhpcy5jb21tZW50c09wdGlvbi5kYXRhW2ldOwoKICAgICAgICBpZiAoY0l0ZW0uY3VycmVudCkgewogICAgICAgICAgdGhpcy5jb21tZW50c09wdGlvbi5jdXJyZW50ID0gaTsKICAgICAgICB9CgogICAgICAgIGlmIChpICE9PSB0aGlzLmNvbW1lbnRzT3B0aW9uLmN1cnJlbnQpIHsKICAgICAgICAgIGNvbnRpbnVlOwogICAgICAgIH0KCiAgICAgICAgdmFyIHBhdGggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMoJ2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJywgJ3BhdGgnKTsKICAgICAgICBwYXRoLnNldEF0dHJpYnV0ZSgnc3R5bGUnLCAnc3Ryb2tlLXdpZHRoOjAuNTsgc3Ryb2tlOiAjZmY0ZDRmOyBmaWxsOiBub25lJyk7CiAgICAgICAgbGV0IGl0ZW0gPSB0aGlzLmNvbW1lbnRzT3B0aW9uLmRhdGFbaV07CiAgICAgICAgbGV0IGxhYmVsSXRlbSA9ICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuY29udGVudEl0ZW0gLnNwYW5JdGVtW2lkPScke2l0ZW0uaWR9J10+LnNlbGVjdFRleHRgKVswXTsKCiAgICAgICAgaWYgKGxhYmVsSXRlbSkgewogICAgICAgICAgbGFiZWxJdGVtLnNldEF0dHJpYnV0ZSgnY29tbWVudEhpZ2hsaWdodCcsIHRydWUpOwogICAgICAgICAgbGV0IHJlY3QgPSBsYWJlbEl0ZW0uZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7CiAgICAgICAgICB2YXIgY29tbWVudEl0ZW0gPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLmNvbW1lbnRzSXRlbScpLmVxKGkpWzBdOwoKICAgICAgICAgIGlmIChjb21tZW50SXRlbSkgewogICAgICAgICAgICBsZXQgX3JlY3QgPSBjb21tZW50SXRlbS5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTsKCiAgICAgICAgICAgIHZhciBwb3MgPSBbcmVjdC5yaWdodCAtIHRSZWN0LngsIHJlY3QuYm90dG9tIC0gdFJlY3QueV07CiAgICAgICAgICAgIHZhciBfcG9zID0gW19yZWN0LnggLSB0UmVjdC54LCBfcmVjdC55IC0gdFJlY3QueV07CiAgICAgICAgICAgIHZhciBwYXRoRGF0YSA9IGBNJHtwb3NbMF19LCR7cG9zWzFdfSBMJHtwb3NbMF0gKyAzfSwke3Bvc1sxXSArIDN9IEgke3RSZWN0LndpZHRoIC0gNDB9IEwke19wb3NbMF0gLSAxMH0sICR7X3Bvc1sxXSArIDI1fWA7CiAgICAgICAgICAgIHBhdGguc2V0QXR0cmlidXRlKCdkJywgcGF0aERhdGEpOwogICAgICAgICAgICB0aGlzLnN2Z0l0ZW0ucXVlcnlTZWxlY3RvcignLmNvbW1lbnRzR3JvdXAnKS5hcHBlbmRDaGlsZChwYXRoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCgogICAgLy/mm7TmlrDmibnms6jliJfooagKICAgIHVwZGF0ZUNvbW1lbnRMaXN0KGluZGV4KSB7CiAgICAgIGlmICh0eXBlb2YgaW5kZXggIT09ICd1bmRlZmluZWQnKSB7CiAgICAgICAgdGhpcy5jb21tZW50c09wdGlvbi5jdXJyZW50ID0gaW5kZXg7CiAgICAgIH0KCiAgICAgIGlmICghdGhpcy5zdmdJdGVtKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICB0aGlzLnN2Z0l0ZW0ucXVlcnlTZWxlY3RvcignLmNvbW1lbnRzR3JvdXAnKS5pbm5lckhUTUwgPSAnJzsKCiAgICAgIGlmICh0aGlzLmNvbW1lbnRzT3B0aW9uLmZsYWcgPT09IDApIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KCiAgICAgIHZhciB0QXJyID0gdGhpcy5jb21tZW50c09wdGlvbi5kYXRhOwoKICAgICAgdmFyIF9zZWxmID0gdGhpczsgLy/lr7nmibnms6jlr7nosaHov5vooYzmjpLluo8KCgogICAgICB0QXJyLnNvcnQoKGIsIGEpID0+IHsKICAgICAgICBhLmdyb3VwID0gJCh0aGlzLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoYC5jb250ZW50SXRlbSAjJHthLmlkfWApLnBhcmVudCgpLmluZGV4KCk7CiAgICAgICAgYS5pbmRleCA9ICQoX3NlbGYuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZChgLmNvbnRlbnRJdGVtICMke2EuaWR9YCkuYXR0cignaW5kZXgnKTsKICAgICAgICBiLmdyb3VwID0gJChfc2VsZi4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuY29udGVudEl0ZW0gIyR7Yi5pZH1gKS5wYXJlbnQoKS5pbmRleCgpOwogICAgICAgIGIuaW5kZXggPSAkKF9zZWxmLiRyZWZzLmxhYmVsVG9vbEFyZWEpLmZpbmQoYC5jb250ZW50SXRlbSAjJHtiLmlkfWApLmF0dHIoJ2luZGV4Jyk7CiAgICAgICAgdmFyIHJldCA9IE51bWJlcihiLmdyb3VwKSAtIE51bWJlcihhLmdyb3VwKTsKCiAgICAgICAgaWYgKHJldCA9PT0gMCkgewogICAgICAgICAgcmV0ID0gTnVtYmVyKGIuaW5kZXgpIC0gTnVtYmVyKGEuaW5kZXgpOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfSk7CiAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YSA9IFtdOwoKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0QXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKHRoaXMudE1vZGUgIT09ICdjaGVjaycpIHsKICAgICAgICAgIHRBcnJbaV0uY29udGVudCA9IHRBcnJbaV0uY29udGVudC5yZXBsYWNlKC9cbi9nLCAnPGJyLz4nKTsKICAgICAgICB9CgogICAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YS5wdXNoKHRBcnJbaV0pOwogICAgICB9IC8v5pu05paw5om55rOo57q/CgoKICAgICAgaWYgKHRoaXMuY29tbWVudHNPcHRpb24uZmxhZyA9PT0gMSkgewogICAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICAgIHRoaXMudXBkYXRlQ29tbWVudExpbmUoKTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKCiAgICAvL+afpeaJvuaJueazqOWvueixoeeahOe0ouW8lQogICAgZmluZENvbW1lbnRCeUlkKGlkKSB7CiAgICAgIHZhciByZXQgPSAtMTsKICAgICAgdmFyIGFyciA9IHRoaXMuY29tbWVudHNPcHRpb24uZGF0YTsKCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKGFycltpXS5pZCA9PT0gaWQpIHsKICAgICAgICAgIHJldCA9IGk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KCiAgICAgIHJldHVybiByZXQ7CiAgICB9LAoKICAgIC8v5re75Yqg5om55rOoCiAgICBhZGRDb21tZW50SXRlbShpZCwgY29udGVudCwgdHlwZSkgewogICAgICBpZiAoIWlkKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IC8v5riF6Zmk5om55rOo55qEY3VycmVudOagh+iusOOAggoKCiAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YSA9IHRoaXMuY29tbWVudHNPcHRpb24uZGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgZGVsZXRlIGl0ZW0uY3VycmVudDsKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7CiAgICAgIHZhciB0SW5kZXggPSB0aGlzLmZpbmRDb21tZW50QnlJZChpZCk7CgogICAgICBpZiAodEluZGV4ID09PSAtMSkgewogICAgICAgIC8v5bCG5qCH562+5pWw5o2u5aSH5Lu9CiAgICAgICAgdGhpcy5vcEJhY2t1cERhdGEoKTsgLy/mt7vliqDluKZjdXJyZW505qCH6K6w55qE5om55rOo5a+56LGhCgogICAgICAgIHZhciBpdGVtID0gewogICAgICAgICAgaWQ6IGlkLAogICAgICAgICAgdHlwZTogdHlwZSB8fCAnbm9kZScsCiAgICAgICAgICBjdXJyZW50OiB0cnVlLAogICAgICAgICAgY29udGVudDogY29udGVudCB8fCAnJywKICAgICAgICAgIGF1dGhvcjogJycKICAgICAgICB9OwogICAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YS5wdXNoKGl0ZW0pOwogICAgICAgIHRoaXMuJGVtaXQoJ3JlbWFyay1hZGQnLCB0aGlzLmNvbW1lbnRzT3B0aW9uLmRhdGEsIGl0ZW0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YVt0SW5kZXhdLmN1cnJlbnQgPSB0cnVlOwogICAgICB9CgogICAgICB0aGlzLmNvbW1lbnRzT3B0aW9uLmN1cnJlbnQgPSAtMTsKICAgICAgdGhpcy51cGRhdGVDb21tZW50TGlzdCgpOwogICAgfSwKCiAgICAvL+abtOaWsOagh+etvui/nue6v+eahOaWh+acrOaPkOekugogICAgdXBkYXRlTGluZUxhYmVscyhhcnIpIHsKICAgICAgdGhpcy5saW5lTGFiZWxzID0gW107IC8vIHZhciB0QXJyID0gW107CgogICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGFyci5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBkID0gYXJyW2ldLmRhdGE7IC8vIGQua2V5ID0gJ2xpbmstJyArIG5ldyBEYXRlKCkuZ2V0VGltZSgpOwoKICAgICAgICB2YXIgYm94ID0gYXJyW2ldLnRleHRJdGVtLmdldEJCb3goKTsKICAgICAgICBkLnN0eWxlID0gewogICAgICAgICAgbGVmdDogYm94LnggLSA0MCArICdweCcsCiAgICAgICAgICB0b3A6IGJveC55ICsgJ3B4JwogICAgICAgIH07CgogICAgICAgIGlmICh0aGlzLmNvbW1lbnRzKSB7CiAgICAgICAgICBkLnN0eWxlLnRvcCA9IGJveC55IC0gNSArICdweCc7CiAgICAgICAgfQoKICAgICAgICBpZiAodGhpcy5jdXJyZW50TGFiZWxMaW5lICYmIGQuc291cmNlID09PSB0aGlzLmN1cnJlbnRMYWJlbExpbmUuc291cmNlICYmIGQudGFyZ2V0ID09PSB0aGlzLmN1cnJlbnRMYWJlbExpbmUudGFyZ2V0KSB7CiAgICAgICAgICBkLmhpZ2hsaWdodCA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGQuaGlnaGxpZ2h0ID0gZmFsc2U7CiAgICAgICAgfQoKICAgICAgICB0aGlzLmxpbmVMYWJlbHMucHVzaChkKTsgLy8gdGhpcy4kc2V0KHRoaXMubGluZUxhYmVscywgaSwgZCk7CiAgICAgIH0KCiAgICAgIHRoaXMubGluZUxhYmVscyA9IHRoaXMubGluZUxhYmVscy5jb25jYXQoW10pOwogICAgICB0aGlzLmluaXRTcGFuRXZlbnQoKTsKICAgIH0sCgogICAgbW91c2VvdmVyQ29tbWVudHNJdGVtKGUpIHsKICAgICAgdmFyIGluZGV4ID0gJChlLmN1cnJlbnRUYXJnZXQpLmF0dHIoJ19pbmRleCcpOyAvL+a4hemZpOaJueazqOeahGN1cnJlbnTmoIfms6jjgIIKCiAgICAgIHRoaXMuY29tbWVudHNPcHRpb24uZGF0YSA9IHRoaXMuY29tbWVudHNPcHRpb24uZGF0YS5tYXAoaXRlbSA9PiB7CiAgICAgICAgZGVsZXRlIGl0ZW0uY3VycmVudDsKICAgICAgICByZXR1cm4gaXRlbTsKICAgICAgfSk7IC8v5pu05paw5om55rOo5YiX6KGoCgogICAgICB0aGlzLnVwZGF0ZUNvbW1lbnRMaXN0KE51bWJlcihpbmRleCkpOwogICAgfSwKCiAgICAvL+iOt+WPlumAieS4reaWh+acrOeahOWBj+enu+mHjwogICAgZ2V0U2VsZWN0VGV4dE9mZnNldCh0eHQpIHsKICAgICAgdmFyIGxhc3ROb2RlID0gdHh0LmJhc2VOb2RlLnByZXZpb3VzRWxlbWVudFNpYmxpbmc7CiAgICAgIHZhciBwb3MgPSBNYXRoLm1pbih0eHQuYmFzZU9mZnNldCwgdHh0LmZvY3VzT2Zmc2V0KTsKICAgICAgdmFyIHQyID0gTWF0aC5tYXgodHh0LmJhc2VPZmZzZXQsIHR4dC5mb2N1c09mZnNldCk7CiAgICAgIGxldCBzdHIgPSB0eHQuYmFzZU5vZGUuZGF0YS5zbGljZShwb3MsIHQyKTsgLy/pgInkuK3mlofmnKwKCiAgICAgIGlmIChsYXN0Tm9kZSkgewogICAgICAgIHZhciB0UG9zID0gTnVtYmVyKGxhc3ROb2RlLmdldEF0dHJpYnV0ZSgnb2Zmc2V0JykpOwogICAgICAgIHZhciB0ZXh0ID0gbGFzdE5vZGUuaW5uZXJUZXh0OwogICAgICAgIHZhciB0VGV4dCA9IHRleHQuc3BsaXQoJ1xuJylbMF07CiAgICAgICAgcG9zICs9IHRQb3MgKyB0VGV4dC5sZW5ndGg7CiAgICAgIH0KCiAgICAgIGxldCByZXQgPSB7CiAgICAgICAgdGV4dDogc3RyLAogICAgICAgIHR5cGU6IHR4dC50eXBlLAogICAgICAgIG9mZnNldDogcG9zLAogICAgICAgIGlkOiBuZXcgRGF0ZSgpLmdldFRpbWUoKSArICcnCiAgICAgIH07CiAgICAgIHJldHVybiByZXQ7CiAgICB9LAoKICAgIC8vIOaUueagh+etvuWGheWuueWSjOagt+W8jwogICAgYWRkU3BhbkJ5RGF0YShkYXRhLCB0ZXh0KSB7CiAgICAgIGlmICghZGF0YSB8fCBkYXRhLmxlbmd0aCA9PT0gMCB8fCB0eXBlb2YgdGV4dCAhPT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gdGV4dDsKICAgICAgfQoKICAgICAgZGF0YS5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7CiAgICAgICAgcmV0dXJuIGEub2Zmc2V0IC0gYi5vZmZzZXQ7CiAgICAgIH0pOwogICAgICB2YXIgclN0ciA9IHRleHQuc2xpY2UoMCwgZGF0YVswXS5vZmZzZXQpOwoKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIGl0ZW0gPSBkYXRhW2ldOwoKICAgICAgICBpZiAoIWl0ZW0udGV4dCkgewogICAgICAgICAgY29udGludWU7CiAgICAgICAgfQoKICAgICAgICB2YXIgdFN0ciA9IGA8c3BhbiBzdHlsZT0icG9zaXRpb246IHJlbGF0aXZlOyIgdHlwZT0iJHtpdGVtLnR5cGV9IiBfaW5kZXg9JHtpdGVtLnBJbmRleH0gY2xhc3M9InNwYW5JdGVtIiBpbmRleD0ke2l9IGlkPSIke2l0ZW0uaWR9IiB0aXRsZT0iJHtpdGVtLmxhYmVsfSIgb2Zmc2V0PSR7aXRlbS5vZmZzZXR9PjxzcGFuIGRyYWdnYWJsZT0ndHJ1ZScgdGl0bGU9IiR7aXRlbS50ZXh0fSIgIGNsYXNzPSJzZWxlY3RUZXh0Ij4ke2l0ZW0udGV4dH08L3NwYW4+IAogICAgICAgICAgICAgICAgPGRpdiBjbGFzcz0ic3BhbkluZm9BcmVhIiBzdHlsZT0iIj48c3BhbiBjbGFzcz0ic3BhblRleHQiID4ke2l0ZW0ubGFiZWx9PC9zcGFuPgogICAgICAgICAgICAgICAgPHNwYW4gbW9kZT0nJHt0aGlzLnRNb2RlfScgIGNsYXNzPSJvcFNwYW5JbmZvQXJlYSI+CiAgICAgICAgICAgICAgICAgIDxzdmcgdGl0bGU9Iue8lui+keagh+azqOS/oeaBryIgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGluZGV4PSR7aX0gY2xhc3M9ImVkaXRTcGFuQnRuIiB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHN0eWxlPSJtYXJnaW4tcmlnaHQ6IDVweDsiPjxwYXRoIGZpbGw9ImN1cnJlbnRDb2xvciIgZD0iTTgzMiA1MTJhMzIgMzIgMCAxIDEgNjQgMHYzNTJhMzIgMzIgMCAwIDEtMzIgMzJIMTYwYTMyIDMyIDAgMCAxLTMyLTMyVjE2MGEzMiAzMiAwIDAgMSAzMi0zMmgzNTJhMzIgMzIgMCAwIDEgMCA2NEgxOTJ2NjQwaDY0MFY1MTJ6Ij48L3BhdGg+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJtNDY5Ljk1MiA1NTQuMjQgNTIuOC03LjU1Mkw4NDcuMTA0IDIyMi40YTMyIDMyIDAgMSAwLTQ1LjI0OC00NS4yNDhMNDc3LjQ0IDUwMS40NGwtNy41NTIgNTIuOHptNDIyLjQtNDIyLjRhOTYgOTYgMCAwIDEgMCAxMzUuODA4bC0zMzEuODQgMzMxLjg0YTMyIDMyIDAgMCAxLTE4LjExMiA5LjA4OEw0MzYuOCA2MjMuNjhhMzIgMzIgMCAwIDEtMzYuMjI0LTM2LjIyNGwxNS4xMDQtMTA1LjZhMzIgMzIgMCAwIDEgOS4wMjQtMTguMTEybDMzMS45MDQtMzMxLjg0YTk2IDk2IDAgMCAxIDEzNS43NDQgMHoiPjwvcGF0aD48L3N2Zz4KICAgICAgICAgICAgICAgICAgPHN2ZyB0aXRsZT0i5Yig6Zmk5qCH5rOo5L+h5oGvIiAgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGluZGV4PSR7aX0gY2xhc3M9InJlbW92ZVNwYW5CdG4iICB2aWV3Qm94PSIwIDAgMTAyNCAxMDI0IiAgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiA+PHBhdGggZmlsbD0iY3VycmVudENvbG9yIiBkPSJNMTYwIDI1Nkg5NmEzMiAzMiAwIDAgMSAwLTY0aDI1NlY5NS45MzZhMzIgMzIgMCAwIDEgMzItMzJoMjU2YTMyIDMyIDAgMCAxIDMyIDMyVjE5MmgyNTZhMzIgMzIgMCAxIDEgMCA2NGgtNjR2NjcyYTMyIDMyIDAgMCAxLTMyIDMySDE5MmEzMiAzMiAwIDAgMS0zMi0zMlYyNTZ6bTQ0OC02NHYtNjRINDE2djY0aDE5MnpNMjI0IDg5Nmg1NzZWMjU2SDIyNHY2NDB6bTE5Mi0xMjhhMzIgMzIgMCAwIDEtMzItMzJWNDE2YTMyIDMyIDAgMCAxIDY0IDB2MzIwYTMyIDMyIDAgMCAxLTMyIDMyem0xOTIgMGEzMiAzMiAwIDAgMS0zMi0zMlY0MTZhMzIgMzIgMCAwIDEgNjQgMHYzMjBhMzIgMzIgMCAwIDEtMzIgMzJ6Ij48L3BhdGg+PC9zdmc+IDwvc3Bhbj48L2Rpdj48L3NwYW4+YDsKCiAgICAgICAgaWYgKHRoaXMudE1vZGUgPT09ICdjaGVja1R3bycpIHsKICAgICAgICAgIC8v5a6h5qC457uT5a+55qCH5rOo57uT5p6c77yM5Y+v5Lul5pSv5oyB6K6+572u5Z+65YeGCiAgICAgICAgICB2YXIgY2hlY2tGbGFnID0gJyc7CgogICAgICAgICAgaWYgKGl0ZW0uYmFzZSA9PT0gJzEnIHx8IGl0ZW0uYmFzZSA9PT0gMSkgewogICAgICAgICAgICBjaGVja0ZsYWcgPSAnY2hlY2tlZCc7CiAgICAgICAgICB9CgogICAgICAgICAgdFN0ciA9IGA8c3BhbiBzdHlsZT0icG9zaXRpb246IHJlbGF0aXZlOyIgdHlwZT0iJHtpdGVtLnR5cGV9IiBfaW5kZXg9JHtpdGVtLnBJbmRleH0gY2xhc3M9InNwYW5JdGVtIiBpbmRleD0ke2l9IGlkPSIke2l0ZW0uaWR9IiB0aXRsZT0iJHtpdGVtLmxhYmVsfSIgb2Zmc2V0PSR7aXRlbS5vZmZzZXR9PjxzcGFuIGRyYWdnYWJsZT0ndHJ1ZScgY2xhc3M9InNlbGVjdFRleHQiICB0aXRsZT0iJHtpdGVtLnRleHR9IiA+JHtpdGVtLnRleHR9PC9zcGFuPiAKICAgICAgICAgICAgICAgIDxkaXYgY2xhc3M9InNwYW5JbmZvQXJlYSIgYmFzZUZsYWc9IiR7aXRlbS5iYXNlIHx8IDB9IiBzYW1lRmxhZz0iJHtpdGVtLl9zYW1lfSIgc3R5bGU9IiI+PHNwYW4gY2xhc3M9InNwYW5UZXh0IiA+JHtpdGVtLmxhYmVsfTwvc3Bhbj4KICAgICAgICAgICAgICAgIDxzcGFuIG1vZGU9JyR7dGhpcy50TW9kZX0nIGNsYXNzPSJvcFNwYW5JbmZvQXJlYSI+PEVkaXQgdGl0bGU9Iue8lui+keagh+azqOS/oeaBryIgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGluZGV4PSR7aX0gY2xhc3M9ImVkaXRTcGFuQnRuIj48L0VkaXQ+PERlbGV0ZSB0aXRsZT0i5Yig6Zmk5qCH5rOo5L+h5oGvIiBjbGFzcz0icmVtb3ZlU3BhbkJ0biIgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGluZGV4PSR7aX0gc3R5bGU9Im1hcmdpbjogMCAycHg7Ij48L0RlbGV0ZT4gPHNwYW4gY2xhc3M9J3NldEJhc2VPcCc+PGlucHV0IF90eXBlPSdub2RlJyBfaW5kZXg9JHtpdGVtLnBJbmRleH0gJHtjaGVja0ZsYWd9IHR5cGU9J2NoZWNrYm94Jz7ln7rlh4Y8L3NwYW4+PC9zcGFuPjwvZGl2Pjwvc3Bhbj5gOwogICAgICAgIH0gZWxzZSBpZiAodGhpcy50TW9kZSA9PT0gJ2NoZWNrJykgewogICAgICAgICAgLy/lrqHmoLjmqKHlvI/ml7bmlK/mjIHmibnms6gKICAgICAgICAgIHRTdHIgPSBgPHNwYW4gc3R5bGU9InBvc2l0aW9uOiByZWxhdGl2ZTsiIHR5cGU9IiR7aXRlbS50eXBlfSIgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGNsYXNzPSJzcGFuSXRlbSIgaW5kZXg9JHtpfSBpZD0iJHtpdGVtLmlkfSIgdGl0bGU9IiR7aXRlbS5sYWJlbH0iIG9mZnNldD0ke2l0ZW0ub2Zmc2V0fT48c3BhbiBkcmFnZ2FibGU9J3RydWUnICB0aXRsZT0iJHtpdGVtLnRleHR9IiAgY2xhc3M9InNlbGVjdFRleHQiPiR7aXRlbS50ZXh0fTwvc3Bhbj4gCiAgICAgICAgICAgICAgICA8ZGl2IGNsYXNzPSJzcGFuSW5mb0FyZWEiIHN0eWxlPSIiPjxzcGFuIGNsYXNzPSJzcGFuVGV4dCIgPiR7aXRlbS5sYWJlbH08L3NwYW4+CiAgICAgICAgICAgICAgICA8c3BhbiBtb2RlPScke3RoaXMudE1vZGV9JyBjbGFzcz0ib3BTcGFuSW5mb0FyZWEiPjxFZGl0IHRpdGxlPSLnvJbovpHmoIfms6jkv6Hmga8iIF9pbmRleD0ke2l0ZW0ucEluZGV4fSBpbmRleD0ke2l9IGNsYXNzPSJpY29uZm9udCBpY29uYXRsYXNfZWRpdF9pY29uIGVkaXRTcGFuQnRuIj48L0VkaXQ+IDxFZGl0UGVuIHRpdGxlPSLmt7vliqDmibnms6giIGNsYXNzPSJhZGRDb21tZW50c0J0biBpY29uZm9udCBpY29uYmlhb2ppIiBfaW5kZXg9JHtpdGVtLnBJbmRleH0gaW5kZXg9JHtpfT48L0VkaXRQZW4+PERlbGV0ZSB0aXRsZT0i5Yig6Zmk5qCH5rOo5L+h5oGvIiBjbGFzcz0icmVtb3ZlU3BhbkJ0biIgX2luZGV4PSR7aXRlbS5wSW5kZXh9IGluZGV4PSR7aX0gc3R5bGU9Im1hcmdpbjogMCAycHg7Ij48L0RlbGV0ZT4gPC9zcGFuPjwvZGl2Pjwvc3Bhbj5gOwogICAgICAgIH0KCiAgICAgICAgclN0ciArPSB0U3RyOwoKICAgICAgICBpZiAoaSA8IGRhdGEubGVuZ3RoIC0gMSkgewogICAgICAgICAgclN0ciArPSB0ZXh0LnNsaWNlKGRhdGFbaV0ub2Zmc2V0ICsgZGF0YVtpXS50ZXh0Lmxlbmd0aCwgZGF0YVtpICsgMV0ub2Zmc2V0KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgclN0ciArPSB0ZXh0LnNsaWNlKGRhdGFbaV0ub2Zmc2V0ICsgZGF0YVtpXS50ZXh0Lmxlbmd0aCk7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gclN0cjsKICAgIH0sCgogICAgLy/pq5jkuq7mn6Xor6LmlofmnKwKICAgIGhpZ2hsaWdodFNlYXJjaFRleHQodGV4dCkgewogICAgICB0aGlzLmNsZWFySGlnaGxpZ3RJdGVtcygpOwogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgdGhpcy5oaWdobGlnaHRTZWFyY2hNb2RlID0gdHJ1ZTsKICAgICAgICBsZXQgaXRlbXMgPSAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLmNvbnRlbnRJdGVtJyk7CiAgICAgICAgbGV0IGJvbCA9IGl0ZW1zLnRleHQoKS5pbmNsdWRlcyh0ZXh0KTsKCiAgICAgICAgaWYgKCFib2wpIHsKICAgICAgICAgIHRoaXMuJG1lc3NhZ2UoewogICAgICAgICAgICBtZXNzYWdlOiAn6K+36L6T5YWl5paH56ug5Lit5a2Y5Zyo55qE5YWz6ZSu6K+N77yBJywKICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCiAgICAgICAgICB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICB2YXIgY05vZGVzID0gaXRlbXNbaV0uY2hpbGROb2RlczsKCiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgY05vZGVzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICAgICAgbGV0IG5vZGUgPSBjTm9kZXNbal07CgogICAgICAgICAgICAgIGlmIChub2RlLm5vZGVOYW1lID09PSAnI3RleHQnKSB7CiAgICAgICAgICAgICAgICB2YXIgdE5vZGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdzcGFuJyk7CiAgICAgICAgICAgICAgICB2YXIgcmVnID0gbmV3IFJlZ0V4cCh0ZXh0LCAnZ2knKTsKICAgICAgICAgICAgICAgIHROb2RlLmlubmVySFRNTCA9IG5vZGUudGV4dENvbnRlbnQucmVwbGFjZShyZWcsIGA8aSBjbGFzcz0ic2VhcmNoSGlnaGxpZ2h0VGV4dCI+JHt0ZXh0fTwvaT5gKTsKICAgICAgICAgICAgICAgIG5vZGUuYWZ0ZXIodE5vZGUpOwogICAgICAgICAgICAgICAgbm9kZS5yZW1vdmUoKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKCiAgICByZW1vdmVTZWFyY2hIaWdobGlnaHQoKSB7CiAgICAgIGlmICh0aGlzLmhpZ2hsaWdodFNlYXJjaE1vZGUpIHsKICAgICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRBcmVhKCk7CiAgICAgIH0KICAgIH0sCgogICAgLy/pq5jkuq7mmL7npLrnrZvpgInnmoTov57nur8KICAgIGhpZ2hsaWdodExpbmVCeUlkKHNpZCwgdGlkKSB7CiAgICAgIHRoaXMuY3VycmVudExhYmVsTGluZSA9IHsKICAgICAgICBzb3VyY2U6IHNpZCwKICAgICAgICB0YXJnZXQ6IHRpZAogICAgICB9OwogICAgICB0aGlzLnVwZGF0ZUNvbnRlbnRBcmVhKCk7CiAgICB9LAoKICAgIC8v5riF56m66auY5Lqu5a+56LGhCiAgICBjbGVhckhpZ2hsaWd0SXRlbXMoKSB7CiAgICAgIHRoaXMuY3VycmVudExhYmVsTGluZSA9IHt9OwogICAgICAkKHRoaXMuJHJlZnMubGFiZWxUb29sQXJlYSkuZmluZCgnLnNwYW5JdGVtJykucmVtb3ZlQ2xhc3MoJ2hpZ2hsaWdodEl0ZW0nKTsKICAgICAgdGhpcy51cGRhdGVsYWJlbExpbmUoKTsKICAgIH0sCgogICAgLy8g6auY5Lqu5pi+56S6562b6YCJ55qE5qCH562+CiAgICBoaWdobGlnaHRMYWJlbHNCeUlkKGlkKSB7CiAgICAgIGlmIChpZCAmJiBpZC5jb25zdHJ1Y3Rvci5uYW1lID09PSAnU3RyaW5nJykgewogICAgICAgIGlkID0gW2lkXTsKICAgICAgfSAvL+a4heepuuWFtuS7lumrmOS6ruWvueixoQoKCiAgICAgIHRoaXMuY2xlYXJIaWdobGlndEl0ZW1zKCk7CgogICAgICBpZiAoaWQgJiYgaWQuY29uc3RydWN0b3IubmFtZSA9PT0gJ0FycmF5JykgewogICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaWQubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIGxldCBzZWxlY3RvciA9ICQodGhpcy4kcmVmcy5sYWJlbFRvb2xBcmVhKS5maW5kKGAuc3Bhbkl0ZW1baWQ9JyR7aWRbaV19J11gKTsKICAgICAgICAgIHNlbGVjdG9yLmFkZENsYXNzKCdoaWdobGlnaHRJdGVtJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAoKICAgIC8vIOmrmOS6ruaYvuekuuetm+mAieeahOagh+etvgogICAgaGlnaGxpZ2h0TGFiZWxzQnlJdGVtKGl0ZW0pIHsKICAgICAgdmFyIGlkID0gW107CiAgICAgIHZhciBlbGVtcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYFt0aXRsZT0ke2l0ZW0uZW50aXR5X25hbWV9XT5bdGl0bGU9JHtpdGVtLm5vZGVfbmFtZX1dYCk7CgogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGVsZW1zLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgdmFyIHRFbGVtID0gZWxlbXNbaV0ucGFyZW50Tm9kZTsKICAgICAgICBpZC5wdXNoKHRFbGVtLmlkKTsKICAgICAgfQoKICAgICAgdGhpcy5oaWdobGlnaHRMYWJlbHNCeUlkKGlkKTsKICAgIH0KCiAgfSwKICBwcm9wczogewogICAgbWFya0RhdGE6IE9iamVjdCwKICAgIGNvbmZpZzogT2JqZWN0CiAgfQp9Ow=="},{"version":3,"mappings":"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","names":["data","scrollWidth","switchFlag","mode","toolBar","labelOption","undo","clear","algorithm","comments","validMark","flagMark","tMode","nodeData","relationData","status","checking","is_valid","calcing","entityLabelTree","nodeKey","select","defaultEntity","defaultParam","id","label","params","relationLabelTree","defaultRelation","current","labels","labelDialog","state","dialogObj","title","width","type","visible","currentTable","headers","property","extraData","paramData","entityData","relationDialog","sentence","commentsOption","flag","content","author","lineLabels","group","backup","relation","remarks","clacResult","dataInfo","activeName","computed","paddingLeft","len","String","length","mounted","h","$","$refs","labelToolArea","find","height","$nextTick","markData","updateData","opBackupData","methods","initConfig","config","k","freshData","handleFlagChange","handleCommentChange","item","handleEnterUp","e","handleSelectionChange","val","batSelect","handleSelectionChange1","switchDialogTable","dialogData","switchMarkData","tData","docNodes","paragraphs","txtParagraphs","relations","docRelations","map","_self","_id","text","node_name","entity_name","entityName","node_type","typeName","type_name","keyName","paramName","index","postil","cItem","comment_user","time","push","source","source_id","target","target_id","relation_name","relationName","switchLabelData","tag_type_id","tag_type_name","name","properties","tItem","tag_id","tag_name","removeItem","arr","param","searchArray","splice","handleOpBtnClick","funcName","ret","i","updateLabelDialog","entity_id","entity","tArr","_entity","type_id","getParamList","updateRelationDialog","rData","relation_id","sid","tid","sIndex","attr","tIndex","sData","sType","tType","$message","lineType","currentLabel","switchClacLabelMode","$confirm","confirmButtonText","cancelButtonText","then","$emit","switchCommentMode","updateCommentList","saveLabelData","redoLabelOp","backupOp","opBackup","task_id","currentInfo","doc_id","user_id","group_num","groupNum","removeLabelInfo","entityLabelChange","checked","rIndex","findRelation","setCheckedNodes","entityParamList","relationLabelChange","relationCurrentChange","a","b","checkedNodes","selectLabel","handleLabelClick","dealClickRemoveComments","_index","switchToolMode","updateContentArea","removeRelationById","findCommentItem","handleSelectText","elem","entityContentArea","txt","window","getSelection","selection","createRange","sText","toString","getSelectTextOffset","srcElement","getAttribute","className","dealConfirmLabel","olderData","taskId","dealConfirmRelation","getCheckedNodes","lType","key","Math","random","pIndex","html","addSpanByData","setTimeout","updateSvgItem","initSpanEvent","highlightSearchMode","off","on","parentNode","hasClass","d","stopPropagation","_type","base","rItem","labelItem","parent","addCommentItem","currentDrag","currentTarget","preventDefault","parentElement","sNode","tNode","source_name","target_name","source_index","max","target_index","source_offset","offset","target_offset","source_type","target_type","active","addRelationData","adustNodePosition","pos","x","y","tRect","getBoundingClientRect","pRect","produceLinesParams","arrow","shape","cPos","abs","initSvgItem","svgItem","canvasItem","querySelector","innerHTML","updatelabelLine","mouseoverLineItem","selector","css","mouseleaveLineItem","pathData","path","document","createElementNS","pId","setAttribute","removeClass","currentLabelLine","appendChild","textPath","textItem","updateLineLabels","updateCommentLine","rect","commentItem","eq","_rect","right","bottom","_pos","sort","Number","replace","findCommentById","box","getBBox","style","left","top","highlight","concat","mouseoverCommentsItem","lastNode","baseNode","previousElementSibling","min","baseOffset","focusOffset","t2","str","slice","tPos","innerText","tText","split","Date","getTime","rStr","tStr","checkFlag","_same","highlightSearchText","clearHighligtItems","items","bol","includes","message","cNodes","childNodes","j","node","nodeName","createElement","reg","RegExp","textContent","after","remove","removeSearchHighlight","highlightLineById","highlightLabelsById","constructor","addClass","highlightLabelsByItem","elems","querySelectorAll","tElem","props","Object"],"sourceRoot":"","sources":["E:\\golaxy\\zstp\\西浦大学\\authorityForecast\\src\\components\\labelTool.vue"],"sourcesContent":["<template>\r\n<div ref=\"labelToolArea\" :mode=\"mode\" :toolBar=\"toolBar\" class=\"labelToolArea\">\r\n  <div class=\"contentArea\" :flag=\"commentsOption.flag\">\r\n    <div class=\"mainContentArea\">\r\n      <div class=\"contentContainer\" :flag=\"commentsOption.flag\">\r\n        <div ref=\"entityContentArea\" class=\"docContentItem\" :switchFlag=\"switchFlag\" @mousedown=\"removeSearchHighlight\">\r\n          <div class=\"lineLabelList\">\r\n            <div v-for=\"(t, j) in lineLabels\" :key=\"t.id\" :style=\"t.style\" :_index=\"j\" :source=\"t.source\" :target=\"t.target\" :title=\"t.label\" :highlight=\"t.highlight\" :baseFlag=\"t.base\" :sameFlag=\"t._same\" class=\"spanInfoArea\" @mouseover=\"mouseoverLineItem\" @mouseleave=\"mouseleaveLineItem\">\r\n              <span class=\"spanText\">{{ t.label }}</span>\r\n              <span :mode=\"tMode\" class=\"opSpanInfoArea\" type=\"line\">\r\n                <Edit title=\"编辑标注信息\" :_index=\"j\" index=\"0\" class=\"editSpanBtn\"></Edit>\r\n                <Delete title=\"删除标注信息\" class=\"removeSpanBtn\" :_index=\"j\" index=\"0\" style=\"margin-left: 10px\"></Delete>\r\n                <span v-if=\"tMode === 'checkTwo' && t.base === '0'\" class=\"setBaseOp\">\r\n                  <input :_type=\"'relation'\" :_index=\"j\" type=\"checkbox\" />基准</span>\r\n                <span v-if=\"tMode === 'checkTwo' && t.base === '1'\" class=\"setBaseOp\">\r\n                  <input :_type=\"'relation'\" :_index=\"j\" checked type=\"checkbox\" />基准</span>\r\n              </span>\r\n            </div>\r\n          </div>\r\n          <p v-for=\"(d, i) in group\" :key=\"d.key\" class=\"contentItem\" :index=\"i + 1\" :style=\"paddingLeft\" @mouseup=\"handleSelectText\" v-html=\"d.html\"></p>\r\n        </div>\r\n      </div>\r\n\r\n      <div v-if=\"commentsOption.flag\" class=\"commentsListArea\">\r\n        <div v-if=\"commentsOption.data.length === 0\" class=\"emptyDataTips\">\r\n          暂无数据\r\n        </div>\r\n        <div v-for=\"(item, index) in commentsOption.data\" :key=\"index\" :group=\"item.group\" :index=\"item.index\" :_index=\"index\" class=\"commentsItem\" @mouseover=\"mouseoverCommentsItem\" @mouseleave=\"mouseleaveCommentsItem\">\r\n          <span v-if=\"tMode !== 'check'\" class=\"commentsText\" v-html=\"item.content\"></span>\r\n          <Delete v-if=\"tMode === 'check'\" class=\"el-icon-delete removeCommentsBtn\" @click=\"dealClickRemoveComments(item)\"></Delete>\r\n          <el-input v-if=\"tMode === 'check'\" v-model=\"item.content\" type=\"textarea\" :rows=\"2\" placeholder=\"请输入内容\" @keyup=\"handleEnterUp\" @change=\"handleCommentChange(item)\">\r\n          </el-input>\r\n          <div v-if=\"item.comment !== ''\" class=\"commentsInfo\">\r\n            <span class=\"nameItem\" v-text=\"item.author\"></span>\r\n            <span class=\"timeItem\" v-text=\"item.time\"></span>\r\n          </div>\r\n        </div>\r\n      </div>\r\n      <div ref=\"canvasItemArea\" class=\"canvasItemArea\">\r\n        <svg ref=\"canvasItem\" class=\"canvasItem\" width=\"100%\" height=\"100%\" xmlns=\"http://www.w3.org/2000/svg\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" version=\"1.1\">\r\n          <defs>\r\n            <marker id=\"markerArrow\" viewBox=\"0 0 20 20\" refX=\"25\" refY=\"10\" markerUnits=\"strokeWidth\" markerWidth=\"5\" markerHeight=\"10\" orient=\"auto\">\r\n              <path d=\"M 0 0 L 20 10 L 0 20 z\" fill=\"#91D5FF\" stroke=\"#91D5FF\" />\r\n            </marker>\r\n            <marker id=\"markerArrow1\" viewBox=\"0 0 20 20\" refX=\"25\" refY=\"10\" markerUnits=\"strokeWidth\" markerWidth=\"5\" markerHeight=\"10\" orient=\"auto\">\r\n              <path d=\"M 0 0 L 20 10 L 0 20 z\" fill=\"#ff4d4f\" stroke=\"#ff4d4f\" />\r\n            </marker>\r\n            <marker id=\"markerArrow2\" viewBox=\"0 0 20 20\" refX=\"25\" refY=\"10\" markerUnits=\"strokeWidth\" markerWidth=\"5\" markerHeight=\"10\" orient=\"auto\">\r\n              <path d=\"M 0 0 L 20 10 L 0 20 z\" fill=\"#52c41a\" stroke=\"#52c41a\" />\r\n            </marker>\r\n          </defs>\r\n          <g class=\"pathGroup\"></g>\r\n          <g class=\"textGroup\"></g>\r\n          <g :flag=\"commentsOption.flag\" class=\"commentsGroup\"></g>\r\n        </svg>\r\n      </div>\r\n    </div>\r\n    <el-dialog :width=\"labelDialog.width || '600px'\" v-model=\"labelDialog.visible\" :title=\"labelDialog.dialogObj.title\">\r\n      <div class=\"dialogContentArea\" :style=\"labelDialog.state === 1 ? 'height: 600px;' : 'height: 300px;'\">\r\n        <div class=\"editLabelArea\">\r\n          <h3 class=\"contentTopArea ellipsis\" :title=\"labelDialog.data.text\">\r\n            {{ labelDialog.data.text }}\r\n          </h3>\r\n          <div class=\"contentLeftArea\">\r\n            <slot v-if=\"labelDialog.visible\">\r\n              <el-tree ref=\"entityLabelTree\" :data=\"entityLabelTree.data\" :node-key=\"entityLabelTree.nodeKey || 'id'\" :highlight-current=\"true\" show-checkbox :check-strictly=\"false\" :default-checked-keys=\"entityLabelTree.defaultEntity\" style=\"height: 190px; overflow: auto\" @node-click=\"handleLabelClick\" @check-change=\"entityLabelChange\"></el-tree>\r\n            </slot>\r\n          </div>\r\n          <div class=\"contentRightArea\">\r\n            <slot v-if=\"\r\n                  entityLabelTree.select &&\r\n                    entityLabelTree.select.length !== 0 &&\r\n                    labelDialog.visible\r\n                \">\r\n              <el-tree ref=\"entityParamList\" :data=\"entityLabelTree.select || []\" :node-key=\"entityLabelTree.nodeKey || 'id'\" show-checkbox :highlight-current=\"true\" :check-strictly=\"false\" :default-checked-keys=\"entityLabelTree.defaultParam\" style=\"height: 190px; overflow: auto\" @check-change=\"entityLabelChange\"></el-tree>\r\n            </slot>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"labelDialog.type === 'edit' && !toolBar\" :state=\"labelDialog.state\" class=\"extraDataArea\">\r\n          <h5 class=\"switchTableBtn\" @click=\"switchDialogTable(labelDialog)\">\r\n            更多待修改项 <i class=\"el-icon-arrow-down\"></i>\r\n          </h5>\r\n          <slot v-if=\"labelDialog.state === 1\">\r\n            <el-table ref=\"multipleTable\" :data=\"labelDialog.currentTable.data\" :border=\"true\" :height=\"280\" style=\"width: 100%\" @selection-change=\"handleSelectionChange\">\r\n              <el-table-column align=\"center\" type=\"selection\" width=\"55\">\r\n              </el-table-column>\r\n              <el-table-column align=\"center\" type=\"index\" width=\"50\" label=\"序号\">\r\n              </el-table-column>\r\n              <slot v-for=\"d in labelDialog.currentTable.headers\">\r\n                <el-table-column :width=\"d.width\" :label=\"d.label\" :property=\"d.property || d.prop\">\r\n                  <template #scope=\"scope\">\r\n                    <div class=\"ellipsis\" :title=\"scope.row[scope.column.property]\">\r\n                      {{ scope.row[scope.column.property] }}\r\n                    </div>\r\n                  </template>\r\n                </el-table-column>\r\n              </slot>\r\n            </el-table>\r\n          </slot>\r\n        </div>\r\n      </div>\r\n      <span>\r\n        <el-button class=\"btns\" size=\"small\" @click=\"labelDialog.visible = false\">取消</el-button>\r\n        <el-button class=\"btns\" type=\"primary\" size=\"small\" @click=\"labelDialog.visible = dealConfirmLabel();\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n    <el-dialog v-model=\"relationDialog.visible\" :width=\"relationDialog.width || '600px'\"  :title=\"relationDialog.dialogObj.title\">\r\n      <div class=\"dialogContentArea\" :style=\"\r\n            relationDialog.state === 1 ? 'height: 700px;' : 'height: 400px;'\r\n          \">\r\n        <div class=\"editRelationArea\">\r\n          <h3 :type=\"relationDialog.lineType || 'relation'\" class=\"contentTopArea\">\r\n            <label class=\"masterName\" :title=\"relationDialog.source\"><span class=\"ellipsis\">{{\r\n                  relationDialog.source\r\n                }}</span></label>\r\n            <label class=\"relationLabelArea\">\r\n              <span class=\"linkArrowIcon\">\r\n                <svg xmlns=\"http://www.w3.org/2000/svg\" aria-hidden=\"true\" role=\"img\" width=\"100%\" height=\"30px\" preserveAspectRatio=\"xMinYMid meet\" viewBox=\"0 0 24 24\">\r\n                  <path fill=\"none\" stroke=\"currentColor\" stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"1\" d=\"M0 18h156m-5-5l5 5l-5 5\" />\r\n                </svg>\r\n              </span>\r\n              <span class=\"relationLabel ellipsis\" :title=\"relationDialog.currentLabel\" v-text=\"relationDialog.currentLabel\"></span></label>\r\n            <label class=\"slaveName\" :title=\"relationDialog.target\">\r\n              <span class=\"ellipsis\">{{ relationDialog.target }}</span></label>\r\n          </h3>\r\n          <div class=\"relationContentArea\">\r\n            <h5>\r\n              {{\r\n                  relationDialog.lineType === 'relation'\r\n                    ? '选择关系标签'\r\n                    : '选择属性标签'\r\n                }}\r\n            </h5>\r\n            <slot v-if=\"relationDialog.visible\">\r\n              <el-tree ref=\"relationLabelTree\" :data=\"relationLabelTree.data\" :node-key=\"relationLabelTree.nodeKey || 'id'\" :default-checked-keys=\"relationLabelTree.defaultRelation\" style=\"height: 190px; overflow: auto\" :show-checkbox=\"true\" @check-change=\"relationLabelChange\" @check=\"relationCurrentChange\"></el-tree>\r\n            </slot>\r\n          </div>\r\n        </div>\r\n        <div v-if=\"relationDialog.type === 'edit' && !toolBar\" :state=\"relationLabelTree.state\" class=\"extraDataArea\">\r\n          <h5 class=\"switchTableBtn\" @click=\"switchDialogTable(relationDialog)\">\r\n            更多待修改项 <i class=\"el-icon-arrow-down\"></i>\r\n          </h5>\r\n          <slot v-if=\"relationDialog.state === 1\">\r\n            <el-table ref=\"multipleTable\" :data=\"relationDialog.currentTable.data\" :border=\"true\" :height=\"280\" style=\"width: 100%\" @selection-change=\"handleSelectionChange1\">\r\n              <el-table-column align=\"center\" type=\"selection\" width=\"55\">\r\n              </el-table-column>\r\n              <el-table-column align=\"center\" type=\"index\" width=\"50\" label=\"序号\">\r\n              </el-table-column>\r\n              <slot v-for=\"d in relationDialog.currentTable.headers\">\r\n                <el-table-column :width=\"d.width\" :label=\"d.label\" :property=\"d.property || d.prop\">\r\n                  <template #scope=\"scope\">\r\n                    <div class=\"ellipsis\" :title=\"scope.row[scope.column.property]\">\r\n                      {{ scope.row[scope.column.property] }}\r\n                    </div>\r\n                  </template>\r\n                </el-table-column>\r\n              </slot>\r\n            </el-table>\r\n          </slot>\r\n        </div>\r\n      </div>\r\n      <span>\r\n        <el-button class=\"btns\" size=\"small\" @click=\"relationDialog.visible = false\">取消</el-button>\r\n        <el-button class=\"btns\" type=\"primary\" size=\"small\" @click=\"relationDialog.visible = dealConfirmRelation();\">确定</el-button>\r\n      </span>\r\n    </el-dialog>\r\n  </div>\r\n  <div class=\"labelOptionArea\" :flag=\"commentsOption.flag\" :style=\"(!labelOption.comments || !commentsOption.flag) ? {\r\n    width: '100%'\r\n  } : {\r\n    width: '100%'\r\n  }\">\r\n    <div class=\"buttonArea\" style=\"display: inline-block\">\r\n      <span v-if=\"mode === 'edit'\" class=\"opBtnItem\" @click=\"switchToolMode\">\r\n        <Pointer class=\"iconfont iconpizhu1\"></Pointer>标注模式\r\n      </span>\r\n      <span v-else class=\"opBtnItem\" @click=\"switchToolMode\">\r\n        <View class=\"iconfont iconpizhu\"></View>预览模式\r\n      </span>\r\n      <span class=\"opBtnItem\" @click=\"redoLabelOp\" v-if=\"labelOption.undo\">\r\n        <RefreshLeft class=\"iconfont iconchexiao\"></RefreshLeft>撤回\r\n      </span>\r\n      <span class=\"opBtnItem\" @click=\"removeLabelInfo\" v-if=\"labelOption.clear\">\r\n        <DeleteFilled class=\"iconfont iconqingkong1\"></DeleteFilled>清空\r\n      </span>\r\n      <span v-if=\"tMode !== 'check' && labelOption.algorithm\" class=\"opBtnItem\" :style=\"{\r\n            color: status.calcing < 1 && tMode !== 'check' ? '#000' : '#999',\r\n          }\" @click=\"switchClacLabelMode\"><svg t=\"1655952840136\" class=\"icon\" viewBox=\"0 0 1024 1024\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\" p-id=\"2029\" width=\"64\" height=\"64\">\r\n          <path d=\"M849.8 510.4c3.5-4.5 6.8-9.1 10-13.6 57.1-80.4 71.2-154.7 39.8-209.3-31.4-54.6-102.8-79.6-201-70.6-5.7 0.5-11.4 1.2-17.2 1.9-2.2-5.4-4.6-10.7-6.9-15.9C633.4 113.3 576 64 513 64s-120.3 49.5-161.4 139c-2.4 5.1-4.6 10.4-6.9 15.7-5.7-0.7-11.4-1.4-17-1.9-98.1-9.2-169.6 15.8-201 70.4-31.5 54.6-17.4 128.9 39.6 209.3 3.2 4.5 6.6 9.1 10 13.6-3.5 4.5-6.8 9.1-10 13.6C109.2 604.1 95 678.4 126.5 733c27.2 47.3 84.4 72.4 162.9 72.4 12.2 0 24.9-0.6 38-1.8 5.7-0.5 11.4-1.2 17.2-1.9 2.2 5.4 4.6 10.7 6.9 15.9C392.6 907.2 450 956.5 513 956.5s120.3-49.3 161.5-138.9c2.4-5.1 4.6-10.4 6.9-15.7 5.7 0.7 11.4 1.4 17 1.9 13.3 1.2 26.1 1.9 38.4 1.9 78.4 0 135.4-25.1 162.7-72.2 31.5-54.6 17.4-128.9-39.6-209.3-3.3-4.7-6.6-9.2-10.1-13.8zM322.2 746.8c-73.6 6.8-127-8.6-146.4-42.3-19.4-33.7-6-87.6 36.9-147.8l1.5-2.1c25.4 27 54.5 53.2 86.7 78.1 5.4 40.2 13.6 78.4 24.2 113.8-0.9 0.1-1.9 0.2-2.9 0.3z m-28.4-194c-15.5-14-30-28.2-43.2-42.6 13.2-14.4 27.6-28.6 43.2-42.6-0.6 14.1-1 28.3-1 42.7 0 14.2 0.4 28.4 1 42.5z m7.2-165.1c-32.2 24.8-61.3 51.1-86.7 78-0.5-0.7-1.1-1.4-1.5-2.1-42.8-60.4-56.2-114.3-36.8-147.9 16.4-28.4 56.9-43.8 113.3-43.8 10.5 0 21.6 0.5 33.1 1.6 0.9 0.1 1.8 0.2 2.8 0.3-10.6 35.4-18.8 73.7-24.2 113.9z m358.3-46.2c-11.8-7.5-23.9-14.9-36.2-22-12.3-7.1-24.7-13.9-37.1-20.3 19.7-6.4 39.1-11.7 58-15.9 5.8 18.2 10.9 37.6 15.3 58.2zM513.1 121.1c38.6 0 79.4 39.9 110.6 108.5-35.9 8.5-73 20.5-110.4 35.8-37.5-15.4-74.7-27.5-110.6-36 31-68.5 71.8-108.3 110.4-108.3z m-131 162c19 4.2 38.4 9.5 58.2 16-12.4 6.4-24.8 13.2-37.2 20.3-12.4 7.1-24.5 14.5-36.3 22 4.4-20.6 9.5-40.1 15.3-58.3zM366.8 679c11.8 7.5 23.9 14.9 36.2 22 12.3 7.1 24.7 13.9 37.1 20.3-19.7 6.4-39.1 11.7-58 15.9-5.8-18.1-10.9-37.6-15.3-58.2z m146.3 220.5c-38.6 0-79.4-39.9-110.6-108.5 35.9-8.5 73-20.5 110.4-35.8 37.5 15.4 74.7 27.5 110.6 36-31.1 68.4-71.9 108.3-110.4 108.3zM644 737.4c-19-4.2-38.4-9.5-58.2-16 12.4-6.4 24.8-13.2 37.2-20.3 12.4-7.1 24.5-14.5 36.3-22-4.4 20.6-9.5 40.1-15.3 58.3z m27.5-135.5c-24.1 17.5-49.9 34.2-77 49.8-27 15.6-54.4 29.4-81.6 41.5-27.2-12.1-54.5-26-81.5-41.6-27-15.6-52.7-32.4-76.8-49.9-3.1-29-4.8-59.6-4.8-91.5 0-32 1.7-62.6 4.8-91.6 24.1-17.5 49.9-34.2 77-49.8 27-15.6 54.4-29.4 81.6-41.5 27.2 12.1 54.5 26 81.5 41.6 27 15.6 52.7 32.4 76.8 49.9 3.1 29 4.8 59.6 4.8 91.5 0 32-1.7 62.5-4.8 91.6z m32.4-328.2c11.4-1.1 22.4-1.6 32.8-1.6 56.6 0 97.2 15.4 113.6 43.9 19.4 33.7 6 87.6-36.9 147.8l-1.5 2.1c-25.4-27-54.5-53.2-86.7-78.1-5.4-40.2-13.6-78.4-24.2-113.8 1-0.1 1.9-0.2 2.9-0.3z m28.4 194.1c15.5 14 30 28.2 43.2 42.6-13.2 14.4-27.6 28.6-43.2 42.6 0.6-14.1 1-28.3 1-42.7 0-14.3-0.3-28.5-1-42.5z m117.8 237.1c-19.4 33.7-72.8 49-146.4 42.1-0.9-0.1-1.8-0.2-2.8-0.3 10.6-35.4 18.8-73.6 24.2-113.8 32.2-24.8 61.3-51.1 86.7-78 0.5 0.7 1.1 1.4 1.5 2.1 42.9 60.3 56.2 114.2 36.8 147.9z\" p-id=\"2030\"></path>\r\n          <path d=\"M482.4 501.6h-25.6V476c0-6.6-6.8-12-15.3-12-8.4 0-15.3 5.4-15.3 12v25.6h-25.6c-6.6 0-12 6.8-12 15.3 0 8.4 5.4 15.3 12 15.3h25.6v25.6c0 6.6 6.8 12 15.3 12 8.4 0 15.3-5.4 15.3-12v-25.6h25.6c6.6 0 12-6.8 12-15.3s-5.4-15.3-12-15.3zM629 501.6h-81.7c-6.6 0-12 6.8-12 15.3 0 8.4 5.4 15.3 12 15.3H629c6.6 0 12-6.8 12-15.3 0.1-8.5-5.3-15.3-12-15.3z\" p-id=\"2031\"></path>\r\n        </svg>算法标注</span>\r\n      <span class=\"opBtnItem\" @click=\"switchCommentMode\" v-if=\"labelOption.comments\">\r\n        <EditPen class=\"iconfont iconbiaoji\"></EditPen>查看批注\r\n      </span>\r\n    </div>\r\n    <div v-if=\"labelOption.validMark || labelOption.flagMark\" class=\"checkGroup\">\r\n      <UserFilled v-if=\"tMode === 'check' && status.is_valid\" class=\"iconfont iconpizhu_special\"></UserFilled>\r\n      <span v-if=\"tMode === 'check' && status.is_valid\" style=\"font-size: 12px\">标注人员已置为无效</span>\r\n      <el-checkbox v-if=\"tMode !== 'check' && labelOption.validMark\" v-model=\"status.is_valid\" size=\"small\" label=\"无效\" @change=\"handleFlagChange\">无效</el-checkbox>\r\n      <el-checkbox v-if=\"tMode !== 'check' && labelOption.flagMark\" v-model=\"status.checking\" size=\"small\" label=\"标记\" @change=\"handleFlagChange\">标记</el-checkbox>\r\n    </div>\r\n  </div>\r\n  <div class=\"commentListTitle\" :flag=\"commentsOption.flag\" >\r\n    <MessageBox class=\"iconfont iconbiaotiicon col1577FF\"></MessageBox>批注\r\n  </div>\r\n</div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      scrollWidth: 0,\r\n      switchFlag: 3,\r\n      mode: 'edit',\r\n      toolBar: true,\r\n      labelOption: {\r\n        undo: false,\r\n        clear: false,\r\n        algorithm: true,\r\n        comments: true,\r\n        validMark: true,\r\n        flagMark: false\r\n      },\r\n      tMode: '',\r\n      nodeData: [],\r\n      relationData: [],\r\n      status: {\r\n        checking: true,\r\n        is_valid: false,\r\n        calcing: 0,\r\n      },\r\n      entityLabelTree: {\r\n        nodeKey: 'id',\r\n        select: [],\r\n        defaultEntity: [],\r\n        defaultParam: [],\r\n        data: [{\r\n            id: '1',\r\n            label: '人物',\r\n            params: [{\r\n              id: '1-1',\r\n              label: '姓名',\r\n            }, ],\r\n          },\r\n          {\r\n            id: '2',\r\n            label: '地点',\r\n            params: [{\r\n              id: '2-1',\r\n              label: '位置',\r\n            }, ],\r\n          },\r\n          {\r\n            id: '3',\r\n            label: '机构',\r\n            params: [{\r\n              id: '3-1',\r\n              label: '名称',\r\n            }, ],\r\n          },\r\n          {\r\n            id: '4',\r\n            label: '时间',\r\n          },\r\n          {\r\n            id: 5,\r\n            label: '国家',\r\n            params: [{\r\n              id: '1-1',\r\n              label: '名称',\r\n            }, ],\r\n          },\r\n        ],\r\n      },\r\n      relationLabelTree: {\r\n        defaultRelation: [],\r\n        current: null,\r\n        data: [{\r\n          id: '3-1',\r\n          label: '名称',\r\n        }, ],\r\n        labels: [],\r\n      },\r\n      labelDialog: {\r\n        state: 0,\r\n        dialogObj: {\r\n          title: '选择标签(实体/属性)',\r\n          width: '560px',\r\n        },\r\n        type: 'add',\r\n        visible: false,\r\n        data: {},\r\n        currentTable: {\r\n          headers: [{\r\n              label: '实体名称',\r\n              property: 'name',\r\n              width: 100,\r\n            },\r\n            {\r\n              label: '标签类型',\r\n              property: 'type',\r\n              width: 100,\r\n            },\r\n            {\r\n              label: '所属句子',\r\n              property: 'sentence',\r\n            },\r\n          ],\r\n          data: [],\r\n        },\r\n        extraData: {\r\n          paramData: [{}],\r\n          entityData: [{}],\r\n        },\r\n      },\r\n      relationDialog: {\r\n        state: 0,\r\n        dialogObj: {\r\n          title: '设置标签连线',\r\n          width: '560px',\r\n        },\r\n        type: 'add',\r\n        visible: false,\r\n        data: {},\r\n        currentTable: {\r\n          headers: [],\r\n          data: [],\r\n        },\r\n      },\r\n      sentence: 0,\r\n      commentsOption: {\r\n        current: 0,\r\n        // flag: 1,\r\n        flag: 0,\r\n        data: [{\r\n            id: '0212142',\r\n            type: 'node',\r\n            content: '测试批注1',\r\n            author: '张三',\r\n          },\r\n          {\r\n            id: '0212141',\r\n            type: 'node',\r\n            content: '测试批注2',\r\n            author: '张三',\r\n          },\r\n        ],\r\n      },\r\n      lineLabels: [],\r\n      group: [],\r\n      backup: {\r\n        relation: [],\r\n        labels: [],\r\n        remarks: [],\r\n      },\r\n      clacResult: {\r\n        relation: [],\r\n        labels: [],\r\n        remarks: [],\r\n      },\r\n      dataInfo: {\r\n        flag: 0,\r\n        activeName: 'entity',\r\n        content: [],\r\n        relation: [],\r\n        remarks: [],\r\n        labels: [],\r\n      },\r\n    };\r\n  },\r\n  computed: {\r\n    paddingLeft() {\r\n      var len = String(this.sentence).length;\r\n      return {\r\n        paddingLeft: len * 8 + 'px',\r\n      };\r\n    },\r\n  },\r\n  mounted() {\r\n    var h = $(this.$refs.labelToolArea)\r\n      .find('.contentArea')\r\n      .height();\r\n    this.scrollWidth = $(this.$refs.labelToolArea)\r\n      .find(\".contentArea\").width() - $(this.$refs.labelToolArea)\r\n      .find(\".mainContentArea\").width()\r\n\r\n    this.$nextTick(function () {\r\n\r\n      if (this.markData) {\r\n        this.updateData(this.markData);\r\n        this.opBackupData();\r\n      }\r\n    });\r\n  },\r\n  methods: {\r\n    initConfig() {\r\n      if (this.config) {\r\n        this.nodeData = this.config.nodeData || this.nodeData || [];\r\n        this.relationData = this.config.relationData || this.nodeData || [];\r\n        this.mode = this.config.mode || this.mode || 'edit';\r\n        this.tMode = this.config.tMode || this.tMode;\r\n        for (var k in this.status) {\r\n          this.status[k] = this.config[k] || this.status[k] || false;\r\n        }\r\n        if (this.config.labelOption) {\r\n          for (var k in this.labelOption) {\r\n            this.labelOption[k] = this.config.labelOption[k] || this.labelOption[k];\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //每次操作结束后请求后台最新标注数据更新页面中的标注信息\r\n    freshData() {\r\n\r\n    },\r\n    //修改文档标记时触发\r\n    handleFlagChange() {\r\n\r\n    },\r\n    //批注发生变化时触发\r\n    handleCommentChange(item) {\r\n\r\n    },\r\n    handleEnterUp(e) {\r\n\r\n    },\r\n    handleSelectionChange(val) {\r\n      this.labelDialog.batSelect = val;\r\n    },\r\n    handleSelectionChange1(val) {\r\n      this.relationDialog.batSelect = val;\r\n    },\r\n    //编辑实体或属性对话框和编辑关系对话框时，切换批量修改表格显示或隐藏\r\n    switchDialogTable(dialogData) {\r\n      if (dialogData.state === 0) {\r\n        dialogData.state = 1;\r\n      } else {\r\n        dialogData.state = 0;\r\n      }\r\n    },\r\n    //格式化转入的标注任务参数(项目标签数据和业务数据)\r\n    switchMarkData(tData) {\r\n      if (!tData) {\r\n        return false;\r\n      }\r\n      var labels = tData.docNodes || [];\r\n      var paragraphs = tData.txtParagraphs || [];\r\n      this.sentence = paragraphs.length;\r\n      this.commentsOption.data = [];\r\n      var relations = tData.docRelations || [];\r\n      this.dataInfo.content = paragraphs.map(item => {\r\n        return item.content || item;\r\n      });\r\n      var _self = this;\r\n\r\n      this.dataInfo.labels = labels.map(item => {\r\n        //待修改\r\n        item.id = item._id || item.id;\r\n        item.text = item.node_name || item.text || '-';\r\n        item.label = item.entity_name || item.entityName || item.label;\r\n        var type = item.node_type || item.type;\r\n        var typeName = item.type_name || item.typeName || item.keyName || item.paramName;\r\n        if (type === 1 && typeName && item.label) {\r\n          //实体的属性标签\r\n          item.label = typeName + '-' + item.label;\r\n          item.type = 'param';\r\n        }\r\n        item.group = item.index;\r\n        //批注信息\r\n        var comments = item.postil || item.comments;\r\n        if (comments) {\r\n          // var time = tool.transformPHPTime(item.comment_time, 1);\r\n          var cItem = {\r\n            id: item.id,\r\n            content: comments,\r\n            author: item.comment_user || '-',\r\n            time: time || '',\r\n          };\r\n          _self.commentsOption.data.push(cItem);\r\n        }\r\n\r\n        return item;\r\n      });\r\n      this.dataInfo.relation = relations.map(item => {\r\n        //待修改\r\n        item.source = item.source_id || item.source;\r\n        item.target = item.target_id || item.target;\r\n        item.label = item.relation_name || item.relationName || item.label;\r\n        item.id = item._id || item.id || (item.source + '-' + item.target + '-' + item.label);\r\n        return item;\r\n      });\r\n    },\r\n    //格式化实体、属性和关系标签数据\r\n    switchLabelData(nodeData, relationData) {\r\n      nodeData = nodeData || this.nodeData || [];\r\n      relationData = relationData || this.relationData || [];\r\n\r\n      this.entityLabelTree.data = nodeData.map(item => {\r\n        item.id = item.tag_type_id || item.id;\r\n        item.label = item.tag_type_name || item.label || item.name;\r\n        var properties = item.properties || [];\r\n        item.params = properties.map(tItem => {\r\n          return {\r\n            id: tItem.tag_id || tItem.id,\r\n            label: tItem.name || tItem.label,\r\n          };\r\n        });\r\n        return item;\r\n      });\r\n      if (relationData && relationData.length !== 0) {\r\n        this.relationLabelTree.labels = relationData.map(item => {\r\n          item.id = item.tag_id || item.id;\r\n          item.label = item.tag_name || item.label;\r\n          return item;\r\n        });\r\n      }\r\n    },\r\n    //操作数组元素：数组元素中包含指定属性的(匹配属性名和值)，会被删除\r\n    removeItem(arr, param) {\r\n      var index = this.searchArray(arr, param);\r\n      if (index !== -1) {\r\n        arr.splice(index, 1);\r\n      }\r\n    },\r\n    //操作按钮点击事件的统一响应函数，根据按钮的函数名动态地回调\r\n    handleOpBtnClick(funcName) {\r\n      if (typeof this[funcName] === 'function') {\r\n        this[funcName]();\r\n      }\r\n    },\r\n    //通过属性查找数组中的元素索引\r\n    searchArray(arr, param) {\r\n      var ret = -1;\r\n      for (var i = 0; i < arr.length; i++) {\r\n        let flag = true;\r\n        for (let k in param) {\r\n          flag = flag && param[k] === arr[i][k];\r\n        }\r\n        if (flag) {\r\n          ret = i;\r\n          break;\r\n        }\r\n      }\r\n      return ret;\r\n    },\r\n    //更新标签编辑的对话框内容\r\n    updateLabelDialog() {\r\n      var data = this.labelDialog.data;\r\n      this.labelDialog.state = 0;\r\n      var type = data.type || 'entity';\r\n      this.entityLabelTree.defaultEntity = [];\r\n      this.entityLabelTree.select = [];\r\n      this.entityLabelTree.defaultParam = [];\r\n      if (type === 'entity' && this.labelDialog.type !== 'add') {\r\n        this.entityLabelTree.defaultEntity = [data.entity_id];\r\n        this.entityLabelTree.current = {\r\n          entity: {\r\n            id: data.entity_id,\r\n            label: data.entity_name,\r\n          },\r\n        };\r\n      } else if (data && data.entity_id) {\r\n        var tArr = this.entityLabelTree.data;\r\n        this.entityLabelTree.current = {\r\n          _entity: {\r\n            id: data.entity_id,\r\n            label: data.entity_name,\r\n          },\r\n        };\r\n        var index = this.searchArray(tArr, {\r\n          id: data.entity_id\r\n        });\r\n        if (index !== -1 && tArr[index]) {\r\n          this.entityLabelTree.defaultEntity = [];\r\n          this.entityLabelTree.select = tArr[index].params;\r\n          // this.entityLabelTree.defaultParam = [data.type_id];\r\n          // 由于任务管理-标注部分，右侧表格用的是算法的本体，里边没有type_id，所以暂时用type_name代替\r\n          this.entityLabelTree.defaultParam = [data.type_name];\r\n          this.entityLabelTree.current.param = {\r\n            id: data.type_id,\r\n            label: data.type_name,\r\n          };\r\n        }\r\n      }\r\n\r\n      //todo: 可以添加显示相关标签列表，进行批量修改;\r\n    },\r\n    //获取实体标签列表中某个实体标签的属性标签列表\r\n    getParamList(label) {\r\n      var ret = [];\r\n      for (var i = 0; i < this.entityLabelTree.data.length; i++) {\r\n        var entity = this.entityLabelTree.data[i];\r\n        if (entity.label === label) {\r\n          ret = entity.params || [];\r\n          break;\r\n        }\r\n      }\r\n      return ret;\r\n    },\r\n    //更新标签连线编辑的对话框内容\r\n    updateRelationDialog() {\r\n      this.relationDialog.state = 0;\r\n      var rData = this.relationDialog.data;\r\n      //设置默认选中项\r\n      this.relationLabelTree.defaultRelation = [rData.relation_id];\r\n      var sid = rData.source;\r\n      var tid = rData.target;\r\n      var sIndex = $(this.$refs.labelToolArea)\r\n        .find(`.spanItem[id='${sid}']`)\r\n        .attr('_index');\r\n      var tIndex = $(this.$refs.labelToolArea)\r\n        .find(`.spanItem[id='${tid}']`)\r\n        .attr('_index');\r\n      var sData = this.dataInfo.labels[sIndex];\r\n      var tData = this.dataInfo.labels[tIndex];\r\n      var sType = sData.type || 'entity';\r\n      var tType = tData.type || 'entity';\r\n      var type = 'param';\r\n      this.relationDialog.source = sData.text;\r\n      this.relationDialog.target = tData.text;\r\n      if (sType !== 'entity') {\r\n        this.$message('起始标签需要为实体。');\r\n        return false;\r\n      }\r\n      rData.type = 0;\r\n      if (sType === 'entity' && tType === 'entity') {\r\n        type = 'relation';\r\n        rData.type = 1;\r\n        this.relationLabelTree.data = this.relationLabelTree.labels;\r\n        if (\r\n          !this.relationLabelTree.data ||\r\n          this.relationLabelTree.data.length === 0\r\n        ) {\r\n          this.$message('缺少关系标签数据');\r\n          return false;\r\n        }\r\n      } else if (sType === 'entity' && tType !== 'entity') {\r\n        this.relationLabelTree.data = this.getParamList(sData.label);\r\n        if (\r\n          !this.relationLabelTree.data ||\r\n          this.relationLabelTree.data.length === 0\r\n        ) {\r\n          this.$message(`[${sData.label}]实体没有配置属性标签数据。`);\r\n          return false;\r\n        }\r\n      } else {\r\n        // this.relationLabelTree.data = this.getParamList(tData.label);\r\n      }\r\n\r\n      this.relationDialog.lineType = type;\r\n      this.relationDialog.currentLabel = rData.label || '';\r\n\r\n      //Todo: 可以显示相关数据列表，进行批量修改\r\n\r\n      return true;\r\n    },\r\n    //切换算法标注结果\r\n    switchClacLabelMode() {\r\n      this.$confirm('确实切换显示算法标注结果吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }).then(() => {\r\n        this.$emit(\"confirmAlgorithmResult\");\r\n      });\r\n    },\r\n    //切换显示批注列表\r\n    switchCommentMode() {\r\n      if (this.commentsOption.flag === 0) {\r\n        this.commentsOption.flag = 1;\r\n      } else {\r\n        this.commentsOption.flag = 0;\r\n      }\r\n      this.updateCommentList();\r\n      this.scrollWidth = $(this.$refs.labelToolArea)\r\n        .find(\".contentArea\").width() - $(this.$refs.labelToolArea)\r\n        .find(\".mainContentArea\").width()\r\n    },\r\n    //标注行为产生的数据会实时保存，保存按钮只作提示用\r\n    saveLabelData() {\r\n      this.$message('已保存。');\r\n    },\r\n    //撤销当前操作\r\n    redoLabelOp() {\r\n      //发送撤销上次操作请求\r\n      var _self = this;\r\n      if (this.backupOp && this.backupOp.type) {\r\n        this.$emit(\"undo\", this.backupOp);\r\n      }\r\n    },\r\n    //标注操作信息的备份\r\n    opBackup(type, param) {\r\n      this.backupOp = {\r\n        type: type,\r\n        data: param,\r\n        task_id: this.currentInfo.task_id,\r\n        doc_id: this.currentInfo.doc_id,\r\n        user_id: this.currentInfo.user_id || '-',\r\n        group_num: this.currentInfo.groupNum,\r\n      };\r\n    },\r\n    //备份操作前的标签数据\r\n    opBackupData(flag) {\r\n      if (flag) {\r\n        this.dataInfo.flag = 0;\r\n        this.commentsOption.data = [];\r\n        for (let k in this.backup) {\r\n          this.dataInfo[k] = [];\r\n          for (let i = 0; i < this.backup[k].length; i++) {\r\n            if (k === 'remarks') {\r\n              this.commentsOption.data.push({\r\n                ...this.backup[k][i]\r\n              });\r\n            } else {\r\n              this.dataInfo[k].push({\r\n                ...this.backup[k][i]\r\n              });\r\n            }\r\n          }\r\n        }\r\n      } else {\r\n        this.dataInfo.remarks = this.commentsOption.data;\r\n        for (let k in this.backup) {\r\n          this.backup[k] = [];\r\n          for (let i = 0; i < this.dataInfo[k].length; i++) {\r\n            this.backup[k].push({\r\n              ...this.dataInfo[k][i]\r\n            });\r\n          }\r\n        }\r\n      }\r\n    },\r\n    //清空标签数据\r\n    removeLabelInfo() {\r\n      this.$confirm('确实要清空所有标签吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }).then(() => {\r\n        this.$emit(\"confirmClearData\");\r\n      });\r\n    },\r\n    //实体标签树选中变化的响应函数\r\n    entityLabelChange(data, checked) {\r\n      // console.log(data, checked, node, '08');\r\n      var nodeData = this.labelDialog.data;\r\n      var rIndex = this.findRelation(nodeData.id);\r\n      if (checked && this.$refs.entityLabelTree) {\r\n        this.entityLabelTree.current = this.entityLabelTree.current || {};\r\n        if (data.params) {\r\n          this.entityLabelTree.select = [];\r\n          if (this.labelDialog.data.type === 'param' && rIndex !== -1) {\r\n            this.$message('需要先删除标签上的连线，才能改为实体标签');\r\n            return false;\r\n          }\r\n          this.$refs.entityLabelTree.setCheckedNodes([data]);\r\n\r\n          this.entityLabelTree.current.entity = data;\r\n          this.entityLabelTree.current.param = null;\r\n        } else {\r\n          if (this.labelDialog.data.type !== 'param' && rIndex !== -1) {\r\n            this.$refs.entityParamList.setCheckedNodes([]);\r\n            this.$message('需要先删除标签上的连线，才能改为属性标签');\r\n            return false;\r\n          }\r\n          this.$refs.entityLabelTree.setCheckedNodes([]);\r\n          this.entityLabelTree.current.entity = null;\r\n          this.entityLabelTree.current.param = data;\r\n          this.$refs.entityParamList.setCheckedNodes([data]);\r\n        }\r\n      } else {\r\n        // this.entityLabelTree.current.entity = null;\r\n        // this.entityLabelTree.current.param = null;\r\n      }\r\n    },\r\n    //关系标签树选中变化的响应函数(只控制多选为单选)\r\n    relationLabelChange(data, checked) {\r\n      if (checked && this.$refs.relationLabelTree) {\r\n        this.$refs.relationLabelTree.setCheckedNodes([data]);\r\n      }\r\n    },\r\n    //关系标签树，选中对象发生变化时更新关系标签名称\r\n    relationCurrentChange(a, b) {\r\n      if (b.checkedNodes.length !== 0) {\r\n        this.relationDialog.selectLabel = a.label;\r\n        this.relationDialog.current = a;\r\n      } else {\r\n        this.relationDialog.selectLabel = '';\r\n      }\r\n    },\r\n    //实体或属性标签树选中发生变化时触发该响应函数\r\n    handleLabelClick(data) {\r\n      this.entityLabelTree.current = this.entityLabelTree.current || {};\r\n      this.entityLabelTree.current._entity = data;\r\n      this.entityLabelTree.select = data.params;\r\n    },\r\n    //删除标注\r\n    dealClickRemoveComments(item) {\r\n      this.$confirm('确实要删除批注吗？', '提示', {\r\n        confirmButtonText: '确定',\r\n        cancelButtonText: '取消',\r\n        type: 'warning',\r\n      }).then(() => {\r\n        //操作前备份\r\n        this.opBackupData();\r\n        var _index = $('#' + item.id).attr('_index');\r\n        var nodeData = this.dataInfo.labels[_index];\r\n        this.opBackup('update_node', [{\r\n          ...nodeData\r\n        }]);\r\n        // var nodeData = this.group[nodeData.group].labels[nodeData.index];\r\n        nodeData.postil = '';\r\n        this.$emit(\"confirmDeleteComments\", nodeData);\r\n      });\r\n    },\r\n    //切换工具的功能模式：标注模式或预览模式\r\n    switchToolMode() {\r\n      if (this.mode === 'view') {\r\n        this.mode = 'edit';\r\n      } else {\r\n        this.mode = 'view';\r\n      }\r\n      this.updateContentArea();\r\n    },\r\n    //替换当前的标注数据\r\n    updateData(markData) {\r\n      this.initConfig();\r\n      this.currentInfo = markData;\r\n      this.dataInfo.relation = [];\r\n      this.dataInfo.labels = [];\r\n      this.commentsOption.data = [];\r\n      this.dataInfo.remarks = [];\r\n      this.switchMarkData(markData);\r\n      this.switchLabelData();\r\n      this.updateContentArea();\r\n    },\r\n    //通过id删除标签连线的数组元素\r\n    removeRelationById(id, flag) {\r\n      if (!flag) {\r\n        this.removeItem(this.dataInfo.relation, {\r\n          source: id\r\n        });\r\n        this.removeItem(this.dataInfo.relation, {\r\n          target: id\r\n        });\r\n      } else {\r\n        var param = {};\r\n        param[flag] = id;\r\n        this.removeItem(this.dataInfo.relation, param);\r\n      }\r\n    },\r\n    //通过源标签ID或目标标签ID查找关系连线，返回结果的索引\r\n    findRelation(source, target) {\r\n      var ret = -1;\r\n      var arr = this.dataInfo.relation;\r\n      for (var i = 0; i < arr.length; i++) {\r\n        if (arr[i].source === source && arr[i].target === target) {\r\n          ret = i;\r\n          break;\r\n        }\r\n        if (!target && (arr[i].source === source || arr[i].target === source)) {\r\n          ret = i;\r\n          break;\r\n        }\r\n      }\r\n      return ret;\r\n    },\r\n    //通过段落编号和标签索引查找批注对象\r\n    findCommentItem(group, index) {\r\n      var ret = -1;\r\n      var arr = this.commentsOption.data;\r\n      for (var i = 0; i < arr.length; i++) {\r\n        if (arr[i].group === group && arr[i].index === index) {\r\n          ret = i;\r\n          break;\r\n        }\r\n      }\r\n      return ret;\r\n    },\r\n    //响应文本选择事件\r\n    handleSelectText(e) {\r\n      if (this.mode === 'view') {\r\n        return false;\r\n      }\r\n      var elem = this.$refs.entityContentArea;\r\n      let txt = window.getSelection ?\r\n        window.getSelection() :\r\n        elem.selection.createRange().text;\r\n      var sText = txt.toString();\r\n      if (txt.type !== 'Range') {\r\n        // this.$message('请您从左到右划选文字进行标注。');\r\n        return false;\r\n      }\r\n\r\n      if (sText !== '') {\r\n        var ret = this.getSelectTextOffset(txt); //选中文本数据\r\n        ret.group = e.srcElement.getAttribute('index') - 1;\r\n        if (ret.text === '' || e.srcElement.className !== 'contentItem') {\r\n          this.$message('鼠标划选内容无效。');\r\n        } else {\r\n          this.labelDialog.dialogObj.title = '选择标签(实体/属性)';\r\n          this.labelDialog.type = 'add';\r\n          this.labelDialog.data = ret;\r\n          this.updateLabelDialog();\r\n          this.labelDialog.visible = true;\r\n        }\r\n      }\r\n    },\r\n    //确认实体属性标签操作对话框对标签的操作\r\n    dealConfirmLabel(val) {\r\n      if (!val) {\r\n        this.labelDialog.visible = false;\r\n        return false;\r\n      }\r\n      if (\r\n        !this.entityLabelTree.current ||\r\n        (!this.entityLabelTree.current.param &&\r\n          !this.entityLabelTree.current.entity)\r\n      ) {\r\n        this.$message('需要选择一个标签。');\r\n        return false;\r\n      }\r\n\r\n      //将标签数据备份\r\n      this.opBackupData();\r\n\r\n      var label = '';\r\n      var param = this.entityLabelTree.current.param;\r\n      var data = this.labelDialog.data;\r\n      var olderData = {\r\n        ...data\r\n      };\r\n\r\n      if (param) {\r\n        var _entity = this.entityLabelTree.current._entity;\r\n        label = param.label + '-' + _entity.label;\r\n        data.type = 'param';\r\n        data.node_type = 1;\r\n        data.type_id = param.id;\r\n        data.type_name = param.label;\r\n        data.entity_id = _entity.id;\r\n        data.entity_name = _entity.label;\r\n      } else {\r\n        var entity = this.entityLabelTree.current.entity;\r\n        label = entity.label;\r\n        data.type = 'entity';\r\n        data.node_type = 0;\r\n        data.entity_id = entity.id;\r\n        data.entity_name = entity.label;\r\n      }\r\n\r\n      var _self = this;\r\n      data.index = data.group;\r\n      data.task_id = this.currentInfo.task_id || this.currentInfo.taskId;\r\n      data.node_name = data.text;\r\n      data.doc_id = this.currentInfo.doc_id;\r\n      if (this.toolBar) {\r\n        data.index = data.index + 1;\r\n      }\r\n\r\n      this.$emit('confirmChangeLabel', this.dataInfo.labels, data, this.labelDialog.batSelect);\r\n\r\n      this.labelDialog.visible = false;\r\n    },\r\n    //确认关系属性连线标签操作对话框对标签的操作\r\n    dealConfirmRelation(val) {\r\n      if (!val) {\r\n        this.relationDialog.visible = false;\r\n        return false;\r\n      }\r\n      var nodeData = this.$refs.relationLabelTree.getCheckedNodes()[0];\r\n      if (!nodeData) {\r\n        this.$message('需要选择一个标签。');\r\n        return false;\r\n      }\r\n\r\n      //将标签数据备份\r\n      this.opBackupData();\r\n\r\n      var rData = this.relationDialog.data;\r\n      var lType = this.relationDialog.lineType;\r\n      var olderData = {\r\n        ...rData\r\n      };\r\n      if (lType === 'relation') {\r\n        rData.type = 1;\r\n      } else {\r\n        rData.type = 0;\r\n      }\r\n      rData.relation_id = nodeData.id;\r\n      rData.label = nodeData.label;\r\n      rData.task_id = this.currentInfo.task_id || this.currentInfo.taskId;\r\n      rData.relation_name = nodeData.label;\r\n      rData.doc_id = this.currentInfo.doc_id;\r\n      rData.source_id = rData.source;\r\n      rData.target_id = rData.target;\r\n\r\n      this.$emit('confirmChangeRelation', this.dataInfo.relation, rData, this.relationDialog.batSelect);\r\n\r\n      this.relationDialog.visible = false;\r\n    },\r\n    //更新数据标签显示\r\n    updateContentArea() {\r\n      //生成内容数组\r\n      this.group = [];\r\n      let _self = this;\r\n      // console.log(this.dataInfo, 'this.dataInfo');\r\n      if (this.dataInfo.content && this.dataInfo.content.map) {\r\n        _self.group = this.dataInfo.content.map(item => {\r\n          item = {\r\n            key: Math.random(),\r\n            content: item,\r\n            labels: [],\r\n          };\r\n          return item;\r\n        });\r\n      }\r\n      //将标签按content数组进行分组\r\n      let arr = this.dataInfo.labels;\r\n      for (let i = 0; i < arr.length; i++) {\r\n        arr[i].id = arr[i].id || i;\r\n        arr[i].pIndex = i;\r\n        var index = arr[i].group;\r\n        if (this.group[index] && this.group[index].labels) {\r\n          this.group[index].labels.push(arr[i]);\r\n        }\r\n      }\r\n\r\n      //添加content内容标签信息\r\n      this.group = this.group.map(item => {\r\n        item.html = this.addSpanByData(item.labels, item.content);\r\n        return item;\r\n      });\r\n\r\n      // this.$forceUpdate();\r\n      //更新关系节点和边数据\r\n      setTimeout(() => {\r\n        _self.updateSvgItem();\r\n        _self.initSpanEvent();\r\n      }, 150);\r\n      this.highlightSearchMode = false;\r\n    },\r\n    //初始化标签事件\r\n    initSpanEvent() {\r\n      this.$nextTick(function () {\r\n        var _self = this;\r\n        //清除事件绑定\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .removeSpanBtn')\r\n          .off('click');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .editSpanBtn')\r\n          .off('click');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .addCommentsBtn')\r\n          .off('click');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .off('dragstart');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .off('drop');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .off('dragover');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanInfoArea')\r\n          .off('click');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem')\r\n          .off('click');\r\n\r\n        if (this.mode === 'view') {\r\n          return false;\r\n        }\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .removeSpanBtn')\r\n          .on('click', function () {\r\n            var index = $(this).attr('_index');\r\n            var flag = $(this.parentNode.parentNode.parentNode).hasClass(\r\n              'lineLabelList'\r\n            );\r\n            if (!flag) {\r\n              var nodeData = _self.dataInfo.labels[index];\r\n              var ret = _self.findRelation(nodeData.id);\r\n              if (ret !== -1) {\r\n                _self.$nextTick(() => {\r\n                  _self.$message('需要先删除该标签上的连线。');\r\n                });\r\n                return false;\r\n              }\r\n            }\r\n            // var d = _self.dataInfo.labels[index];\r\n            _self\r\n              .$confirm('确定要删除吗？', '提示', {\r\n                confirmButtonText: '确定',\r\n                cancelButtonText: '取消',\r\n                type: 'warning',\r\n              })\r\n              .then(() => {\r\n                //将标签数据备份\r\n                let d = _self.lineLabels[index];\r\n                _self.opBackupData();\r\n                _self.$emit(\"confirmDeleteLine\", d);\r\n              });\r\n            return false;\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea input')\r\n          .off('click');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea input')\r\n          .on('click', function (e) {\r\n            e.stopPropagation();\r\n          });\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .setBaseOp input')\r\n          .off('change');\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .setBaseOp input')\r\n          .on('change', function (e) {\r\n            var _index = $(this).attr('_index');\r\n            var _type = $(this).attr('_type');\r\n\r\n            var base = this.checked ? 1 : 0;\r\n            if (_type === 'relation') {\r\n              var rItem = _self.dataInfo.relation[_index];\r\n              _self.$emit(\"setRelationBase\", rItem);\r\n            } else {\r\n              var labelItem = _self.dataInfo.labels[_index];\r\n              _self.$emit(\"setLabelBase\", labelItem);\r\n            }\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .editSpanBtn')\r\n          .on('click', function () {\r\n            var type = $(this)\r\n              .parent()\r\n              .attr('type');\r\n            let _index = $(this).attr('_index');\r\n            if (type === 'line') {\r\n              _self.relationDialog.type = 'edit';\r\n              _self.relationDialog.data = _self.dataInfo.relation[_index];\r\n              _self.updateRelationDialog();\r\n              _self.relationDialog.type = 'edit';\r\n              _self.relationDialog.visible = true;\r\n              _self.relationDialog.dialogObj.title = '编辑标签连线';\r\n            } else {\r\n              _self.labelDialog.visible = true;\r\n              _self.labelDialog.type = 'edit';\r\n              _self.labelDialog.data = _self.dataInfo.labels[_index];\r\n              _self.labelDialog.data._index = _index;\r\n              _self.labelDialog.dialogObj.title = '编辑标签(属性、实体)';\r\n              _self.updateLabelDialog();\r\n            }\r\n            return false;\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.opSpanInfoArea .addCommentsBtn')\r\n          .on('click', function () {\r\n            var index = $(this).attr('_index');\r\n            var label = _self.dataInfo.labels[index];\r\n            _self.commentsOption.flag = 1;\r\n            _self.addCommentItem(label.id, '', 'node');\r\n            return false;\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .on('dragstart', function (e) {\r\n            _self.currentDrag = e.currentTarget;\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .on('drop', function (e) {\r\n            e.preventDefault();\r\n            var source = _self.currentDrag.parentElement.id;\r\n            var sIndex = $(_self.currentDrag.parentElement).attr('_index');\r\n            var tIndex = $(e.currentTarget.parentElement).attr('_index');\r\n            var sNode = _self.dataInfo.labels[sIndex];\r\n            var tNode = _self.dataInfo.labels[tIndex];\r\n            var target = e.currentTarget.parentElement.id;\r\n            var rIndex = _self.findRelation(source, target);\r\n            if (rIndex === -1 && sNode.id !== tNode.id) {\r\n              _self.relationDialog.data = {\r\n                source: sNode.id,\r\n                target: tNode.id,\r\n                source_name: sNode.text,\r\n                target_name: tNode.text,\r\n                // 任务管理里边的参数\r\n                source_index: Math.max(sNode.index + 1, 0),\r\n                target_index: Math.max(tNode.index + 1, 0),\r\n                source_offset: sNode.offset,\r\n                target_offset: tNode.offset,\r\n                source_type: sNode.entity_name,\r\n                target_type: tNode.type_name ?\r\n                  tNode.type_name : tNode.entity_name,\r\n              };\r\n              var ret = _self.updateRelationDialog();\r\n              if (ret) {\r\n                _self.relationDialog.visible = true;\r\n                _self.relationDialog.type = 'add';\r\n                _self.relationDialog.dialogObj.title = '设置标签连线';\r\n              }\r\n            }\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .on('dragover ', function (e) {\r\n            e.preventDefault();\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanInfoArea')\r\n          .on('click', function () {\r\n            var active = $(this).attr('active');\r\n            $(_self.$refs.labelToolArea)\r\n              .find('.spanInfoArea[active=true]')\r\n              .attr('active', false);\r\n            if (active === 'true' || active === true) {\r\n              $(this).attr('active', false);\r\n            } else {\r\n              $(this).attr('active', true);\r\n            }\r\n          });\r\n\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem')\r\n          .on('click', function () {});\r\n      });\r\n    },\r\n    //添加标签连线\r\n    addRelationData(rData) {\r\n      rData = {\r\n        ...rData\r\n      };\r\n      rData.id = rData._id;\r\n      this.removeItem(this.dataInfo.relation, rData.id);\r\n      this.dataInfo.relation.push(rData);\r\n    },\r\n    //调校标签连线的起始坐标\r\n    adustNodePosition(elem) {\r\n      var pos = {\r\n        x: 50,\r\n        y: 50,\r\n      };\r\n      var tRect = elem.getBoundingClientRect();\r\n      var pRect = $(this.$refs.labelToolArea)\r\n        .find('.canvasItem')[0]\r\n        .getBoundingClientRect();\r\n      pos.x = tRect.x - pRect.x;\r\n      pos.y = tRect.y - pRect.y;\r\n      return pos;\r\n    },\r\n    //生成连线参数\r\n    produceLinesParams() {\r\n      var ret = [];\r\n      var arr = this.dataInfo.relation || [];\r\n\r\n      this.lineLabels = [];\r\n      for (var i = 0; i < arr.length; i++) {\r\n        var d = arr[i];\r\n        var item = {\r\n          type: 'line',\r\n          arrow: true,\r\n          data: d,\r\n          shape: [],\r\n        };\r\n        // 连线图形的参数;\r\n        var shape = item.shape;\r\n        var elem = $(this.$refs.labelToolArea).find(\r\n          `.spanItem[id='${d.source}']`\r\n        )[0];\r\n        if (!elem) {\r\n          continue;\r\n        }\r\n        var pos = this.adustNodePosition(elem);\r\n        shape.push(pos);\r\n        elem = $(this.$refs.labelToolArea).find(\r\n          `.spanItem[id='${d.target}']`\r\n        )[0];\r\n        if (!elem) {\r\n          continue;\r\n        }\r\n\r\n        pos = this.adustNodePosition(elem);\r\n        shape.push(pos);\r\n\r\n        //贝塞尔线的控制点坐标\r\n        var cPos = {\r\n          x: (shape[0].x + shape[1].x) / 3 + 10,\r\n          y: shape[1].y + 40,\r\n        };\r\n        if (\r\n          Math.abs(shape[1].x - shape[0].x) < Math.abs(shape[1].y - shape[0].y)\r\n        ) {\r\n          cPos = {\r\n            x: shape[1].x + 40,\r\n            y: (shape[0].y + shape[1].y) / 3 + 10,\r\n          };\r\n          if (shape[1].y > shape[0].y) {\r\n            cPos.x = shape[1].x - 40;\r\n          }\r\n        } else {\r\n          if (shape[1].x > shape[0].x) {\r\n            cPos.y = shape[1].y - 40;\r\n          }\r\n        }\r\n\r\n        shape.push(cPos);\r\n        ret.push(item);\r\n\r\n      }\r\n      return ret;\r\n    },\r\n    //初始化SVG对象\r\n    initSvgItem() {\r\n      this.svgItem = this.$refs.canvasItem;\r\n      this.svgItem.querySelector('.pathGroup').innerHTML = '';\r\n      this.svgItem.querySelector('.textGroup').innerHTML = '';\r\n      this.svgItem.querySelector('.commentsGroup').innerHTML = '';\r\n    },\r\n    //更新关系线(svg元素)\r\n    updateSvgItem() {\r\n      this.initSvgItem();\r\n      //更新标签连线\r\n      this.updatelabelLine();\r\n      //更新批注连线\r\n      this.updateCommentList();\r\n    },\r\n    //鼠标悬浮在连线的标签上时，高亮显示连线\r\n    mouseoverLineItem(e) {\r\n      var index = $(e.currentTarget).attr('_index');\r\n      var rData = this.lineLabels[index];\r\n      var selector = $(this.$refs.labelToolArea).find('#path' + rData.id);\r\n      selector.css('stroke', '#52c41a');\r\n      selector.attr('marker-end', 'url(#markerArrow2)');\r\n    },\r\n    //鼠标离开连线的标签上时，高亮显示连线\r\n    mouseleaveLineItem(e) {\r\n      var index = $(e.currentTarget).attr('_index');\r\n      var rData = this.lineLabels[index];\r\n      var selector = $(this.$refs.labelToolArea).find('#path' + rData.id);\r\n      selector.css('stroke', '#91D5FF');\r\n      selector.attr('marker-end', 'url(#markerArrow)');\r\n    },\r\n    //更新标签连线\r\n    updatelabelLine() {\r\n      this.svgItem.querySelector('.pathGroup').innerHTML = '';\r\n      this.svgItem.querySelector('.textGroup').innerHTML = '';\r\n      let arr = this.produceLinesParams();\r\n      for (let i = 0; i < arr.length; i++) {\r\n        let shape = arr[i].shape;\r\n        let pathData = `M${shape[0].x},${shape[0].y}Q${shape[2].x},${shape[2].y},${shape[1].x},${shape[1].y}`;\r\n        let path = document.createElementNS(\r\n          'http://www.w3.org/2000/svg',\r\n          'path'\r\n        );\r\n        let pId = arr[i].data.id;\r\n        path.setAttribute('d', pathData);\r\n        path.setAttribute(\r\n          'style',\r\n          'stroke-width:1; stroke:#91D5FF; fill: none'\r\n        );\r\n        path.setAttribute('marker-end', 'url(#markerArrow)');\r\n\r\n        //取消标签高亮或关系高亮效果\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem .selectText')\r\n          .attr('highlight', false);\r\n        $(this.$refs.labelToolArea)\r\n          .find('.spanItem')\r\n          .removeClass('highlightItem');\r\n        if (\r\n          this.currentLabelLine &&\r\n          this.currentLabelLine.source === arr[i].data.source &&\r\n          this.currentLabelLine.target === arr[i].data.target\r\n        ) {\r\n          path.setAttribute(\r\n            'style',\r\n            'stroke-width:2; stroke:#91D5FF; fill: none'\r\n          );\r\n          path.setAttribute('marker-end', 'url(#markerArrow)');\r\n\r\n          let sid = this.currentLabelLine.source;\r\n          let tid = this.currentLabelLine.target;\r\n          $(this.$refs.labelToolArea)\r\n            .find(`.spanItem#${sid} .selectText`)\r\n            .attr('highlight', true);\r\n          $(this.$refs.labelToolArea)\r\n            .find(`.spanItem#${tid} .selectText`)\r\n            .attr('highlight', true);\r\n        }\r\n\r\n        this.svgItem.querySelector('.pathGroup').appendChild(path);\r\n        path.setAttribute('id', 'path' + pId);\r\n\r\n        //创建text对象，不实际显示信息，仅做html连线标签定位\r\n        let text = document.createElementNS(\r\n          'http://www.w3.org/2000/svg',\r\n          'text'\r\n        );\r\n\r\n        if (\r\n          Math.abs(shape[1].x - shape[0].x) > Math.abs(shape[1].y - shape[0].y)\r\n        ) {\r\n          text.setAttribute('x', Math.abs((shape[1].x - shape[0].x) / 2));\r\n        } else {\r\n          text.setAttribute('x', Math.abs((shape[1].y - shape[0].y) / 2));\r\n        }\r\n\r\n        text.setAttribute('index', i);\r\n        let textPath = document.createElementNS(\r\n          'http://www.w3.org/2000/svg',\r\n          'textPath'\r\n        );\r\n        textPath.setAttribute('href', '#path' + pId);\r\n        textPath.innerHTML = '.';\r\n        text.appendChild(textPath);\r\n        this.svgItem.querySelector('.textGroup').appendChild(text);\r\n        arr[i].textItem = text;\r\n      }\r\n      //更新标签连线的文本坐标\r\n      var _self = this;\r\n      setTimeout(function () {\r\n        _self.updateLineLabels(arr);\r\n      }, 50);\r\n    },\r\n    //更新批注线\r\n    updateCommentLine() {\r\n      var tRect = $(this.$refs.labelToolArea)\r\n        .find('.contentContainer')[0]\r\n        .getBoundingClientRect();\r\n      $(this.$refs.labelToolArea)\r\n        .find(`.contentItem .spanItem>.selectText`)\r\n        .attr('commentHighlight', false);\r\n      for (let i = 0; i < this.commentsOption.data.length; i++) {\r\n        var cItem = this.commentsOption.data[i];\r\n        if (cItem.current) {\r\n          this.commentsOption.current = i;\r\n        }\r\n        if (i !== this.commentsOption.current) {\r\n          continue;\r\n        }\r\n        var path = document.createElementNS(\r\n          'http://www.w3.org/2000/svg',\r\n          'path'\r\n        );\r\n        path.setAttribute(\r\n          'style',\r\n          'stroke-width:0.5; stroke: #ff4d4f; fill: none'\r\n        );\r\n        let item = this.commentsOption.data[i];\r\n        let labelItem = $(this.$refs.labelToolArea).find(\r\n          `.contentItem .spanItem[id='${item.id}']>.selectText`\r\n        )[0];\r\n        if (labelItem) {\r\n          labelItem.setAttribute('commentHighlight', true);\r\n          let rect = labelItem.getBoundingClientRect();\r\n          var commentItem = $(this.$refs.labelToolArea)\r\n            .find('.commentsItem')\r\n            .eq(i)[0];\r\n          if (commentItem) {\r\n            let _rect = commentItem.getBoundingClientRect();\r\n            var pos = [rect.right - tRect.x, rect.bottom - tRect.y];\r\n            var _pos = [_rect.x - tRect.x, _rect.y - tRect.y];\r\n            var pathData = `M${pos[0]},${pos[1]} L${pos[0] + 3},${pos[1] +\r\n          3} H${tRect.width - 40} L${_pos[0] - 10}, ${_pos[1] + 25}`;\r\n            path.setAttribute('d', pathData);\r\n            this.svgItem.querySelector('.commentsGroup').appendChild(path);\r\n          }\r\n        }\r\n\r\n      }\r\n    },\r\n    //更新批注列表\r\n    updateCommentList(index) {\r\n      if (typeof index !== 'undefined') {\r\n        this.commentsOption.current = index;\r\n      }\r\n      if (!this.svgItem) {\r\n        return false;\r\n      }\r\n      this.svgItem.querySelector('.commentsGroup').innerHTML = '';\r\n\r\n      if (this.commentsOption.flag === 0) {\r\n        return false;\r\n      }\r\n\r\n      var tArr = this.commentsOption.data;\r\n      var _self = this;\r\n      //对批注对象进行排序\r\n      tArr.sort((b, a) => {\r\n        a.group = $(this.$refs.labelToolArea)\r\n          .find(`.contentItem #${a.id}`)\r\n          .parent()\r\n          .index();\r\n        a.index = $(_self.$refs.labelToolArea)\r\n          .find(`.contentItem #${a.id}`)\r\n          .attr('index');\r\n        b.group = $(_self.$refs.labelToolArea)\r\n          .find(`.contentItem #${b.id}`)\r\n          .parent()\r\n          .index();\r\n        b.index = $(_self.$refs.labelToolArea)\r\n          .find(`.contentItem #${b.id}`)\r\n          .attr('index');\r\n        var ret = Number(b.group) - Number(a.group);\r\n        if (ret === 0) {\r\n          ret = Number(b.index) - Number(a.index);\r\n        }\r\n        return ret;\r\n      });\r\n      this.commentsOption.data = [];\r\n      for (let i = 0; i < tArr.length; i++) {\r\n        if (this.tMode !== 'check') {\r\n          tArr[i].content = tArr[i].content.replace(/\\n/g, '<br/>');\r\n        }\r\n        this.commentsOption.data.push(tArr[i]);\r\n      }\r\n\r\n      //更新批注线\r\n      if (this.commentsOption.flag === 1) {\r\n        this.$nextTick(() => {\r\n          this.updateCommentLine();\r\n        });\r\n      }\r\n    },\r\n    //查找批注对象的索引\r\n    findCommentById(id) {\r\n      var ret = -1;\r\n      var arr = this.commentsOption.data;\r\n      for (var i = 0; i < arr.length; i++) {\r\n        if (arr[i].id === id) {\r\n          ret = i;\r\n          break;\r\n        }\r\n      }\r\n      return ret;\r\n    },\r\n    //添加批注\r\n    addCommentItem(id, content, type) {\r\n      if (!id) {\r\n        return false;\r\n      }\r\n      //清除批注的current标记。\r\n      this.commentsOption.data = this.commentsOption.data.map(item => {\r\n        delete item.current;\r\n        return item;\r\n      });\r\n\r\n      var tIndex = this.findCommentById(id);\r\n      if (tIndex === -1) {\r\n        //将标签数据备份\r\n        this.opBackupData();\r\n        //添加带current标记的批注对象\r\n        var item = {\r\n          id: id,\r\n          type: type || 'node',\r\n          current: true,\r\n          content: content || '',\r\n          author: '',\r\n        };\r\n        this.commentsOption.data.push(item);\r\n        this.$emit('remark-add', this.commentsOption.data, item);\r\n      } else {\r\n        this.commentsOption.data[tIndex].current = true;\r\n      }\r\n      this.commentsOption.current = -1;\r\n      this.updateCommentList();\r\n    },\r\n    //更新标签连线的文本提示\r\n    updateLineLabels(arr) {\r\n      this.lineLabels = [];\r\n      // var tArr = [];\r\n      for (let i = 0; i < arr.length; i++) {\r\n        var d = arr[i].data;\r\n        // d.key = 'link-' + new Date().getTime();\r\n        var box = arr[i].textItem.getBBox();\r\n        d.style = {\r\n          left: box.x - 40 + 'px',\r\n          top: box.y + 'px',\r\n        };\r\n        if (this.comments) {\r\n          d.style.top = box.y - 5 + 'px';\r\n        }\r\n        if (\r\n          this.currentLabelLine &&\r\n          d.source === this.currentLabelLine.source &&\r\n          d.target === this.currentLabelLine.target\r\n        ) {\r\n          d.highlight = true;\r\n        } else {\r\n          d.highlight = false;\r\n        }\r\n        this.lineLabels.push(d);\r\n        // this.$set(this.lineLabels, i, d);\r\n      }\r\n      this.lineLabels = this.lineLabels.concat([]);\r\n      this.initSpanEvent();\r\n    },\r\n    mouseoverCommentsItem(e) {\r\n      var index = $(e.currentTarget).attr('_index');\r\n      //清除批注的current标注。\r\n      this.commentsOption.data = this.commentsOption.data.map(item => {\r\n        delete item.current;\r\n        return item;\r\n      });\r\n      //更新批注列表\r\n      this.updateCommentList(Number(index));\r\n    },\r\n    //获取选中文本的偏移量\r\n    getSelectTextOffset(txt) {\r\n      var lastNode = txt.baseNode.previousElementSibling;\r\n      var pos = Math.min(txt.baseOffset, txt.focusOffset);\r\n      var t2 = Math.max(txt.baseOffset, txt.focusOffset);\r\n      let str = txt.baseNode.data.slice(pos, t2); //选中文本\r\n      if (lastNode) {\r\n        var tPos = Number(lastNode.getAttribute('offset'));\r\n        var text = lastNode.innerText;\r\n        var tText = text.split('\\n')[0];\r\n        pos += tPos + tText.length;\r\n      }\r\n      let ret = {\r\n        text: str,\r\n        type: txt.type,\r\n        offset: pos,\r\n        id: new Date().getTime() + '',\r\n      };\r\n      return ret;\r\n    },\r\n    // 改标签内容和样式\r\n    addSpanByData(data, text) {\r\n      if (!data || data.length === 0 || typeof text !== 'string') {\r\n        return text;\r\n      }\r\n      data.sort(function (a, b) {\r\n        return a.offset - b.offset;\r\n      });\r\n      var rStr = text.slice(0, data[0].offset);\r\n      for (var i = 0; i < data.length; i++) {\r\n        var item = data[i];\r\n        if (!item.text) {\r\n          continue;\r\n        }\r\n        var tStr = `<span style=\"position: relative;\" type=\"${item.type}\" _index=${item.pIndex} class=\"spanItem\" index=${i} id=\"${item.id}\" title=\"${item.label}\" offset=${item.offset}><span draggable='true' title=\"${item.text}\"  class=\"selectText\">${item.text}</span> \r\n                <div class=\"spanInfoArea\" style=\"\"><span class=\"spanText\" >${item.label}</span>\r\n                <span mode='${this.tMode}'  class=\"opSpanInfoArea\">\r\n                  <svg title=\"编辑标注信息\" _index=${item.pIndex} index=${i} class=\"editSpanBtn\" viewBox=\"0 0 1024 1024\" xmlns=\"http://www.w3.org/2000/svg\" style=\"margin-right: 5px;\"><path fill=\"currentColor\" d=\"M832 512a32 32 0 1 1 64 0v352a32 32 0 0 1-32 32H160a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32h352a32 32 0 0 1 0 64H192v640h640V512z\"></path><path fill=\"currentColor\" d=\"m469.952 554.24 52.8-7.552L847.104 222.4a32 32 0 1 0-45.248-45.248L477.44 501.44l-7.552 52.8zm422.4-422.4a96 96 0 0 1 0 135.808l-331.84 331.84a32 32 0 0 1-18.112 9.088L436.8 623.68a32 32 0 0 1-36.224-36.224l15.104-105.6a32 32 0 0 1 9.024-18.112l331.904-331.84a96 96 0 0 1 135.744 0z\"></path></svg>\r\n                  <svg title=\"删除标注信息\"  _index=${item.pIndex} index=${i} class=\"removeSpanBtn\"  viewBox=\"0 0 1024 1024\"  xmlns=\"http://www.w3.org/2000/svg\" ><path fill=\"currentColor\" d=\"M160 256H96a32 32 0 0 1 0-64h256V95.936a32 32 0 0 1 32-32h256a32 32 0 0 1 32 32V192h256a32 32 0 1 1 0 64h-64v672a32 32 0 0 1-32 32H192a32 32 0 0 1-32-32V256zm448-64v-64H416v64h192zM224 896h576V256H224v640zm192-128a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32zm192 0a32 32 0 0 1-32-32V416a32 32 0 0 1 64 0v320a32 32 0 0 1-32 32z\"></path></svg> </span></div></span>`;\r\n        if (this.tMode === 'checkTwo') {\r\n          //审核结对标注结果，可以支持设置基准\r\n          var checkFlag = '';\r\n          if (item.base === '1' || item.base === 1) {\r\n            checkFlag = 'checked';\r\n          }\r\n          tStr = `<span style=\"position: relative;\" type=\"${\r\n            item.type\r\n          }\" _index=${item.pIndex} class=\"spanItem\" index=${i} id=\"${\r\n            item.id\r\n          }\" title=\"${item.label}\" offset=${\r\n            item.offset\r\n          }><span draggable='true' class=\"selectText\"  title=\"${item.text}\" >${\r\n            item.text\r\n          }</span> \r\n                <div class=\"spanInfoArea\" baseFlag=\"${item.base ||\r\n                  0}\" sameFlag=\"${\r\n            item._same\r\n          }\" style=\"\"><span class=\"spanText\" >${item.label}</span>\r\n                <span mode='${\r\n                  this.tMode\r\n                }' class=\"opSpanInfoArea\"><Edit title=\"编辑标注信息\" _index=${\r\n            item.pIndex\r\n          } index=${i} class=\"editSpanBtn\"></Edit><Delete title=\"删除标注信息\" class=\"removeSpanBtn\" _index=${\r\n            item.pIndex\r\n          } index=${i} style=\"margin: 0 2px;\"></Delete> <span class='setBaseOp'><input _type='node' _index=${\r\n            item.pIndex\r\n          } ${checkFlag} type='checkbox'>基准</span></span></div></span>`;\r\n        } else if (this.tMode === 'check') {\r\n          //审核模式时支持批注\r\n          tStr = `<span style=\"position: relative;\" type=\"${item.type}\" _index=${item.pIndex} class=\"spanItem\" index=${i} id=\"${item.id}\" title=\"${item.label}\" offset=${item.offset}><span draggable='true'  title=\"${item.text}\"  class=\"selectText\">${item.text}</span> \r\n                <div class=\"spanInfoArea\" style=\"\"><span class=\"spanText\" >${item.label}</span>\r\n                <span mode='${this.tMode}' class=\"opSpanInfoArea\"><Edit title=\"编辑标注信息\" _index=${item.pIndex} index=${i} class=\"iconfont iconatlas_edit_icon editSpanBtn\"></Edit> <EditPen title=\"添加批注\" class=\"addCommentsBtn iconfont iconbiaoji\" _index=${item.pIndex} index=${i}></EditPen><Delete title=\"删除标注信息\" class=\"removeSpanBtn\" _index=${item.pIndex} index=${i} style=\"margin: 0 2px;\"></Delete> </span></div></span>`;\r\n        }\r\n        rStr += tStr;\r\n        if (i < data.length - 1) {\r\n          rStr += text.slice(\r\n            data[i].offset + data[i].text.length,\r\n            data[i + 1].offset\r\n          );\r\n        } else {\r\n          rStr += text.slice(data[i].offset + data[i].text.length);\r\n        }\r\n      }\r\n      return rStr;\r\n    },\r\n    //高亮查询文本\r\n    highlightSearchText(text) {\r\n      this.clearHighligtItems();\r\n      this.$nextTick(() => {\r\n        this.highlightSearchMode = true;\r\n        let items = $(this.$refs.labelToolArea).find('.contentItem');\r\n        let bol = items.text().includes(text);\r\n        if (!bol) {\r\n          this.$message({\r\n            message: '请输入文章中存在的关键词！',\r\n            type: 'warning',\r\n          });\r\n        } else {\r\n          for (let i = 0; i < items.length; i++) {\r\n            var cNodes = items[i].childNodes;\r\n            for (let j = 0; j < cNodes.length; j++) {\r\n              let node = cNodes[j];\r\n              if (node.nodeName === '#text') {\r\n                var tNode = document.createElement('span');\r\n                var reg = new RegExp(text, 'gi');\r\n                tNode.innerHTML = node.textContent.replace(\r\n                  reg,\r\n                  `<i class=\"searchHighlightText\">${text}</i>`\r\n                );\r\n                node.after(tNode);\r\n                node.remove();\r\n              }\r\n            }\r\n          }\r\n        }\r\n      });\r\n    },\r\n    removeSearchHighlight() {\r\n      if (this.highlightSearchMode) {\r\n        this.updateContentArea();\r\n      }\r\n    },\r\n    //高亮显示筛选的连线\r\n    highlightLineById(sid, tid) {\r\n      this.currentLabelLine = {\r\n        source: sid,\r\n        target: tid,\r\n      };\r\n      this.updateContentArea();\r\n    },\r\n    //清空高亮对象\r\n    clearHighligtItems() {\r\n      this.currentLabelLine = {};\r\n      $(this.$refs.labelToolArea)\r\n        .find('.spanItem')\r\n        .removeClass('highlightItem');\r\n      this.updatelabelLine();\r\n    },\r\n    // 高亮显示筛选的标签\r\n    highlightLabelsById(id) {\r\n      if (id && id.constructor.name === 'String') {\r\n        id = [id];\r\n      }\r\n      //清空其他高亮对象\r\n      this.clearHighligtItems();\r\n      if (id && id.constructor.name === 'Array') {\r\n        for (let i = 0; i < id.length; i++) {\r\n          let selector = $(this.$refs.labelToolArea).find(\r\n            `.spanItem[id='${id[i]}']`\r\n          );\r\n          selector.addClass('highlightItem');\r\n        }\r\n      }\r\n    },\r\n    // 高亮显示筛选的标签\r\n    highlightLabelsByItem(item) {\r\n      var id = [];\r\n      var elems = document.querySelectorAll(\r\n        `[title=${item.entity_name}]>[title=${item.node_name}]`\r\n      );\r\n      for (var i = 0; i < elems.length; i++) {\r\n        var tElem = elems[i].parentNode;\r\n        id.push(tElem.id);\r\n      }\r\n      this.highlightLabelsById(id);\r\n    },\r\n\r\n  },\r\n  props: {\r\n    markData: Object,\r\n    config: Object\r\n  }\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n* {\r\n  box-sizing: border-box;\r\n}\r\n\r\n.labelToolArea {\r\n  position: relative;\r\n  float: left;\r\n  height: 100%;\r\n  width: 100%;\r\n  padding-top: 48px;\r\n}\r\n\r\n.labelToolArea[toolBar='false'] {\r\n  padding-top: 0px;\r\n}\r\n\r\n.labelToolArea[toolBar='false'] .labelOptionArea {\r\n  display: none;\r\n}\r\n\r\n.contentArea {\r\n  position: relative;\r\n  float: left;\r\n  height: 100%;\r\n  width: 100%;\r\n  overflow-y: auto !important;\r\n  box-sizing: border-box;\r\n  scrollbar-color: #ddd #fff;\r\n  scrollbar-width: thin;\r\n  text-align: left;\r\n}\r\n\r\n.mainContentArea {\r\n  width: 100%;\r\n  height: auto;\r\n  min-height: 100%;\r\n  position: relative;\r\n  float: left;\r\n  background-color: rgb(245, 245, 245);\r\n}\r\n\r\n.mainContentArea[flag='1'],\r\n.contentArea[flag='1'] {\r\n  width: calc(100% + 380px);\r\n}\r\n\r\n.labelOptionArea,\r\n.commentListTitle {\r\n  position: absolute;\r\n  width: 100%;\r\n  top: 0px;\r\n  background: rgba(24, 144, 255, 0.1);\r\n  border: 1px solid rgba(24, 144, 255, 0.1);\r\n  box-sizing: border-box;\r\n  backdrop-filter: blur(45px);\r\n  border-radius: 2px;\r\n  height: 48px;\r\n  line-height: 48px;\r\n  z-index: 1;\r\n  text-align: left;\r\n}\r\n\r\n.commentListTitle {\r\n  width: 370px;\r\n  padding-left: 10px;\r\n  right: -382px;\r\n  display: none;\r\n}\r\n\r\n.commentListTitle>svg {\r\n  width: 18px;\r\n  vertical-align: middle;\r\n  margin-right: 5px;\r\n  font-size: 14px;\r\n}\r\n\r\n.commentListTitle[flag='1'] {\r\n  display: inline-block;\r\n}\r\n\r\n.contentContainer {\r\n  width: 100%;\r\n  min-height: 100%;\r\n  height: auto;\r\n  position: relative;\r\n  background: #fff;\r\n  padding-left: 20px;\r\n  float: left;\r\n}\r\n\r\n.contentContainer[flag='1'] {\r\n  width: calc(100% - 363px);\r\n}\r\n\r\n.relationCanvasItem,\r\n.canvasItemArea {\r\n  position: absolute;\r\n  top: 0px;\r\n  left: 0px;\r\n  width: 100%;\r\n  z-index: 0;\r\n  height: 100%;\r\n  overflow: hidden;\r\n}\r\n\r\n.docContentItem {\r\n  padding-left: 10px;\r\n  position: relative;\r\n  z-index: 1;\r\n  height: auto;\r\n  min-height: 400px;\r\n  width: 100%;\r\n  line-height: 5;\r\n  border-radius: 5px;\r\n  white-space: pre-line;\r\n  counter-reset: section;\r\n  counter-increment: section;\r\n  float: left;\r\n}\r\n\r\n.docContentItem[switchFlag='1'] :deep(.spanInfoArea)[sameFlag='0'] {\r\n  display: none !important;\r\n}\r\n\r\n.docContentItem[switchFlag='2'] :deep(.spanInfoArea)[sameFlag='1'] {\r\n  display: none !important;\r\n}\r\n\r\n:deep(.spanInfoArea)[sameFlag='0'] .setBaseOp {\r\n  display: inline-block !important;\r\n}\r\n\r\n:deep(.opSpanInfoArea)[mode='check'] {\r\n  width: 70px;\r\n}\r\n\r\n:deep(.opSpanInfoArea) span {\r\n  display: inline-block;\r\n  box-sizing: border-box;\r\n  height: 20px;\r\n  line-height: 20px;\r\n}\r\n\r\n:deep(span.opSpanInfoArea)>svg {\r\n  display: inline-block;\r\n  margin-top: 4px;\r\n  width: 13px;\r\n  height: 13px;\r\n  cursor: pointer;\r\n}\r\n\r\n.lineLabelList {\r\n  position: absolute;\r\n  left: 0px;\r\n  top: 0px;\r\n  width: 0px;\r\n  height: 0px;\r\n  z-index: 5;\r\n}\r\n\r\n.commentsListArea {\r\n  position: relative;\r\n  float: right;\r\n  padding-left: 5px;\r\n  padding-top: 15px;\r\n  padding-bottom: 15px;\r\n  width: 350px;\r\n  height: 100%;\r\n  background-color: #fff;\r\n  overflow: auto;\r\n  z-index: 1;\r\n}\r\n\r\n.contentItem {\r\n  position: relative;\r\n  margin-top: 20px;\r\n  padding-right: 80px;\r\n  padding-left: 20px;\r\n  font-style: normal;\r\n  font-weight: normal;\r\n  word-break: break-all;\r\n  font-size: 14px;\r\n  line-height: 56px;\r\n}\r\n\r\n.contentItem::before {\r\n  content: attr(index);\r\n  position: absolute;\r\n  left: -15px;\r\n  top: 0px;\r\n  color: #999;\r\n}\r\n\r\n.contentItem i {\r\n  /* color: red; */\r\n  font-style: normal;\r\n  /* font-weight: 900; */\r\n  color: #ffffff;\r\n  font-weight: normal;\r\n  background: #1890ff;\r\n}\r\n\r\n.labelOptionArea {\r\n  padding-left: 0px;\r\n  text-align: left;\r\n  width: calc(100% - 12px);\r\n}\r\n\r\n.labelOptionArea .buttonArea {\r\n  display: inline-block;\r\n  line-height: 48px;\r\n  height: 48px;\r\n}\r\n\r\n.labelOptionArea .opBtnItem {\r\n  margin: 0px 15px;\r\n  cursor: pointer;\r\n  font-size: 12px;\r\n  position: relative;\r\n  color: rgba(0, 0, 0, 0.85);\r\n  vertical-align: top;\r\n}\r\n\r\n.labelOptionArea .opBtnItem svg {\r\n  width: 16px;\r\n  height: 16px;\r\n  padding-right: 3px;\r\n  vertical-align: middle;\r\n}\r\n\r\n.docContentItem :deep(.spanItem) {\r\n  box-sizing: border-box;\r\n  border-radius: 2px;\r\n  display: inline-block;\r\n  line-height: 20px;\r\n  margin: 0 5px;\r\n  min-width: 60px;\r\n  cursor: pointer;\r\n  text-align: center;\r\n  position: relative;\r\n  vertical-align: middle;\r\n  max-width: 100%;\r\n}\r\n\r\n.spanInfoArea:hover,\r\n.selectText:hover {\r\n  border: 1px solid #52c41a;\r\n}\r\n\r\n.contentContainer[flag='1'] .selectText[commenthighlight='true'] {\r\n  border: 1px solid #ffa39e;\r\n  color: #ff4d4f;\r\n}\r\n\r\n:deep(.spanItem)[type='param'] .selectText {\r\n  border: 1px solid #ffc53d;\r\n}\r\n\r\n:deep(.spanItem)[type='param'] .spanInfoArea {\r\n  border: 1px solid #ffc53d;\r\n  color: #ffc53d;\r\n  background: #fffbe6;\r\n}\r\n\r\n:deep(.selectText)[commenthighlight='true']:hover {\r\n  border: 1px solid #52c41a;\r\n}\r\n\r\n:deep(.spanItem).highlightItem {\r\n  background-color: rgb(64, 158, 255);\r\n  color: #fff;\r\n}\r\n\r\n:deep(.spanInfoArea)[highlight='true'],\r\n:deep(.selectText)[highlight='true'] {\r\n  background-color: rgb(64, 158, 255);\r\n  color: #fff;\r\n}\r\n\r\n.commentsItem {\r\n  float: left;\r\n  position: relative;\r\n  border: solid 1px #f2f2f2;\r\n  border-radius: 5px;\r\n  width: calc(100% - 10px);\r\n\r\n  padding: 10px;\r\n  padding-right: 20px;\r\n  margin-top: 10px;\r\n  box-shadow: 1px 1px 1px #666;\r\n}\r\n\r\n.commentsItem .commentsText {\r\n  max-height: 100px;\r\n  display: inline-block;\r\n  width: 100%;\r\n  word-break: break-all;\r\n  overflow: auto;\r\n}\r\n\r\n.commentsItem .removeCommentsBtn {\r\n  cursor: pointer;\r\n  color: #aaa;\r\n  display: none;\r\n  position: absolute;\r\n  right: 5px;\r\n  top: 5px;\r\n}\r\n\r\n.commentsItem:hover .removeCommentsBtn {\r\n  color: #666;\r\n  display: inline-block;\r\n}\r\n\r\n.el-radio.is-bordered {\r\n  margin-left: 0px !important;\r\n  margin-right: 10px;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  float: left;\r\n}\r\n\r\n:deep(.el-dialog__body) {\r\n  padding: 20px 20px !important;\r\n}\r\n\r\n.docContentItem :deep(.spanInfoArea) {\r\n  position: absolute;\r\n  top: -25px;\r\n  left: 0px;\r\n  width: calc(100% + 2px);\r\n  min-width: 40px;\r\n  font-family: OPPOSans;\r\n  font-style: normal;\r\n  font-weight: normal;\r\n  font-size: 12px;\r\n  line-height: 20px;\r\n  height: 20px;\r\n  display: inline-block;\r\n  text-align: center;\r\n  background: #e6f7ff;\r\n  border: 1px solid #91d5ff;\r\n  box-sizing: border-box;\r\n  border-radius: 2px;\r\n  user-select: none;\r\n  color: #1890ff;\r\n}\r\n\r\n:deep(.spanItem) .opSpanInfoArea i:nth-child(2) {\r\n  margin: 0px 5px !important;\r\n}\r\n\r\n:deep(.opSpanInfoArea) i:hover {\r\n  color: #1890ff !important;\r\n}\r\n\r\n.lineLabelList :deep(.spanInfoArea) {\r\n  width: auto !important;\r\n  max-width: 250px;\r\n}\r\n\r\n:deep(.spanInfoArea)>.spanText {\r\n  width: 100%;\r\n  display: inline-block;\r\n  cursor: pointer;\r\n  margin-top: -1px;\r\n  overflow: hidden;\r\n  padding: 0px 3px;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n:deep(.opSpanInfoArea) {\r\n  position: absolute;\r\n  display: none;\r\n  background: rgba(34, 38, 44, 0.45);\r\n  box-sizing: border-box;\r\n  backdrop-filter: blur(8px);\r\n  border-radius: 2px;\r\n  color: #fff;\r\n  left: calc(100% + 6px);\r\n  top: -1px;\r\n  width: 50px;\r\n  z-index: 555;\r\n  padding: 0px 5px;\r\n  line-height: 20px;\r\n  height: 20px;\r\n  user-select: none;\r\n  white-space: nowrap; \r\n}\r\n\r\n.lineLabelList .opSpanInfoArea[mode='check'] .setBaseOp,\r\n.lineLabelList .opSpanInfoArea[mode='do'] .setBaseOp {\r\n  display: none;\r\n}\r\n\r\n.lineLabelList .opSpanInfoArea[mode='check'] {\r\n  width: 50px;\r\n}\r\n\r\n:deep(.opSpanInfoArea)[mode='checkTwo'],\r\n.lineLabelList .opSpanInfoArea[mode='checkTwo'] {\r\n  width: 50px;\r\n}\r\n\r\n.opSpanInfoArea[mode='checkTwo'] input {\r\n  vertical-align: middle;\r\n}\r\n\r\n.lineLabelList .opSpanInfoArea {\r\n  width: 50px;\r\n}\r\n\r\n:deep(.opSpanInfoArea)::before {\r\n  position: absolute;\r\n  top: 5px;\r\n  left: -10px;\r\n  content: '';\r\n  width: 0px;\r\n  height: 0px;\r\n  border: 5px solid transparent;\r\n  border-right-color: rgba(34, 38, 44, 0.45);\r\n  display: inline-block;\r\n}\r\n\r\n:deep(.selectText) {\r\n  border: 1px solid #91d5ff;\r\n  /* background: #e6f7ff; */\r\n  box-sizing: border-box;\r\n  border-radius: 2px;\r\n  display: inline-block;\r\n  line-height: 20px;\r\n  min-width: 60px;\r\n  cursor: pointer;\r\n  padding: 0px 3px;\r\n  max-width: 100%;\r\n  text-align: center;\r\n  user-select: none;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.topFormArea .el-form-item {\r\n  margin-bottom: 0px !important;\r\n}\r\n\r\n:deep(.spanInfoArea)[active='true'] .opSpanInfoArea,\r\n.lineLabelItem:hover .opSpanInfoArea {\r\n  display: inline-block;\r\n}\r\n\r\n.highlightText {\r\n  background: #1890ff;\r\n  backdrop-filter: blur(30px);\r\n  font-style: normal;\r\n  color: #ffffff;\r\n  border-radius: 2px;\r\n}\r\n\r\n.checkGroup {\r\n  float: right;\r\n  display: inline-block;\r\n  margin-right: 5px;\r\n}\r\n\r\n.checkGroup>.el-checkbox {\r\n  font-size: 12px !important;\r\n  margin-right: 5px !important;\r\n  transform: scale(0.9);\r\n  transform-origin: center center;\r\n}\r\n\r\n.checkGroup .el-checkbox__label {\r\n  font-size: 12px !important;\r\n  vertical-align: middle;\r\n  padding-left: 5px;\r\n}\r\n\r\n.checkGroup .el-checkbox__inner {\r\n  background: #bae7ff;\r\n}\r\n\r\n.checkGroup i {\r\n  margin-right: 5px;\r\n  font-size: 16px;\r\n  vertical-align: middle;\r\n  color: #05146e;\r\n}\r\n\r\n.dialogContentArea {\r\n  position: relative;\r\n  height: auto;\r\n  width: 100%;\r\n}\r\n\r\n.editLabelArea,\r\n.editRelationArea {\r\n  float: left;\r\n  position: relative;\r\n  width: 100%;\r\n  height: auto;\r\n  border: 1px solid #d9d9d9;\r\n  box-sizing: border-box;\r\n  padding: 10px 0px;\r\n  border-radius: 2px;\r\n}\r\n\r\n.contentTopArea {\r\n  font-size: 14px;\r\n  margin: 0px;\r\n  width: 100%;\r\n  float: left;\r\n  padding-left: 10px;\r\n  padding-bottom: 10px;\r\n  box-shadow: inset 0px -1px 0px #f0f0f0;\r\n}\r\n\r\n.editRelationArea .contentTopArea {\r\n  padding-top: 30px;\r\n  box-shadow: none;\r\n}\r\n\r\n.editRelationArea {\r\n  border: none;\r\n}\r\n\r\n.contentLeftArea,\r\n.contentRightArea,\r\n.relationContentArea {\r\n  width: 50%;\r\n  position: relative;\r\n  display: inline-block;\r\n  float: left;\r\n}\r\n\r\n.relationContentArea {\r\n  width: 100%;\r\n}\r\n\r\n.contentRightArea .el-tree {\r\n  position: relative;\r\n  overflow: auto;\r\n  max-height: 200px !important;\r\n}\r\n\r\n.el-icon-caret-right {\r\n  margin-left: -13px !important;\r\n}\r\n\r\n.extraDataArea {\r\n  position: relative;\r\n  float: left;\r\n  width: 100%;\r\n  margin-top: 30px;\r\n}\r\n\r\n.extraDataArea>h5 {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.relationLabelArea {\r\n  position: relative;\r\n  width: auto;\r\n  margin: 0px 20px;\r\n}\r\n\r\n.relationLabelArea img {\r\n  width: 200px;\r\n  height: 5px;\r\n}\r\n\r\n.relationLabelArea .relationLabel {\r\n  position: absolute;\r\n  display: inline-block;\r\n  width: 200px;\r\n  text-align: center;\r\n  left: 0px;\r\n  top: -20px;\r\n  font-size: 12px;\r\n  font-weight: normal;\r\n}\r\n\r\n.contentTopArea .relationLabelArea .relationLabel::before {\r\n  content: '\\5C5E\\6027';\r\n}\r\n\r\n.contentTopArea[type='relation'] .relationLabelArea .relationLabel::before {\r\n  content: '\\5173\\7CFB';\r\n}\r\n\r\n.masterName,\r\n.slaveName {\r\n  position: relative;\r\n  padding: 10px 0px;\r\n  display: inline-block;\r\n  text-align: center;\r\n}\r\n\r\n.masterName>span,\r\n.slaveName>span {\r\n  display: inline-block;\r\n  min-width: 50px;\r\n  max-width: 120px;\r\n}\r\n\r\n.commentsInfo {\r\n  color: #999;\r\n  margin-top: 5px;\r\n  text-align: right;\r\n}\r\n\r\n.commentsInfo .nameItem,\r\n.commentsInfo .timeItem {\r\n  font-size: 12px;\r\n  display: inline-block;\r\n  vertical-align: middle;\r\n}\r\n\r\n.commentsInfo .timeItem {\r\n  margin-left: 10px;\r\n}\r\n\r\n.contentTopArea .masterName::before {\r\n  content: '\\5B9E\\4F53';\r\n}\r\n\r\n.contentTopArea .slaveName::before {\r\n  content: '\\5C5E\\6027';\r\n}\r\n\r\n.contentTopArea[type='relation'] .masterName::before {\r\n  content: '\\4E3B\\4F53';\r\n}\r\n\r\n.contentTopArea[type='relation'] .slaveName::before {\r\n  content: '\\5BA2\\4F53';\r\n}\r\n\r\n.contentLeftArea>h5 {\r\n  margin-bottom: 10px;\r\n}\r\n\r\n.masterName::before,\r\n.slaveName::before {\r\n  display: inline-block;\r\n  padding: 3px;\r\n  background: #1890ff;\r\n  border-radius: 2px;\r\n  color: #fff;\r\n  position: absolute;\r\n  left: calc(50% - 22px);\r\n  top: -25px;\r\n  font-size: 12px;\r\n  width: 40px;\r\n  text-align: center;\r\n}\r\n\r\n.setBaseOp {\r\n  font-size: 10px;\r\n  vertical-align: middle;\r\n  margin-top: -2px;\r\n  transform: scale(0.9);\r\n}\r\n\r\n.setBaseOp input {\r\n  transform: scale(1.15);\r\n  display: inline-block;\r\n}\r\n\r\n.linkArrowIcon {\r\n  width: 200px;\r\n  height: 20px;\r\n  display: inline-block;\r\n}\r\n\r\ni.searchHighlightText {\r\n  display: inline-block;\r\n  background: #1890ff !important;\r\n  line-height: 18px;\r\n  font-style: normal;\r\n}\r\n\r\n.switchTableBtn {\r\n  cursor: pointer;\r\n}\r\n\r\n.ellipsis {\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n}\r\n\r\n.emptyDataTips {\r\n  text-align: center;\r\n  font-size: 12px;\r\n  color: #999;\r\n}\r\n\r\n.labelOptionArea .opBtnItem:first-child::after,\r\n.labelOptionArea .opBtnItem:last-child::before {\r\n  content: '';\r\n  display: inline-block;\r\n  width: 0px;\r\n  height: 15px;\r\n  position: absolute;\r\n  right: -15px;\r\n  top: 0px;\r\n  border-right: solid 1px #999;\r\n}\r\n\r\n.labelOptionArea .opBtnItem:last-child:before {\r\n  left: -15px;\r\n}\r\n</style>\r\n"]}]}